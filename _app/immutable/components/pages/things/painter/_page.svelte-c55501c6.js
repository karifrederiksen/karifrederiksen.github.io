var ys=Object.defineProperty;var ws=(r,e,t)=>e in r?ys(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var g=(r,e,t)=>(ws(r,typeof e!="symbol"?e+"":e,t),t);import{S as G,i as q,s as W,C as Fe,k as P,l as M,m as L,h as _,n as R,b as H,P as ne,D as Ae,E as Le,F as Pe,f as $,t as w,X as Ee,Y as we,a as I,c as B,p as ve,G as y,B as Z,o as Me,Z as Ie,Q as st,R as ot,q as X,r as Y,u as ie,e as lt,g as $e,d as be,j as Tr,_ as Vn,$ as Fr,w as S,x as k,y as T,z as F,N as sn,T as Ht,H as Pt,M as Rs}from"../../../../chunks/index-3155a5b5.js";import{w as ct}from"../../../../chunks/index-b763cd81.js";function Es(r){let e,t,n,s;const o=r[4].default,l=Fe(o,r,r[3],null);return{c(){e=P("button"),l&&l.c(),this.h()},l(a){e=M(a,"BUTTON",{title:!0,style:!0,class:!0});var i=L(e);l&&l.l(i),i.forEach(_),this.h()},h(){R(e,"title",r[0]),R(e,"style",r[1]),R(e,"class","ddefault svelte-3b2gpz")},m(a,i){H(a,e,i),l&&l.m(e,null),t=!0,n||(s=ne(e,"click",r[5]),n=!0)},p(a,[i]){l&&l.p&&(!t||i&8)&&Ae(l,o,a,a[3],t?Pe(o,a[3],i,null):Le(a[3]),null),(!t||i&1)&&R(e,"title",a[0]),(!t||i&2)&&R(e,"style",a[1])},i(a){t||($(l,a),t=!0)},o(a){w(l,a),t=!1},d(a){a&&_(e),l&&l.d(a),n=!1,s()}}}function Ss(r,e,t){let{$$slots:n={},$$scope:s}=e,{title:o=void 0}=e,{style:l=void 0}=e;const a=Ee(),i=()=>a("click");return r.$$set=c=>{"title"in c&&t(0,o=c.title),"style"in c&&t(1,l=c.style),"$$scope"in c&&t(3,s=c.$$scope)},[o,l,a,s,n,i]}class wt extends G{constructor(e){super(),q(this,e,Ss,Es,W,{title:0,style:1})}}function ks(r){let e,t,n,s;const o=r[4].default,l=Fe(o,r,r[3],null);return{c(){e=P("button"),l&&l.c(),this.h()},l(a){e=M(a,"BUTTON",{title:!0,style:!0,class:!0});var i=L(e);l&&l.l(i),i.forEach(_),this.h()},h(){R(e,"title",r[0]),R(e,"style",r[1]),R(e,"class","primary svelte-jjub2c")},m(a,i){H(a,e,i),l&&l.m(e,null),t=!0,n||(s=ne(e,"click",r[5]),n=!0)},p(a,[i]){l&&l.p&&(!t||i&8)&&Ae(l,o,a,a[3],t?Pe(o,a[3],i,null):Le(a[3]),null),(!t||i&1)&&R(e,"title",a[0]),(!t||i&2)&&R(e,"style",a[1])},i(a){t||($(l,a),t=!0)},o(a){w(l,a),t=!1},d(a){a&&_(e),l&&l.d(a),n=!1,s()}}}function Ts(r,e,t){let{$$slots:n={},$$scope:s}=e,{title:o=void 0}=e,{style:l=void 0}=e;const a=Ee(),i=()=>a("click");return r.$$set=c=>{"title"in c&&t(0,o=c.title),"style"in c&&t(1,l=c.style),"$$scope"in c&&t(3,s=c.$$scope)},[o,l,a,s,n,i]}class Ar extends G{constructor(e){super(),q(this,e,Ts,ks,W,{title:0,style:1})}}function Fs(r){let e,t,n,s,o;const l=r[4].default,a=Fe(l,r,r[3],null);return{c(){e=P("button"),a&&a.c(),this.h()},l(i){e=M(i,"BUTTON",{title:!0,class:!0});var c=L(e);a&&a.l(c),c.forEach(_),this.h()},h(){R(e,"title",r[0]),R(e,"class",t=we(r[1]?"sinkableSunk":"sinkableUnsunk")+" svelte-2hvqwf")},m(i,c){H(i,e,c),a&&a.m(e,null),n=!0,s||(o=ne(e,"click",r[2]),s=!0)},p(i,[c]){a&&a.p&&(!n||c&8)&&Ae(a,l,i,i[3],n?Pe(l,i[3],c,null):Le(i[3]),null),(!n||c&1)&&R(e,"title",i[0]),(!n||c&2&&t!==(t=we(i[1]?"sinkableSunk":"sinkableUnsunk")+" svelte-2hvqwf"))&&R(e,"class",t)},i(i){n||($(a,i),n=!0)},o(i){w(a,i),n=!1},d(i){i&&_(e),a&&a.d(i),s=!1,o()}}}function As(r,e,t){let{$$slots:n={},$$scope:s}=e,{title:o=void 0}=e,{isDown:l}=e;const a=Ee(),i=()=>{l||a("click")};return r.$$set=c=>{"title"in c&&t(0,o=c.title),"isDown"in c&&t(1,l=c.isDown),"$$scope"in c&&t(3,s=c.$$scope)},[o,l,i,s,n]}class Kt extends G{constructor(e){super(),q(this,e,As,Fs,W,{title:0,isDown:1})}}function Ls(r){let e,t,n,s,o,l;return{c(){e=P("div"),t=P("span"),n=I(),s=P("span"),this.h()},l(a){e=M(a,"DIV",{class:!0});var i=L(e);t=M(i,"SPAN",{class:!0,style:!0}),L(t).forEach(_),n=B(i),s=M(i,"SPAN",{class:!0,style:!0}),L(s).forEach(_),i.forEach(_),this.h()},h(){R(t,"class","secondary svelte-1whbsbw"),ve(t,"background-color",r[1].toStyle()),R(s,"class","primary svelte-1whbsbw"),ve(s,"background-color",r[0].toStyle()),R(e,"class","container svelte-1whbsbw")},m(a,i){H(a,e,i),y(e,t),y(e,n),y(e,s),o||(l=ne(e,"click",r[3]),o=!0)},p(a,[i]){i&2&&ve(t,"background-color",a[1].toStyle()),i&1&&ve(s,"background-color",a[0].toStyle())},i:Z,o:Z,d(a){a&&_(e),o=!1,l()}}}function Ps(r,e,t){let{color:n}=e,{colorSecondary:s}=e;const o=Ee(),l=()=>o("click");return r.$$set=a=>{"color"in a&&t(0,n=a.color),"colorSecondary"in a&&t(1,s=a.colorSecondary)},[n,s,o,l]}class Ms extends G{constructor(e){super(),q(this,e,Ps,Ls,W,{color:0,colorSecondary:1})}}var j={};Object.defineProperty(j,"__esModule",{value:!0});class Be{constructor(e,t,n){this.r=e,this.g=t,this.b=n}static fromCss(e){return e=e.replace(/[ \t]/,""),e.startsWith("rgb(")?xs(e.substr(4,e.length-5)):e.startsWith("#")?Xn(e.substr(1)):Xn(e)}is(e){return this.r===e.r&&this.g===e.g&&this.b===e.b}toRgb(){return this}with({r:e,g:t,b:n}){return new Be(e!==void 0?e:this.r,t!==void 0?t:this.g,n!==void 0?n:this.b)}toStyle(){return`rgb(${Qt(this.r)},${Qt(this.g)},${Qt(this.b)})`}toLinear(){return new _e(jt(this.r),jt(this.g),jt(this.b))}toString(){return"Rgb("+this.r+", "+this.g+", "+this.b+")"}}class _e{constructor(e,t,n){this.r=e,this.g=t,this.b=n}is(e){return this.r===e.r&&this.g===e.g&&this.b===e.b}with({r:e,g:t,b:n}){return new _e(e!==void 0?e:this.r,t!==void 0?t:this.g,n!==void 0?n:this.b)}mix(e,t){return new _e(en(e,this.r,t.r),en(e,this.g,t.g),en(e,this.b,t.b))}lighten(e){return this.mix(e,_e.White)}darken(e){return this.mix(e,_e.Black)}fromLinear(){return new Be(Zt(this.r),Zt(this.g),Zt(this.b))}toString(){return"LinearRgb("+this.r+", "+this.g+", "+this.b+")"}}_e.White=new _e(1,1,1);_e.Black=new _e(0,0,0);function jt(r){return r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92}function Zt(r){return r<=.0031308?r*12.92:Math.pow(r*1.055,1/2.4)-.055}function Qt(r){return r*255.9999999|0}function on(r,e,t){return isNaN(r)||!isFinite(r)||isNaN(e)||!isFinite(e)||isNaN(t)||!isFinite(t)?null:new Be(r,e,t)}function xs(r){const e=r.split(",");if(e.length!==3)return null;const t=Number.parseFloat(e[0])/255,n=Number.parseFloat(e[1])/255,s=Number.parseFloat(e[2])/255;return on(t,n,s)}function Xn(r){if(r.length===3){const e=_t(r[0])/15,t=_t(r[1])/15,n=_t(r[2])/15;return on(e,t,n)}if(r.length===6){const e=Jt(r[0],r[1]),t=Jt(r[2],r[3]),n=Jt(r[4],r[5]);return on(e,t,n)}return null}function Jt(r,e){return(_t(r)*16+_t(e))/255}function _t(r){switch(r.toLowerCase()){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15;default:return NaN}}function en(r,e,t){return e+r*(t-e)}class Ot{constructor(e,t,n){this.h=e,this.s=t,this.v=n,this.__cachedRgb=null}is(e){return this.h===e.h&&this.s===e.s&&this.v===e.v}toRgb(){return this.__cachedRgb===null&&(this.__cachedRgb=Lr(this)),this.__cachedRgb}toStyle(){return this.toRgb().toStyle()}with({h:e,s:t,v:n}){return new Ot(e!==void 0?e:this.h,t!==void 0?t:this.s,n!==void 0?n:this.v)}toString(){return"Hsv("+this.h+", "+this.s+", "+this.v+")"}}function Cs({r,g:e,b:t}){const n=Math.max(r,e,t),s=Math.min(r,e,t),o=n-s,l=n===0?0:o/n;let a;switch(n){case s:a=0;break;case r:a=(e-t)/o+(e<t?6:0);break;case e:a=(t-r)/o+2;break;default:a=(r-e)/o+4;break}return new Ot(a/6,l,n)}function Lr({h:r,s:e,v:t}){const n=r*6|0,s=r*6-n,o=t*(1-e),l=t*(1-s*e),a=t*(1-(1-s)*e);let i,c,u;switch(n%6){case 0:i=t,c=a,u=o;break;case 1:i=l,c=t,u=o;break;case 2:i=o,c=t,u=a;break;case 3:i=o,c=l,u=t;break;case 4:i=a,c=o,u=t;break;default:i=t,c=o,u=l;break}return new Be(i,c,u)}class Is{constructor(e,t){this.x=e,this.y=t}}class vt{constructor(e,t,n){this.l=e,this.u=t,this.v=n}}class Je{constructor(e,t,n){this.h=e,this.s=t,this.l=n,this.__cachedRgb=null}is(e){return this.h===e.h&&this.s===e.s&&this.l===e.l}with({h:e,s:t,l:n}){return new Je(e!==void 0?e:this.h,t!==void 0?t:this.s,n!==void 0?n:this.l)}toRgb(){return this.__cachedRgb===null&&(this.__cachedRgb=Xr(this)),this.__cachedRgb}toStyle(){return this.toRgb().toStyle()}toString(){return"Hsluv("+this.h+", "+this.s+", "+this.l+")"}}class et{constructor(e,t,n){this.h=e,this.p=t,this.l=n,this.__cachedRgb=null}is(e){return this.h===e.h&&this.p===e.p&&this.l===e.l}with({h:e,p:t,l:n}){return new et(e!==void 0?e:this.h,t!==void 0?t:this.p,n!==void 0?n:this.l)}toRgb(){return this.__cachedRgb===null&&(this.__cachedRgb=Yr(this)),this.__cachedRgb}toStyle(){return this.toRgb().toStyle()}toString(){return"Hsv("+this.h+", "+this.p+", "+this.l+")"}}class ye{constructor(e,t,n){this.l=e,this.c=t,this.h=n}}class Ct{constructor(e,t,n){this.x=e,this.y=t,this.z=n}}const ln=3.240969941904521,an=-1.537383177570093,cn=-.498610760293,un=-.96924363628087,fn=1.87596750150772,hn=.041555057407175,dn=.055630079696993,mn=-.20397695888897,pn=1.056971514242878,Bs=.41239079926595,Ds=.35758433938387,Ns=.18048078840183,Hs=.21263900587151,Os=.71516867876775,zs=.072192315360733,Us=.019330818715591,Vs=.11919477979462,Xs=.95053215224966,Rt=1,Pr=.19783000664283,Mr=.46831999493879,Rn=903.2962962,xr=.0088564516;function Ys(r){return r*Math.PI/180}function Gs(r){return r*180/Math.PI}function je(r,e,t,n,s,o){const l=(284517*r-94839*t)*s,a=(838422*t+769860*e+731718*r)*n*s-769860*o*n,i=(632260*t-126452*e)*s+126452*o;return new Is(l/i,a/i)}function Cr(r){const e=Math.pow(r+16,3)/1560896,t=e>xr?e:r/Rn;return[je(ln,an,cn,r,t,0),je(ln,an,cn,r,t,1),je(un,fn,hn,r,t,0),je(un,fn,hn,r,t,1),je(dn,mn,pn,r,t,0),je(dn,mn,pn,r,t,1)]}function Ir(r){const e=Cr(r);let t=Number.MAX_VALUE;for(let n=0;n<2;++n){const s=e[n],o=s.y/(-1/s.x-s.x),l=s.y+o*s.x,a=Math.sqrt(o*o+l*l);a<t&&(t=a)}return t}function Br(r,e){const t=e/360*Math.PI*2,n=Cr(r);let s=Number.MAX_VALUE;for(let o=0;o<n.length;o++){const l=n[o],a=l.y/(Math.sin(t)-l.x*Math.cos(t));a>=0&&a<s&&(s=a)}return s}function qs(r){return r>xr?116*Math.pow(r/Rt,1/3)-16:r/Rt*Rn}function Ws(r){return r>8?Math.pow(Rt*((r+16)/116),3):Rt*r/Rn}function Dr({l:r,u:e,v:t}){const n=Math.sqrt(e*e+t*t);if(n<1e-8)return new ye(r,n,0);const s=Gs(Math.atan2(t,e));return s<0?new ye(r,n,s+360):new ye(r,n,s)}function Nr({l:r,c:e,h:t}){const n=Ys(t),s=Math.cos(n)*e,o=Math.sin(n)*e;return new vt(r,s,o)}function Hr(r){const e=r.toLinear(),t=e.r*Bs+e.g*Ds+e.b*Ns,n=e.r*Hs+e.g*Os+e.b*zs,s=e.r*Us+e.g*Vs+e.b*Xs;return new Ct(t,n,s)}function tn(r){return r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055}function En(r){const e=tn(r.x*ln+r.y*an+r.z*cn),t=tn(r.x*un+r.y*fn+r.z*hn),n=tn(r.x*dn+r.y*mn+r.z*pn);return new Be(e,t,n)}function Or({l:r,c:e,h:t}){if(r>99.9999999)return new Je(t,0,100);if(r<1e-8)return new Je(t,0,0);const n=Br(r,t),s=e/n*100;return new Je(t,s,r)}function zr({h:r,s:e,l:t}){if(t>99.9999999)return new ye(100,0,r);if(t<1e-8)return new ye(0,0,r);const s=Br(t,r)/100*e;return new ye(t,s,r)}function Ur({l:r,c:e,h:t}){if(r>99.9999999)return new et(t,0,100);if(r<1e-8)return new et(t,0,0);const n=Ir(r),s=e/n*100;return new et(t,s,r)}function Vr({h:r,p:e,l:t}){if(t>99.9999999)return new ye(100,0,r);if(t<1e-8)return new ye(0,0,r);const s=Ir(t)/100*e;return new ye(t,s,r)}function Ks(r){return En(Tn(r))}function Sn(r){return Dr(Gr(Hr(r)))}function kn(r){return En(Tn(Nr(r)))}function js(r){return Or(Sn(r))}function Xr(r){return kn(zr(r))}function Zs(r){return Ur(Sn(r))}function Yr(r){return kn(Vr(r))}function Gr({x:r,y:e,z:t}){if(r===0&&e===0&&t===0)return new vt(0,0,0);const n=qs(e);if(n===0)return new vt(0,0,0);const s=13*n*(4*r/(r+15*e+3*t)-Pr),o=13*n*(9*e/(r+15*e+3*t)-Mr);return new vt(n,s,o)}function Tn({l:r,u:e,v:t}){if(r===0)return new Ct(0,0,0);const n=e/(13*r)+Pr,s=t/(13*r)+Mr,o=Ws(r)*Rt,l=0-9*o*n/((n-4)*s-n*s),a=(9*o-15*s*o-s*l)/(3*s);return new Ct(l,o,a)}function Qs({r,g:e,b:t}){const n=Math.sqrt(.299*r*r+.587*e*e+.114*t*t);return new Be(n,n,n)}var Js=j.Rgb=Be,Yn=j.RgbLinear=_e,eo=j.Hsv=Ot,Xe=j.rgbToHsv=Cs,to=j.hsvToRgb=Lr;j.Luv=vt;var It=j.Hsluv=Je;j.Hpluv=et;j.Lch=ye;j.Xyz=Ct;j.luvToLch=Dr;j.lchToLuv=Nr;j.rgbToXyz=Hr;j.xyzToRgb=En;j.lchToHsluv=Or;j.hsluvToLch=zr;j.lchToHpluv=Ur;j.hpluvToLch=Vr;j.luvToRgb=Ks;j.rgbToLch=Sn;j.lchToRgb=kn;var Se=j.rgbToHsluv=js,qr=j.hsluvToRgb=Xr;j.rgbToHpluv=Zs;j.hpluvToRgb=Yr;j.xyzToLuv=Gr;j.luvToXyz=Tn;j.toGray=Qs;const le=class{constructor(e,t){g(this,"x");g(this,"y");this.x=e,this.y=t}eq(e){return le.eq(this,e)}add(e){return new le(this.x+e.x,this.y+e.y)}addScalar(e){return new le(this.x+e,this.y+e)}addScalars(e,t){return new le(this.x+e,this.y+t)}subtract(e){return new le(this.x-e.x,this.y-e.y)}subtractScalar(e){return new le(this.x-e,this.y-e)}subtractScalars(e,t){return new le(this.x-e,this.y-t)}multiply(e){return new le(this.x*e.x,this.y*e.y)}multiplyScalar(e){return new le(this.x*e,this.y*e)}multiplyScalars(e,t){return new le(this.x*e,this.y*t)}divide(e){return new le(this.x/e.x,this.y/e.y)}divideScalar(e){return new le(this.x/e,this.y/e)}toString(){return"Vec2("+this.x+", "+this.y+")"}static eq(e,t){return e.x===t.x&&e.y===t.y}static lerp(e,t,n){return new le(t.x+(n.x-t.x)*e,t.y+(n.y-t.y)*e)}static distance(e,t){const n=t.x-e.x,s=t.y-e.y;return Math.sqrt(n*n+s*s)}};let oe=le;g(oe,"zeroes",new le(0,0));function no(r){const{effectsHandler:e,initialState:t,initialEphemeral:n,forceRender:s,update:o}=r;let l=t,a=n;function i(c){const u=l;let h;try{const[f,d,m]=o(l,a,c);l!==f&&(l=f,s(f,d)),h=m,a=d}catch(f){l=u,console.error("[ERROR][Store.update]",l,c,f);return}try{e(h)}catch(f){l=u,console.error("[ERROR][Store.effectsHandler]",l,c,h,f)}}return{send:i,getState:()=>l,getEphemeral:()=>a}}class Wr{constructor(){g(this,"value",null);g(this,"error",null)}}class Bt extends Wr{constructor(t){super();g(this,"value");g(this,"error");this.value=t,this.error=null}isOk(){return!0}isErr(){return!1}map(t){return new Bt(t(this.value))}mapError(){return new Bt(this.value)}andThen(t){return t(this.value)}}class ge extends Wr{constructor(t){super();g(this,"value");g(this,"error");this.value=null,this.error=t}isOk(){return!1}isErr(){return!0}map(){return new ge(this.error)}mapError(t){return new ge(t(this.error))}andThen(){return new ge(this.error)}}class at{constructor(e,t,n,s){g(this,"x");g(this,"y");g(this,"z");g(this,"w");this.x=e,this.y=t,this.z=n,this.w=s}eq(e){return at.eq(this,e)}static fromRgba(e,t){return new at(e.r*t,e.g*t,e.b*t,t)}static eq(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}}const ro={make:r=>{let e=!1;window.painterStop=()=>e=!0;let t=requestAnimationFrame(function n(){if(!e){try{r(performance.now())}catch(s){console.error(s)}t=requestAnimationFrame(n)}});return()=>cancelAnimationFrame(t)}};class so{constructor(e){g(this,"maxSamples");g(this,"onSamples");g(this,"samples");g(this,"nextIdx");g(this,"startTimeMs");this.maxSamples=e.maxSamples,this.onSamples=e.onSamples,this.samples=new Array(e.maxSamples),this.nextIdx=0,this.startTimeMs=null}start(){this.startTimeMs!==null&&console.error("Performance tracker should not already be in use"),this.startTimeMs=performance.now()}end(){this.startTimeMs===null&&console.error("Performance tracker should be started");const e=performance.now(),t=this.startTimeMs;this.startTimeMs=null,this.samples[this.nextIdx++]={startMs:t,endMs:e},this.nextIdx===this.maxSamples&&(this.onSamples(this.samples),this.samples=new Array(this.maxSamples),this.nextIdx=0)}}const Kr=[];function oo({width:r,height:e}){let t=Kr.pop();return t===void 0&&(t=document.createElement("canvas")),t.width=r,t.height=e,t}function jr(r){Kr.push(r)}function D(r,e){return{tag:r,val:e}}function tt(r,e){return r!==void 0?r:e}function Gn(r,e,t,n){const s=t-r,o=n-e;return Math.sqrt(s*s+o*o)}function Oe(r,e,t){return e+(t-e)*r}function ae(r,e,t){return r<e?e:r>t?t:r}function ut(r){const e=parseFloat(r);return isNaN(e)?null:e}function St(r,e,t){const n=r.slice();return n.splice(e,1,t),n}function lo(r,e,t){const n=r.slice();return n.splice(e,0,t),n}function ao(r,e){const t=r.slice();return t.splice(e,1),t}var J;(function(r){r[r.Hsv=0]="Hsv",r[r.Hsluv=1]="Hsluv"})(J||(J={}));function io(r){switch(r){case J.Hsv:return"Hsv";case J.Hsluv:return"Hsluv"}}function co(r,e,t){const n=r*360*(Math.PI/180),s=Math.cos(n)*(t.x-e.x)-Math.sin(n)*(t.y-e.y)+e.x,o=Math.sin(n)*(t.x-e.x)+Math.cos(n)*(t.y-e.y)+e.y;return new oe(s,o)}const uo=`#ifndef TAU
    #define TAU 6.283185307179586
#endif`,fo=`
float from_linear(float c) {
    return c <= 0.0031308 
        ? c * 12.92
        : pow(c * 1.055, 1.0 / 2.4) - 0.055;
}

vec3 from_linear(vec3 color) {
    return vec3(from_linear(color.x), from_linear(color.y), from_linear(color.z));
}
`,Zr=`
vec3 hsvToRgb(in vec3 c) {
    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}`,Qr=`
vec3 hsluv_intersectLineLine(vec3 line1x, vec3 line1y, vec3 line2x, vec3 line2y) {
    return (line1y - line2y) / (line2x - line1x);
}

vec3 hsluv_distanceFromPole(vec3 pointx,vec3 pointy) {
    return sqrt(pointx*pointx + pointy*pointy);
}

vec3 hsluv_lengthOfRayUntilIntersect(float theta, vec3 x, vec3 y) {
    vec3 len = y / (sin(theta) - x * cos(theta));
    if (len.r < 0.0) {len.r=1000.0;}
    if (len.g < 0.0) {len.g=1000.0;}
    if (len.b < 0.0) {len.b=1000.0;}
    return len;
}

float hsluv_maxSafeChromaForL(float L){
    mat3 m2 = mat3(
         3.2409699419045214  ,-0.96924363628087983 , 0.055630079696993609,
        -1.5373831775700935  , 1.8759675015077207  ,-0.20397695888897657 ,
        -0.49861076029300328 , 0.041555057407175613, 1.0569715142428786  
    );
    float sub0 = L + 16.0;
    float sub1 = sub0 * sub0 * sub0 * .000000641;
    float sub2 = sub1 > 0.0088564516790356308 ? sub1 : L / 903.2962962962963;

    vec3 top1   = (284517.0 * m2[0] - 94839.0  * m2[2]) * sub2;
    vec3 bottom = (632260.0 * m2[2] - 126452.0 * m2[1]) * sub2;
    vec3 top2   = (838422.0 * m2[2] + 769860.0 * m2[1] + 731718.0 * m2[0]) * L * sub2;

    vec3 bounds0x = top1 / bottom;
    vec3 bounds0y = top2 / bottom;

    vec3 bounds1x =              top1 / (bottom+126452.0);
    vec3 bounds1y = (top2-769860.0*L) / (bottom+126452.0);

    vec3 xs0 = hsluv_intersectLineLine(bounds0x, bounds0y, -1.0/bounds0x, vec3(0.0) );
    vec3 xs1 = hsluv_intersectLineLine(bounds1x, bounds1y, -1.0/bounds1x, vec3(0.0) );

    vec3 lengths0 = hsluv_distanceFromPole( xs0, bounds0y + xs0 * bounds0x );
    vec3 lengths1 = hsluv_distanceFromPole( xs1, bounds1y + xs1 * bounds1x );

    return  min(lengths0.r,
            min(lengths1.r,
            min(lengths0.g,
            min(lengths1.g,
            min(lengths0.b,
                lengths1.b)))));
}

float hsluv_maxChromaForLH(float L, float H) {

    float hrad = radians(H);

    mat3 m2 = mat3(
         3.2409699419045214  ,-0.96924363628087983 , 0.055630079696993609,
        -1.5373831775700935  , 1.8759675015077207  ,-0.20397695888897657 ,
        -0.49861076029300328 , 0.041555057407175613, 1.0569715142428786  
    );
    float sub1 = pow(L + 16.0, 3.0) / 1560896.0;
    float sub2 = sub1 > 0.0088564516790356308 ? sub1 : L / 903.2962962962963;

    vec3 top1   = (284517.0 * m2[0] - 94839.0  * m2[2]) * sub2;
    vec3 bottom = (632260.0 * m2[2] - 126452.0 * m2[1]) * sub2;
    vec3 top2   = (838422.0 * m2[2] + 769860.0 * m2[1] + 731718.0 * m2[0]) * L * sub2;

    vec3 bound0x = top1 / bottom;
    vec3 bound0y = top2 / bottom;

    vec3 bound1x =              top1 / (bottom+126452.0);
    vec3 bound1y = (top2-769860.0*L) / (bottom+126452.0);

    vec3 lengths0 = hsluv_lengthOfRayUntilIntersect(hrad, bound0x, bound0y );
    vec3 lengths1 = hsluv_lengthOfRayUntilIntersect(hrad, bound1x, bound1y );

    return  min(lengths0.r,
            min(lengths1.r,
            min(lengths0.g,
            min(lengths1.g,
            min(lengths0.b,
                lengths1.b)))));
}

float hsluv_fromLinear(float c) {
    return c <= 0.0031308 ? 12.92 * c : 1.055 * pow(c, 1.0 / 2.4) - 0.055;
}
vec3 hsluv_fromLinear(vec3 c) {
    return vec3( hsluv_fromLinear(c.r), hsluv_fromLinear(c.g), hsluv_fromLinear(c.b) );
}

float hsluv_toLinear(float c) {
    return c > 0.04045 ? pow((c + 0.055) / (1.0 + 0.055), 2.4) : c / 12.92;
}

vec3 hsluv_toLinear(vec3 c) {
    return vec3( hsluv_toLinear(c.r), hsluv_toLinear(c.g), hsluv_toLinear(c.b) );
}

float hsluv_yToL(float Y){
    return Y <= 0.0088564516790356308 ? Y * 903.2962962962963 : 116.0 * pow(Y, 1.0 / 3.0) - 16.0;
}

float hsluv_lToY(float L) {
    return L <= 8.0 ? L / 903.2962962962963 : pow((L + 16.0) / 116.0, 3.0);
}

vec3 xyzToRgb(vec3 tuple) {
    const mat3 m = mat3( 
        3.2409699419045214  ,-1.5373831775700935 ,-0.49861076029300328 ,
       -0.96924363628087983 , 1.8759675015077207 , 0.041555057407175613,
        0.055630079696993609,-0.20397695888897657, 1.0569715142428786  );
    
    return hsluv_fromLinear(tuple*m);
}

vec3 rgbToXyz(vec3 tuple) {
    const mat3 m = mat3(
        0.41239079926595948 , 0.35758433938387796, 0.18048078840183429 ,
        0.21263900587151036 , 0.71516867876775593, 0.072192315360733715,
        0.019330818715591851, 0.11919477979462599, 0.95053215224966058 
    );
    return hsluv_toLinear(tuple) * m;
}

vec3 xyzToLuv(vec3 tuple){
    float X = tuple.x;
    float Y = tuple.y;
    float Z = tuple.z;

    float L = hsluv_yToL(Y);
    
    float div = 1./dot(tuple,vec3(1,15,3)); 

    return vec3(
        1.,
        (52. * (X*div) - 2.57179),
        (117.* (Y*div) - 6.08816)
    ) * L;
}


vec3 luvToXyz(vec3 tuple) {
    float L = tuple.x;

    float U = tuple.y / (13.0 * L) + 0.19783000664283681;
    float V = tuple.z / (13.0 * L) + 0.468319994938791;

    float Y = hsluv_lToY(L);
    float X = 2.25 * U * Y / V;
    float Z = (3./V - 5.)*Y - (X/3.);

    return vec3(X, Y, Z);
}

vec3 luvToLch(vec3 tuple) {
    float L = tuple.x;
    float U = tuple.y;
    float V = tuple.z;

    float C = length(tuple.yz);
    float H = degrees(atan(V,U));
    if (H < 0.0) {
        H = 360.0 + H;
    }
    
    return vec3(L, C, H);
}

vec3 lchToLuv(vec3 tuple) {
    float hrad = radians(tuple.b);
    return vec3(
        tuple.r,
        cos(hrad) * tuple.g,
        sin(hrad) * tuple.g
    );
}

vec3 hsluvToLch(vec3 tuple) {
    tuple.g *= hsluv_maxChromaForLH(tuple.b, tuple.r) * .01;
    return tuple.bgr;
}

vec3 lchToHsluv(vec3 tuple) {
    tuple.g /= hsluv_maxChromaForLH(tuple.r, tuple.b) * .01;
    return tuple.bgr;
}

vec3 hpluvToLch(vec3 tuple) {
    tuple.g *= hsluv_maxSafeChromaForL(tuple.b) * .01;
    return tuple.bgr;
}

vec3 lchToHpluv(vec3 tuple) {
    tuple.g /= hsluv_maxSafeChromaForL(tuple.r) * .01;
    return tuple.bgr;
}

vec3 lchToRgb(vec3 tuple) {
    return xyzToRgb(luvToXyz(lchToLuv(tuple)));
}

vec3 rgbToLch(vec3 tuple) {
    return luvToLch(xyzToLuv(rgbToXyz(tuple)));
}

vec3 hsluvToRgb(vec3 tuple) {
    return lchToRgb(hsluvToLch(tuple));
}

vec3 rgbToHsluv(vec3 tuple) {
    return lchToHsluv(rgbToLch(tuple));
}

vec3 hpluvToRgb(vec3 tuple) {
    return lchToRgb(hpluvToLch(tuple));
}

vec3 rgbToHpluv(vec3 tuple) {
    return lchToHpluv(rgbToLch(tuple));
}

vec3 luvToRgb(vec3 tuple){
    return xyzToRgb(luvToXyz(tuple));
}
`;var Ue;(function(r){r[r.Normal=0]="Normal",r[r.Erase=1]="Erase"})(Ue||(Ue={}));const Ge=r=>({sfact:r.ONE,dfact:r.ONE_MINUS_SRC_ALPHA}),ho=r=>({sfact:r.ZERO,dfact:r.ONE_MINUS_SRC_ALPHA});function mo(r,e){switch(e){case Ue.Normal:return Ge(r);case Ue.Erase:return ho(r)}}function Re(r,e,t){const n=qn(r,e,r.VERTEX_SHADER),s=qn(r,t,r.FRAGMENT_SHADER);if(n===null||s===null)return null;const o=r.createProgram();if(o===null)return console.error("Failed to create program"),null;r.attachShader(o,n),r.attachShader(o,s);const l=po(r,o);return r.deleteShader(n),r.deleteShader(s),l}function qn(r,e,t){const n=r.createShader(t);if(n===null)return console.error("Failed to create shader."),null;if(r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS))return n;console.group("Failed to compile shader"),console.error("shader info log: ",r.getShaderInfoLog(n));const s=go(e);return console.info(s),console.groupEnd(),r.deleteShader(n),null}function po(r,e){return r.linkProgram(e),e!==null||r.getProgramParameter(e,r.LINK_STATUS)?e:(console.group("Failed to link program"),console.error("error: ",r.getError()),console.info("validate status: ",r.getProgramParameter(e,r.VALIDATE_STATUS)),console.info("program info log: ",r.getProgramInfoLog(e)),console.groupEnd(),r.deleteProgram(e),null)}function go(r){const e=r.split(`
`),t=e.length.toString().length;return e.map((n,s)=>_o(s.toString(10),t,"0")+"| "+n).join(`
`)}function _o(r,e,t){const n=e-r.length;if(n<=0)return r;const s=[];for(let o=0;o<n;o++)s.push(t);return s.push(r),s.join("")}var te;(function(r){r[r.I1=0]="I1",r[r.F1=1]="F1",r[r.F2=2]="F2",r[r.F3=3]="F3",r[r.F4=4]="F4"})(te||(te={}));class vo{constructor(e,t){g(this,"location");g(this,"type");this.location=e,this.type=t}}function ft(r,e,t){const n={},s=[];for(const l in t){if(!t.hasOwnProperty(l))continue;const a=r.getUniformLocation(e,l);a===null?s.push(l):n[l]=new vo(a,t[l])}if(s.length===0)return n;let o="Failed to find location for uniforms";for(let l=0;l<s.length;l++)o+=`
 - `+s[l];return console.error(o),null}function ht(r,e,t){for(const n in e){if(!t.hasOwnProperty(n))continue;const s=e[n];switch(s.type){case te.I1:{const o=t[n];r.uniform1i(s.location,o);break}case te.F1:{const o=t[n];r.uniform1f(s.location,o);break}case te.F2:{const o=t[n];r.uniform2f(s.location,o.x,o.y);break}case te.F3:{const o=t[n];r.uniform3f(s.location,o.x,o.y,o.z);break}case te.F4:{const o=t[n];r.uniform4f(s.location,o.x,o.y,o.z,o.w);break}default:throw s.type,{"unexpected type":s}}}}var de;(function(r){r[r.Float=0]="Float"})(de||(de={}));class $o{constructor(e,t){g(this,"name");g(this,"size");g(this,"glType");g(this,"bytes");switch(this.name=t.name,this.size=t.size,t.type){case de.Float:this.glType=e.FLOAT,this.bytes=t.size*4;break;default:throw t.type,{"Unexpected type on attribute":t}}}}class dt{constructor(e,t){g(this,"size");g(this,"stride");g(this,"attributes");{const n=new Array(t.length);for(let s=0;s<t.length;s++){const o=t[s];n[s]=new $o(e,o)}this.attributes=n}{let n=0;for(let s=0;s<this.attributes.length;s++)n+=this.attributes[s].size;this.size=n,this.stride=n*4}}bindAttribLocations(e,t){const{attributes:n}=this;for(let s=0;s<n.length;s++)e.bindAttribLocation(t,s,n[s].name)}vertexAttrib(e){const{attributes:t}=this;let n=0;for(let s=0;s<t.length;s++){const o=t[s];e.vertexAttribPointer(s,o.size,o.glType,!1,this.stride,n),n+=o.bytes}for(let s=0;s<t.length;s++)e.enableVertexAttribArray(s)}getDrawCount(e){return e/this.size}}class bo{constructor(e){g(this,"canvas");g(this,"gl");g(this,"ringRenderer");g(this,"satValRenderer");this.canvas=e;const t=e.getContext("webgl");if(t===null)throw new Error("Failed to init webgl");t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),this.gl=t,this.ringRenderer=new Ro(t),this.satValRenderer=new ko(t)}render(e,t){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.ringRenderer.render(e,t),this.satValRenderer.render(e,t)}getThumbPositions(e,t){const n=this.canvas.getBoundingClientRect();let s,o,l;if(e===J.Hsluv)s=(t.h+180)%360,o=t.s/100,l=t.l/100;else{const h=Xe(t.toRgb());s=(h.h*360+180)%360,o=h.s,l=h.v}let a=0,i=0;if(n!==null){const f=n.left+80,d=n.top+80,m=s*Math.PI/180,p=(80-8)*Math.cos(m),v=(80-8)*Math.sin(m);a=f+p,i=d+v}let c=0,u=0;if(n!==null){const h=n.width*.225,f=n.width*.55;c=n.left+h+f*o,u=n.top+h+f*(1-l)}return{angle:s,circleThumbX:a,circleThumbY:i,areaThumbX:c,areaThumbY:u}}dispose(){this.ringRenderer.dispose(),this.satValRenderer.dispose(),jr(this.canvas)}}const Wn=`
precision highp float;

attribute vec2 a_position;

varying vec2 v_position;

void main() {
    gl_Position = vec4(a_position, 0.0, 1.0);

    v_position = a_position;
}
`;function Jr(r){return`
    precision highp float;
    
    ${uo}

    ${r}
    
    #define INNER_RAD1 0.83
    #define INNER_RAD2 0.85
    #define OUTER_RAD1 0.98
    #define OUTER_RAD2 1.00
    
    varying vec2 v_position;
    
    uniform vec3 u_color;
    
    void main() {
        vec2 pos = v_position * vec2(1.0, -1.0);
        float dist = sqrt(dot(pos, pos));
    
        float a = smoothstep(INNER_RAD1, INNER_RAD2, dist) - smoothstep(OUTER_RAD1, OUTER_RAD2, dist);
    
        float radians = atan(pos.y, pos.x);
        float hue = (radians / TAU) + 0.5;
    
        vec3 hsluv = vec3(hue, 1.0, a);
    
        gl_FragColor = vec4(toRgb(u_color, hsluv) * a, a);
    }
    `}const yo=Jr(`
${Zr}

vec3 toRgb(vec3 color, vec3 xyz) {
    return hsvToRgb(xyz * vec3(1.0, color.y, color.z));
}
`),wo=Jr(`
${Qr}

vec3 toRgb(vec3 color, vec3 xyz) {
    return hsluvToRgb(xyz * vec3(360.0, color.y, color.z));
}
`);class Ro{constructor(e){g(this,"gl");g(this,"buffer");g(this,"program",null);g(this,"colorLocation",null);g(this,"prevColorType",null);this.gl=e,this.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW)}render(e,t){if(!this.program||this.prevColorType!==e){switch(this.program&&this.gl.deleteProgram(this.program),e){case J.Hsv:this.program=Re(this.gl,Wn,yo);break;case J.Hsluv:this.program=Re(this.gl,Wn,wo);break}this.gl.bindAttribLocation(this.program,0,"a_position"),this.colorLocation=this.gl.getUniformLocation(this.program,"u_color"),this.prevColorType=e}switch(this.gl.useProgram(this.program),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(0),e){case J.Hsv:{const n=Xe(qr(t));this.gl.uniform3f(this.colorLocation,n.h,n.s,n.v);break}case J.Hsluv:{this.gl.uniform3f(this.colorLocation,t.h,t.s,t.l);break}}this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}dispose(){this.gl.deleteBuffer(this.buffer),this.gl.deleteProgram(this.program)}}const ue=.55,Kn=`
precision highp float;

attribute vec2 a_position;

varying vec2 v_tex_position;

void main() {
    gl_Position = vec4(a_position, 0.0, 1.0);

    v_tex_position = ((a_position / ${ue.toFixed(2)}) + 1.0) / 2.0;
}
`;function es(r){return`
    precision highp float;

    ${r}
    
    varying vec2 v_tex_position;
    
    uniform vec3 u_color;
    
    void main() {
        // mix saturation from left to right [0, 1]
        // mix value from bottom to top: [0, 1]
        float x = v_tex_position.x;
        float y = v_tex_position.y;
    
        gl_FragColor = vec4(
            toRgb(u_color.x, x, y),
            1.0
        );
    }
    `}const Eo=es(`
${Zr}

vec3 toRgb(float hue, float x, float y) {
    return hsvToRgb(vec3(hue, x, y));
}
`),So=es(`
${Qr}

vec3 toRgb(float hue, float x, float y) {
    return hsluvToRgb(vec3(hue, x * 100.0, y * 100.0));
}
`);class ko{constructor(e){g(this,"gl");g(this,"buffer");g(this,"colorLocation",null);g(this,"program",null);g(this,"prevColorMode",null);this.gl=e,this.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([ue,ue,-ue,ue,ue,-ue,-ue,ue,ue,-ue,-ue,-ue]),e.STATIC_DRAW)}render(e,t){const n=this.gl;if(!this.program||this.prevColorMode!==e){switch(this.program&&n.deleteProgram(this.program),e){case J.Hsv:this.program=Re(n,Kn,Eo);break;case J.Hsluv:this.program=Re(n,Kn,So);break;default:throw{"unexpected color mode":e}}n.bindAttribLocation(this.program,0,"a_position"),this.colorLocation=n.getUniformLocation(this.program,"u_color")}switch(n.useProgram(this.program),n.bindBuffer(n.ARRAY_BUFFER,this.buffer),n.vertexAttribPointer(0,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(0),e){case J.Hsv:{const s=Xe(qr(t));this.gl.uniform3f(this.colorLocation,s.h,s.s,s.v);break}case J.Hsluv:{this.gl.uniform3f(this.colorLocation,t.h,t.s,t.l);break}}n.drawArrays(n.TRIANGLES,0,6),this.prevColorMode=e}dispose(){const e=this.gl;e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}}function To(r){let e,t,n,s,o,l,a,i,c,u,h;return{c(){e=P("div"),t=P("div"),n=P("div"),s=I(),o=P("div"),a=I(),i=P("div"),this.h()},l(f){e=M(f,"DIV",{class:!0});var d=L(e);t=M(d,"DIV",{});var m=L(t);n=M(m,"DIV",{}),L(n).forEach(_),s=B(m),o=M(m,"DIV",{class:!0,style:!0}),L(o).forEach(_),a=B(m),i=M(m,"DIV",{class:!0,style:!0}),L(i).forEach(_),m.forEach(_),d.forEach(_),this.h()},h(){R(o,"class","circleThumb svelte-tp5sjx"),R(o,"style",l=r[3]==null?void 0:`left: ${r[3].circleThumbX}px; top: ${r[3].circleThumbY}px; background-color: ${r[0].toStyle()}; border-color: ${r[0].l>50?"black":"white"}; transform: rotate(${r[3].angle}deg)`),R(i,"class","areaThumb svelte-tp5sjx"),R(i,"style",c=r[3]==null?void 0:`left: ${r[3].areaThumbX}px; top: ${r[3].areaThumbY}px; background-color: ${r[0].toStyle()}; border-color: ${r[0].l>50?"black":"white"}`),R(e,"class","container svelte-tp5sjx")},m(f,d){H(f,e,d),y(e,t),y(t,n),r[7](n),y(t,s),y(t,o),y(t,a),y(t,i),r[8](e),u||(h=ne(e,"mousedown",r[4]),u=!0)},p(f,[d]){d&9&&l!==(l=f[3]==null?void 0:`left: ${f[3].circleThumbX}px; top: ${f[3].circleThumbY}px; background-color: ${f[0].toStyle()}; border-color: ${f[0].l>50?"black":"white"}; transform: rotate(${f[3].angle}deg)`)&&R(o,"style",l),d&9&&c!==(c=f[3]==null?void 0:`left: ${f[3].areaThumbX}px; top: ${f[3].areaThumbY}px; background-color: ${f[0].toStyle()}; border-color: ${f[0].l>50?"black":"white"}`)&&R(i,"style",c)},i:Z,o:Z,d(f){f&&_(e),r[7](null),r[8](null),u=!1,h()}}}function jn(r,e,t){return r>=e&&r<=t}function Fo(r,e,t){let n,{color:s}=e,{colorType:o}=e;const l=Ee(),a=E=>{l("colorChange",E)};var i;(function(E){E[E.Default=0]="Default",E[E.DownOnInner=1]="DownOnInner",E[E.DownOnOuter=2]="DownOnOuter"})(i||(i={}));const c=(1-.55)/2;let u,h,f,d=i.Default;function m(E){if(!u)return;const x=u.getBoundingClientRect(),C=E.clientX-x.left-x.width*.5,z=E.clientY-x.top-x.height*.5,U=Math.atan2(z,C)/(Math.PI*2)+.5;switch(o){case J.Hsv:{const K=Xe(s.toRgb());a(Se(K.with({h:U}).toRgb()));break}case J.Hsluv:{a(s.with({h:U*360}));break}}}function p(E){if(!u)return;const x=u.getBoundingClientRect(),C=x.width*c,z=x.height*c,N=x.width-C*2,U=x.height-z*2,K=ae(E.clientX-x.left-C,0,N),re=ae(E.clientY-x.top-z,0,U),fe=K/N,se=1-re/U;switch(o){case J.Hsv:{const ce=Xe(s.toRgb()).h;a(Se(to(new eo(ce,fe,se))));break}case J.Hsluv:{const ce=s.h;a(new It(ce,fe*100,se*100));break}}}Me(()=>{const E=h;if(E==null)throw{"canvas container ref not found":h};const x=oo({width:160,height:160});return E.appendChild(x),t(6,f=new bo(x)),f.render(o,s),t(3,n=f.getThumbPositions(o,s)),()=>{!f||(h==null||h.removeChild(f.canvas),f.dispose(),jr(f.canvas))}}),Me(()=>{const E=C=>{C.preventDefault(),d=i.Default},x=C=>{switch(d){case i.Default:break;case i.DownOnInner:C.preventDefault(),p(C);break;case i.DownOnOuter:C.preventDefault(),m(C);break}};return window.addEventListener("mouseup",E),window.addEventListener("mouseleave",E),window.addEventListener("mousemove",x),()=>{d=i.Default,window.removeEventListener("mouseup",E),window.removeEventListener("mouseleave",E),window.removeEventListener("mousemove",x)}});function v(E){if(!u)return;const x=u.getBoundingClientRect(),C=ae(E.clientX-x.left,0,x.width),z=ae(E.clientY-x.top,0,x.height),N=x.width*c,U=x.height*c;jn(C,N,x.width-N)&&jn(z,U,x.height-U)?(d=i.DownOnInner,p(E)):(d=i.DownOnOuter,m(E))}function b(E){Ie[E?"unshift":"push"](()=>{h=E,t(2,h)})}function A(E){Ie[E?"unshift":"push"](()=>{u=E,t(1,u)})}return r.$$set=E=>{"color"in E&&t(0,s=E.color),"colorType"in E&&t(5,o=E.colorType)},r.$$.update=()=>{r.$$.dirty&97&&t(3,n=f==null?void 0:f.getThumbPositions(o,s)),r.$$.dirty&97&&f&&f.render(o,s)},[s,u,h,n,v,o,f,b,A]}class Ao extends G{constructor(e){super(),q(this,e,Fo,To,W,{color:0,colorType:5})}}function Lo(r){let e,t;return{c(){e=st("svg"),t=st("path"),this.h()},l(n){e=ot(n,"svg",{width:!0,height:!0,viewBox:!0,xmlns:!0,class:!0});var s=L(e);t=ot(s,"path",{d:!0}),L(t).forEach(_),s.forEach(_),this.h()},h(){R(t,"d","M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34c-.39-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z"),R(e,"width","24"),R(e,"height","24"),R(e,"viewBox","0 0 24 24"),R(e,"xmlns","http://www.w3.org/2000/svg"),R(e,"class","svelte-uxfzd6")},m(n,s){H(n,e,s),y(e,t)},p:Z,i:Z,o:Z,d(n){n&&_(e)}}}class Po extends G{constructor(e){super(),q(this,e,null,Lo,W,{})}}function Mo(r){let e,t;return{c(){e=st("svg"),t=st("path"),this.h()},l(n){e=ot(n,"svg",{width:!0,height:!0,viewBox:!0,xmlns:!0,class:!0});var s=L(e);t=ot(s,"path",{d:!0}),L(t).forEach(_),s.forEach(_),this.h()},h(){R(t,"d","M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"),R(e,"width","24"),R(e,"height","24"),R(e,"viewBox","0 0 24 24"),R(e,"xmlns","http://www.w3.org/2000/svg"),R(e,"class","svelte-uxfzd6")},m(n,s){H(n,e,s),y(e,t)},p:Z,i:Z,o:Z,d(n){n&&_(e)}}}class xo extends G{constructor(e){super(),q(this,e,null,Mo,W,{})}}function Co(r){let e,t;return{c(){e=st("svg"),t=st("path"),this.h()},l(n){e=ot(n,"svg",{width:!0,height:!0,viewBox:!0,xmlns:!0,class:!0});var s=L(e);t=ot(s,"path",{d:!0}),L(t).forEach(_),s.forEach(_),this.h()},h(){R(t,"d","M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"),R(e,"width","24"),R(e,"height","24"),R(e,"viewBox","0 0 24 24"),R(e,"xmlns","http://www.w3.org/2000/svg"),R(e,"class","svelte-uxfzd6")},m(n,s){H(n,e,s),y(e,t)},p:Z,i:Z,o:Z,d(n){n&&_(e)}}}class Io extends G{constructor(e){super(),q(this,e,null,Co,W,{})}}function Bo(r){let e,t,n,s,o;const l=r[2].default,a=Fe(l,r,r[1],null);return{c(){e=P("div"),t=P("div"),n=X(r[0]),s=I(),a&&a.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var c=L(e);t=M(c,"DIV",{class:!0});var u=L(t);n=Y(u,r[0]),u.forEach(_),s=B(c),a&&a.l(c),c.forEach(_),this.h()},h(){R(t,"class","label svelte-19lfj27"),R(e,"class","container svelte-19lfj27")},m(i,c){H(i,e,c),y(e,t),y(t,n),y(e,s),a&&a.m(e,null),o=!0},p(i,[c]){(!o||c&1)&&ie(n,i[0]),a&&a.p&&(!o||c&2)&&Ae(a,l,i,i[1],o?Pe(l,i[1],c,null):Le(i[1]),null)},i(i){o||($(a,i),o=!0)},o(i){w(a,i),o=!1},d(i){i&&_(e),a&&a.d(i)}}}function Do(r,e,t){let{$$slots:n={},$$scope:s}=e,{label:o}=e;return r.$$set=l=>{"label"in l&&t(0,o=l.label),"$$scope"in l&&t(1,s=l.$$scope)},[o,s,n]}class Ye extends G{constructor(e){super(),q(this,e,Do,Bo,W,{label:0})}}const No=r=>({}),Zn=r=>({}),Ho=r=>({}),Qn=r=>({});function Jn(r){let e,t,n,s,o,l,a,i,c,u;const h=r[5].body,f=Fe(h,r,r[4],Qn),d=r[5].footer,m=Fe(d,r,r[4],Zn);return{c(){e=P("div"),t=P("div"),n=P("div"),f&&f.c(),s=I(),o=P("div"),l=I(),a=P("div"),m&&m.c(),this.h()},l(p){e=M(p,"DIV",{class:!0});var v=L(e);t=M(v,"DIV",{class:!0});var b=L(t);n=M(b,"DIV",{class:!0});var A=L(n);f&&f.l(A),A.forEach(_),s=B(b),o=M(b,"DIV",{class:!0}),L(o).forEach(_),l=B(b),a=M(b,"DIV",{class:!0});var E=L(a);m&&m.l(E),E.forEach(_),b.forEach(_),v.forEach(_),this.h()},h(){R(n,"class","content svelte-fn9vql"),R(o,"class","divider svelte-fn9vql"),R(a,"class","footer svelte-fn9vql"),R(t,"class","container svelte-fn9vql"),R(e,"class","backgroundLayer svelte-fn9vql")},m(p,v){H(p,e,v),y(e,t),y(t,n),f&&f.m(n,null),y(t,s),y(t,o),y(t,l),y(t,a),m&&m.m(a,null),r[6](e),i=!0,c||(u=ne(e,"click",r[2]),c=!0)},p(p,v){f&&f.p&&(!i||v&16)&&Ae(f,h,p,p[4],i?Pe(h,p[4],v,Ho):Le(p[4]),Qn),m&&m.p&&(!i||v&16)&&Ae(m,d,p,p[4],i?Pe(d,p[4],v,No):Le(p[4]),Zn)},i(p){i||($(f,p),$(m,p),i=!0)},o(p){w(f,p),w(m,p),i=!1},d(p){p&&_(e),f&&f.d(p),m&&m.d(p),r[6](null),c=!1,u()}}}function Oo(r){let e,t,n=r[0]&&Jn(r);return{c(){n&&n.c(),e=lt()},l(s){n&&n.l(s),e=lt()},m(s,o){n&&n.m(s,o),H(s,e,o),t=!0},p(s,[o]){s[0]?n?(n.p(s,o),o&1&&$(n,1)):(n=Jn(s),n.c(),$(n,1),n.m(e.parentNode,e)):n&&($e(),w(n,1,1,()=>{n=null}),be())},i(s){t||($(n),t=!0)},o(s){w(n),t=!1},d(s){n&&n.d(s),s&&_(e)}}}function zo(r,e,t){let{$$slots:n={},$$scope:s}=e,{isOpen:o}=e,{onClose:l}=e,a;const i=u=>{u.target===a&&l()};Tr(()=>{o?document.body.style.overflow="hidden":document.body.style.overflow=""});function c(u){Ie[u?"unshift":"push"](()=>{a=u,t(1,a)})}return r.$$set=u=>{"isOpen"in u&&t(0,o=u.isOpen),"onClose"in u&&t(3,l=u.onClose),"$$scope"in u&&t(4,s=u.$$scope)},[o,a,i,l,s,n,c]}class Uo extends G{constructor(e){super(),q(this,e,zo,Oo,W,{isOpen:0,onClose:3})}}function Vo(r){let e,t;const n=r[2].default,s=Fe(n,r,r[1],null);return{c(){e=P("div"),s&&s.c(),this.h()},l(o){e=M(o,"DIV",{class:!0,style:!0});var l=L(e);s&&s.l(l),l.forEach(_),this.h()},h(){R(e,"class","row svelte-1r2824"),ve(e,"gap",r[0]+"rem")},m(o,l){H(o,e,l),s&&s.m(e,null),t=!0},p(o,[l]){s&&s.p&&(!t||l&2)&&Ae(s,n,o,o[1],t?Pe(n,o[1],l,null):Le(o[1]),null),(!t||l&1)&&ve(e,"gap",o[0]+"rem")},i(o){t||($(s,o),t=!0)},o(o){w(s,o),t=!1},d(o){o&&_(e),s&&s.d(o)}}}function Xo(r,e,t){let{$$slots:n={},$$scope:s}=e,{spacing:o}=e;return r.$$set=l=>{"spacing"in l&&t(0,o=l.spacing),"$$scope"in l&&t(1,s=l.$$scope)},[o,s,n]}class ts extends G{constructor(e){super(),q(this,e,Xo,Vo,W,{spacing:0})}}function Yo(r){let e,t,n;return{c(){e=P("input"),this.h()},l(s){e=M(s,"INPUT",{class:!0,type:!0}),this.h()},h(){R(e,"class","textInput svelte-x1veui"),R(e,"type","text")},m(s,o){H(s,e,o),r[6](e),Vn(e,r[1]),t||(n=[ne(e,"input",r[7]),ne(e,"paste",r[2]),ne(e,"change",r[2]),ne(e,"keydown",r[3])],t=!0)},p(s,[o]){o&2&&e.value!==s[1]&&Vn(e,s[1])},i:Z,o:Z,d(s){s&&_(e),r[6](null),t=!1,Fr(n)}}}function Go(r,e,t){let n,{initialValue:s}=e,{autoFocus:o=!1}=e;const l=Ee();let a=null;function i(f){l("change",f.target.value)}function c(f){f.key==="Enter"&&l("enter",n)}Me(()=>{o&&(a==null||a.focus())});function u(f){Ie[f?"unshift":"push"](()=>{a=f,t(0,a)})}function h(){n=this.value,t(1,n),t(4,s)}return r.$$set=f=>{"initialValue"in f&&t(4,s=f.initialValue),"autoFocus"in f&&t(5,o=f.autoFocus)},r.$$.update=()=>{r.$$.dirty&16&&t(1,n=s)},[a,n,i,c,s,o,u,h]}class ns extends G{constructor(e){super(),q(this,e,Go,Yo,W,{initialValue:4,autoFocus:5})}}function qo(r){let e,t,n,s,o;return s=new ns({props:{initialValue:r[3],autoFocus:!0}}),s.$on("change",r[12]),s.$on("enter",r[13]),{c(){e=P("div"),t=X(r[0]),n=I(),S(s.$$.fragment),this.h()},l(l){e=M(l,"DIV",{class:!0});var a=L(e);t=Y(a,r[0]),a.forEach(_),n=B(l),k(s.$$.fragment,l),this.h()},h(){R(e,"class","title-text svelte-1tm4qf2")},m(l,a){H(l,e,a),y(e,t),H(l,n,a),T(s,l,a),o=!0},p(l,a){(!o||a&1)&&ie(t,l[0]);const i={};a&8&&(i.initialValue=l[3]),s.$set(i)},i(l){o||($(s.$$.fragment,l),o=!0)},o(l){w(s.$$.fragment,l),o=!1},d(l){l&&_(e),l&&_(n),F(s,l)}}}function Wo(r){let e;return{c(){e=X("Cancel")},l(t){e=Y(t,"Cancel")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function Ko(r){let e;return{c(){e=X("Update")},l(t){e=Y(t,"Update")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function jo(r){let e,t,n,s;return e=new wt({props:{$$slots:{default:[Wo]},$$scope:{ctx:r}}}),e.$on("click",r[6]),n=new Ar({props:{$$slots:{default:[Ko]},$$scope:{ctx:r}}}),n.$on("click",r[11]),{c(){S(e.$$.fragment),t=I(),S(n.$$.fragment)},l(o){k(e.$$.fragment,o),t=B(o),k(n.$$.fragment,o)},m(o,l){T(e,o,l),H(o,t,l),T(n,o,l),s=!0},p(o,l){const a={};l&16384&&(a.$$scope={dirty:l,ctx:o}),e.$set(a);const i={};l&16384&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){s||($(e.$$.fragment,o),$(n.$$.fragment,o),s=!0)},o(o){w(e.$$.fragment,o),w(n.$$.fragment,o),s=!1},d(o){F(e,o),o&&_(t),F(n,o)}}}function Zo(r){let e,t;return e=new ts({props:{spacing:.5,slot:"footer",$$slots:{default:[jo]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&16392&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Qo(r){var E;let e,t,n,s,o,l,a,i=((E=r[1])!=null?E:"")+"",c,u,h,f,d,m,p,v;h=new Uo({props:{isOpen:r[2],onClose:r[6],$$slots:{footer:[Zo],body:[qo]},$$scope:{ctx:r}}});const b=r[10].default,A=Fe(b,r,r[14],null);return{c(){e=P("div"),t=P("div"),n=P("p"),s=X(r[0]),o=I(),l=P("p"),a=X(r[3]),c=X(i),u=I(),S(h.$$.fragment),f=I(),d=P("div"),A&&A.c(),this.h()},l(x){e=M(x,"DIV",{class:!0});var C=L(e);t=M(C,"DIV",{class:!0});var z=L(t);n=M(z,"P",{class:!0});var N=L(n);s=Y(N,r[0]),N.forEach(_),o=B(z),l=M(z,"P",{class:!0});var U=L(l);a=Y(U,r[3]),c=Y(U,i),U.forEach(_),z.forEach(_),u=B(C),k(h.$$.fragment,C),f=B(C),d=M(C,"DIV",{class:!0});var K=L(d);A&&A.l(K),K.forEach(_),C.forEach(_),this.h()},h(){R(n,"class","label svelte-1tm4qf2"),R(l,"class","label svelte-1tm4qf2"),R(t,"class","textContainer svelte-1tm4qf2"),R(d,"class","content svelte-1tm4qf2"),R(e,"class","container svelte-1tm4qf2")},m(x,C){H(x,e,C),y(e,t),y(t,n),y(n,s),y(t,o),y(t,l),y(l,a),y(l,c),y(e,u),T(h,e,null),y(e,f),y(e,d),A&&A.m(d,null),m=!0,p||(v=ne(l,"click",r[5]),p=!0)},p(x,[C]){var N;(!m||C&1)&&ie(s,x[0]),(!m||C&8)&&ie(a,x[3]),(!m||C&2)&&i!==(i=((N=x[1])!=null?N:"")+"")&&ie(c,i);const z={};C&4&&(z.isOpen=x[2]),C&16393&&(z.$$scope={dirty:C,ctx:x}),h.$set(z),A&&A.p&&(!m||C&16384)&&Ae(A,b,x,x[14],m?Pe(b,x[14],C,null):Le(x[14]),null)},i(x){m||($(h.$$.fragment,x),$(A,x),m=!0)},o(x){w(h.$$.fragment,x),w(A,x),m=!1},d(x){x&&_(e),F(h),A&&A.d(x),p=!1,v()}}}function Jo(r,e,t){let n,{$$slots:s={},$$scope:o}=e,{label:l}=e,{valuePostfix:a=void 0}=e,{value:i=""}=e;const c=Ee();let u=!1;const h=E=>{t(3,n=E)},f=()=>{t(2,u=!0)},d=()=>{t(2,u=!1)},m=E=>{E===null||(c("change",E),t(2,u=!1))},p=E=>{h(E),m(E)},v=()=>m(n),b=E=>h(E.detail),A=E=>p(E.detail);return r.$$set=E=>{"label"in E&&t(0,l=E.label),"valuePostfix"in E&&t(1,a=E.valuePostfix),"value"in E&&t(9,i=E.value),"$$scope"in E&&t(14,o=E.$$scope)},r.$$.update=()=>{r.$$.dirty&512&&t(3,n=i)},[l,a,u,n,h,f,d,m,p,i,s,v,b,A,o]}class Q extends G{constructor(e){super(),q(this,e,Jo,Qo,W,{label:0,valuePostfix:1,value:9})}}function er(r,e,t){const n=r.slice();return n[12]=e[t],n}function tr(r,e,t){const n=r.slice();return n[12]=e[t],n}function nr(r){let e,t,n,s,o=r[1](r[0].focus)+"",l,a,i,c,u,h=r[0].getLeft(),f=[];for(let p=0;p<h.length;p+=1)f[p]=rr(tr(r,h,p));let d=r[0].getRight(),m=[];for(let p=0;p<d.length;p+=1)m[p]=sr(er(r,d,p));return{c(){e=P("div"),t=P("div");for(let p=0;p<f.length;p+=1)f[p].c();n=I(),s=P("div"),l=X(o),a=I();for(let p=0;p<m.length;p+=1)m[p].c();this.h()},l(p){e=M(p,"DIV",{class:!0,style:!0});var v=L(e);t=M(v,"DIV",{class:!0});var b=L(t);for(let E=0;E<f.length;E+=1)f[E].l(b);n=B(b),s=M(b,"DIV",{class:!0});var A=L(s);l=Y(A,o),A.forEach(_),a=B(b);for(let E=0;E<m.length;E+=1)m[E].l(b);b.forEach(_),v.forEach(_),this.h()},h(){R(s,"class","optionSelected svelte-2j7vup"),R(t,"class","svelte-2j7vup"),R(e,"class","selectableOptions svelte-2j7vup"),R(e,"style",i=`margin-top: ${r[2]==null?"auto":`calc(-0.5rem - ${r[2].getBoundingClientRect().height}px)`};`)},m(p,v){H(p,e,v),y(e,t);for(let b=0;b<f.length;b+=1)f[b].m(t,null);y(t,n),y(t,s),y(s,l),y(t,a);for(let b=0;b<m.length;b+=1)m[b].m(t,null);c||(u=ne(s,"click",r[5]),c=!0)},p(p,v){if(v&67){h=p[0].getLeft();let b;for(b=0;b<h.length;b+=1){const A=tr(p,h,b);f[b]?f[b].p(A,v):(f[b]=rr(A),f[b].c(),f[b].m(t,n))}for(;b<f.length;b+=1)f[b].d(1);f.length=h.length}if(v&3&&o!==(o=p[1](p[0].focus)+"")&&ie(l,o),v&67){d=p[0].getRight();let b;for(b=0;b<d.length;b+=1){const A=er(p,d,b);m[b]?m[b].p(A,v):(m[b]=sr(A),m[b].c(),m[b].m(t,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=d.length}v&4&&i!==(i=`margin-top: ${p[2]==null?"auto":`calc(-0.5rem - ${p[2].getBoundingClientRect().height}px)`};`)&&R(e,"style",i)},d(p){p&&_(e),sn(f,p),sn(m,p),c=!1,u()}}}function rr(r){let e,t=r[1](r[12])+"",n,s,o;function l(){return r[7](r[12])}return{c(){e=P("div"),n=X(t),this.h()},l(a){e=M(a,"DIV",{class:!0});var i=L(e);n=Y(i,t),i.forEach(_),this.h()},h(){R(e,"class","optionDefault svelte-2j7vup")},m(a,i){H(a,e,i),y(e,n),s||(o=ne(e,"click",l),s=!0)},p(a,i){r=a,i&3&&t!==(t=r[1](r[12])+"")&&ie(n,t)},d(a){a&&_(e),s=!1,o()}}}function sr(r){let e,t=r[1](r[12])+"",n,s,o,l;function a(){return r[8](r[12])}return{c(){e=P("div"),n=X(t),s=I(),this.h()},l(i){e=M(i,"DIV",{class:!0});var c=L(e);n=Y(c,t),s=B(c),c.forEach(_),this.h()},h(){R(e,"class","optionDefault svelte-2j7vup")},m(i,c){H(i,e,c),y(e,n),y(e,s),o||(l=ne(e,"click",a),o=!0)},p(i,c){r=i,c&3&&t!==(t=r[1](r[12])+"")&&ie(n,t)},d(i){i&&_(e),o=!1,l()}}}function el(r){let e,t,n=r[1](r[0].focus)+"",s,o,l,a,i,c=r[3]&&nr(r);return{c(){e=P("div"),t=P("div"),s=X(n),l=I(),c&&c.c(),this.h()},l(u){e=M(u,"DIV",{class:!0});var h=L(e);t=M(h,"DIV",{class:!0});var f=L(t);s=Y(f,n),f.forEach(_),l=B(h),c&&c.l(h),h.forEach(_),this.h()},h(){R(t,"class",o=we(r[3]?"selectedDisplayExpanded":"selectedDisplay")+" svelte-2j7vup"),R(e,"class","container svelte-2j7vup")},m(u,h){H(u,e,h),y(e,t),y(t,s),y(e,l),c&&c.m(e,null),r[9](e),a||(i=[ne(t,"click",r[4]),ne(e,"blur",r[5])],a=!0)},p(u,[h]){h&3&&n!==(n=u[1](u[0].focus)+"")&&ie(s,n),h&8&&o!==(o=we(u[3]?"selectedDisplayExpanded":"selectedDisplay")+" svelte-2j7vup")&&R(t,"class",o),u[3]?c?c.p(u,h):(c=nr(u),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i:Z,o:Z,d(u){u&&_(e),c&&c.d(),r[9](null),a=!1,Fr(i)}}}function tl(r,e,t){let{choices:n}=e,{show:s}=e;const o=Ee();let l=null,a=!1;const i=p=>{if(!a)return;let v=p.target;for(;v.parentElement!==null;){if(v===l)return;v=v.parentElement}u()},c=()=>{t(3,a=!0)},u=()=>{t(3,a=!1)},h=p=>{o("select",p),u()};Me(()=>(document.body.addEventListener("mousedown",i,{passive:!0}),()=>{document.body.removeEventListener("mousedown",i)}));const f=p=>h(p),d=p=>h(p);function m(p){Ie[p?"unshift":"push"](()=>{l=p,t(2,l)})}return r.$$set=p=>{"choices"in p&&t(0,n=p.choices),"show"in p&&t(1,s=p.show)},[n,s,l,a,c,u,h,f,d,m]}class nl extends G{constructor(e){super(),q(this,e,tl,el,W,{choices:0,show:1})}}function rl(r){let e,t,n,s,o,l,a,i,c,u,h,f;return{c(){e=P("div"),t=P("div"),n=P("div"),l=I(),a=P("div"),c=I(),u=P("div"),this.h()},l(d){e=M(d,"DIV",{class:!0});var m=L(e);t=M(m,"DIV",{});var p=L(t);n=M(p,"DIV",{class:!0,style:!0}),L(n).forEach(_),l=B(p),a=M(p,"DIV",{class:!0,style:!0}),L(a).forEach(_),c=B(p),u=M(p,"DIV",{class:!0}),L(u).forEach(_),p.forEach(_),m.forEach(_),this.h()},h(){var d,m;R(n,"class",s=we(r[0]===0?"emptyButton":"button")+" svelte-1v7d1ps"),R(n,"style",o=`left: calc(${r[3]} * calc(100% - 0.75rem)); background-color: ${(d=r[1])==null?void 0:d.toStyle()}`),R(a,"class","filledLineClass svelte-1v7d1ps"),R(a,"style",i=`width: ${r[3]*100}%; background-color: ${(m=r[1])==null?void 0:m.toStyle()}`),R(u,"class","baseline svelte-1v7d1ps"),R(e,"class","container svelte-1v7d1ps")},m(d,m){H(d,e,m),y(e,t),y(t,n),y(t,l),y(t,a),y(t,c),y(t,u),r[5](e),h||(f=ne(e,"mousedown",r[4]),h=!0)},p(d,[m]){var p,v;m&1&&s!==(s=we(d[0]===0?"emptyButton":"button")+" svelte-1v7d1ps")&&R(n,"class",s),m&10&&o!==(o=`left: calc(${d[3]} * calc(100% - 0.75rem)); background-color: ${(p=d[1])==null?void 0:p.toStyle()}`)&&R(n,"style",o),m&10&&i!==(i=`width: ${d[3]*100}%; background-color: ${(v=d[1])==null?void 0:v.toStyle()}`)&&R(a,"style",i)},i:Z,o:Z,d(d){d&&_(e),r[5](null),h=!1,f()}}}function sl(r,e,t){let n,{value:s}=e,{color:o=void 0}=e;const l=Ee();let a=null,i=!1;const c=m=>{if(!a)return;const p=a.getBoundingClientRect(),b=16*.75,A=p.width-b,E=ae(m.clientX-p.left-b/2,0,A);l("change",E/A)},u=m=>{c(m),i=!0},h=()=>{i=!1},f=m=>{i&&c(m)};Me(()=>(document.body.addEventListener("mouseup",h,{passive:!0}),document.body.addEventListener("mouseleave",h,{passive:!0}),document.body.addEventListener("mousemove",f,{passive:!0}),()=>{document.body.removeEventListener("mouseup",h),document.body.removeEventListener("mouseleave",h),document.body.removeEventListener("mousemove",f)}));function d(m){Ie[m?"unshift":"push"](()=>{a=m,t(2,a)})}return r.$$set=m=>{"value"in m&&t(0,s=m.value),"color"in m&&t(1,o=m.color)},r.$$.update=()=>{r.$$.dirty&1&&t(3,n=ae(s,0,1))},[s,o,a,n,u,d]}class ee extends G{constructor(e){super(),q(this,e,sl,rl,W,{value:0,color:1})}}function ol(r){let e,t;const n=r[1].default,s=Fe(n,r,r[0],null);return{c(){e=P("div"),s&&s.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var l=L(e);s&&s.l(l),l.forEach(_),this.h()},h(){R(e,"class","surface svelte-bbao3p")},m(o,l){H(o,e,l),s&&s.m(e,null),t=!0},p(o,[l]){s&&s.p&&(!t||l&1)&&Ae(s,n,o,o[0],t?Pe(n,o[0],l,null):Le(o[0]),null)},i(o){t||($(s,o),t=!0)},o(o){w(s,o),t=!1},d(o){o&&_(e),s&&s.d(o)}}}function ll(r,e,t){let{$$slots:n={},$$scope:s}=e;return r.$$set=o=>{"$$scope"in o&&t(0,s=o.$$scope)},[s,n]}class mt extends G{constructor(e){super(),q(this,e,ll,ol,W,{})}}function al(r){let e,t,n,s,o,l,a,i,c;return{c(){e=P("span"),t=P("span"),n=P("span"),l=I(),a=P("span"),this.h()},l(u){e=M(u,"SPAN",{class:!0});var h=L(e);t=M(h,"SPAN",{class:!0,style:!0});var f=L(t);n=M(f,"SPAN",{class:!0}),L(n).forEach(_),f.forEach(_),l=B(h),a=M(h,"SPAN",{class:!0}),L(a).forEach(_),h.forEach(_),this.h()},h(){R(n,"class",s=we(`switchButton ${r[0]?"bgColorPrimary":"bgColorSecondary"}`)+" svelte-lpbvur"),R(t,"class","switchButtonContainer svelte-lpbvur"),R(t,"style",o=r[0]?"transform: translate(0.75rem, -0.125rem)":"transform: translate(0, -0.125rem)"),R(a,"class","switchBar svelte-lpbvur"),R(e,"class","xswitch svelte-lpbvur")},m(u,h){H(u,e,h),y(e,t),y(t,n),y(e,l),y(e,a),i||(c=ne(e,"click",r[1]),i=!0)},p(u,[h]){h&1&&s!==(s=we(`switchButton ${u[0]?"bgColorPrimary":"bgColorSecondary"}`)+" svelte-lpbvur")&&R(n,"class",s),h&1&&o!==(o=u[0]?"transform: translate(0.75rem, -0.125rem)":"transform: translate(0, -0.125rem)")&&R(t,"style",o)},i:Z,o:Z,d(u){u&&_(e),i=!1,c()}}}function il(r,e,t){let{checked:n}=e;const s=Ee();function o(){s("change",!n)}return r.$$set=l=>{"checked"in l&&t(0,n=l.checked)},[n,o]}class qe extends G{constructor(e){super(),q(this,e,il,al,W,{checked:0})}}function cl(r){let e,t;return e=new ee({props:{value:r[1].h}}),e.$on("change",r[3]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].h),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ul(r){let e,t;return e=new ee({props:{value:r[1].s}}),e.$on("change",r[5]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].s),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function fl(r){let e,t;return e=new ee({props:{value:r[1].l}}),e.$on("change",r[7]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].l),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function hl(r){let e,t,n,s,o,l;return e=new Q({props:{label:"Hue",value:r[1].h.toFixed(2),$$slots:{default:[cl]},$$scope:{ctx:r}}}),e.$on("change",r[4]),n=new Q({props:{label:"Saturation",value:r[1].s.toFixed(2),$$slots:{default:[ul]},$$scope:{ctx:r}}}),n.$on("change",r[6]),o=new Q({props:{label:"Luminosity",value:r[1].l.toFixed(2),$$slots:{default:[fl]},$$scope:{ctx:r}}}),o.$on("change",r[8]),{c(){S(e.$$.fragment),t=I(),S(n.$$.fragment),s=I(),S(o.$$.fragment)},l(a){k(e.$$.fragment,a),t=B(a),k(n.$$.fragment,a),s=B(a),k(o.$$.fragment,a)},m(a,i){T(e,a,i),H(a,t,i),T(n,a,i),H(a,s,i),T(o,a,i),l=!0},p(a,[i]){const c={};i&2&&(c.value=a[1].h.toFixed(2)),i&515&&(c.$$scope={dirty:i,ctx:a}),e.$set(c);const u={};i&2&&(u.value=a[1].s.toFixed(2)),i&515&&(u.$$scope={dirty:i,ctx:a}),n.$set(u);const h={};i&2&&(h.value=a[1].l.toFixed(2)),i&515&&(h.$$scope={dirty:i,ctx:a}),o.$set(h)},i(a){l||($(e.$$.fragment,a),$(n.$$.fragment,a),$(o.$$.fragment,a),l=!0)},o(a){w(e.$$.fragment,a),w(n.$$.fragment,a),w(o.$$.fragment,a),l=!1},d(a){F(e,a),a&&_(t),F(n,a),a&&_(s),F(o,a)}}}function dl(r,e,t){let{sender:n}=e,{color:s}=e;const o=(f,d)=>{const m=ut(f.detail);m!=null&&d(m)},l=f=>n.setColor(s.with({h:f.detail})),a=f=>o(f,d=>n.setColor(s.with({h:d}))),i=f=>n.setColor(s.with({s:f.detail})),c=f=>o(f,d=>n.setColor(s.with({s:d}))),u=f=>n.setColor(s.with({l:f.detail})),h=f=>o(f,d=>n.setColor(s.with({l:d})));return r.$$set=f=>{"sender"in f&&t(0,n=f.sender),"color"in f&&t(1,s=f.color)},[n,s,o,l,a,i,c,u,h]}class ml extends G{constructor(e){super(),q(this,e,dl,hl,W,{sender:0,color:1})}}function pl(r){let e,t;return e=new ee({props:{value:r[1].h}}),e.$on("change",r[3]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].h),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function gl(r){let e,t;return e=new ee({props:{value:r[1].s}}),e.$on("change",r[5]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].s),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function _l(r){let e,t;return e=new ee({props:{value:r[1].v}}),e.$on("change",r[7]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].v),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function vl(r){let e,t,n,s,o,l;return e=new Q({props:{label:"Hue",value:r[1].h.toFixed(2),$$slots:{default:[pl]},$$scope:{ctx:r}}}),e.$on("change",r[4]),n=new Q({props:{label:"Saturation",value:r[1].s.toFixed(2),$$slots:{default:[gl]},$$scope:{ctx:r}}}),n.$on("change",r[6]),o=new Q({props:{label:"Value",value:r[1].v.toFixed(2),$$slots:{default:[_l]},$$scope:{ctx:r}}}),o.$on("change",r[8]),{c(){S(e.$$.fragment),t=I(),S(n.$$.fragment),s=I(),S(o.$$.fragment)},l(a){k(e.$$.fragment,a),t=B(a),k(n.$$.fragment,a),s=B(a),k(o.$$.fragment,a)},m(a,i){T(e,a,i),H(a,t,i),T(n,a,i),H(a,s,i),T(o,a,i),l=!0},p(a,[i]){const c={};i&2&&(c.value=a[1].h.toFixed(2)),i&515&&(c.$$scope={dirty:i,ctx:a}),e.$set(c);const u={};i&2&&(u.value=a[1].s.toFixed(2)),i&515&&(u.$$scope={dirty:i,ctx:a}),n.$set(u);const h={};i&2&&(h.value=a[1].v.toFixed(2)),i&515&&(h.$$scope={dirty:i,ctx:a}),o.$set(h)},i(a){l||($(e.$$.fragment,a),$(n.$$.fragment,a),$(o.$$.fragment,a),l=!0)},o(a){w(e.$$.fragment,a),w(n.$$.fragment,a),w(o.$$.fragment,a),l=!1},d(a){F(e,a),a&&_(t),F(n,a),a&&_(s),F(o,a)}}}function $l(r,e,t){let{sender:n}=e,{color:s}=e;const o=(f,d)=>{const m=ut(f.detail);m!=null&&d(m)},l=f=>n.setColor(Se(s.with({h:f.detail}).toRgb())),a=f=>o(f,d=>n.setColor(Se(s.with({h:d}).toRgb()))),i=f=>n.setColor(Se(s.with({s:f.detail}).toRgb())),c=f=>o(f,d=>n.setColor(Se(s.with({s:d}).toRgb()))),u=f=>n.setColor(Se(s.with({v:f.detail}).toRgb())),h=f=>o(f,d=>n.setColor(Se(s.with({v:d}).toRgb())));return r.$$set=f=>{"sender"in f&&t(0,n=f.sender),"color"in f&&t(1,s=f.color)},[n,s,o,l,a,i,c,u,h]}class bl extends G{constructor(e){super(),q(this,e,$l,vl,W,{sender:0,color:1})}}function yl(r){let e,t;return e=new ee({props:{value:r[1].diameterPx/500}}),e.$on("change",r[8]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].diameterPx/500),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function wl(r){let e,t;return e=new ee({props:{value:r[1].softness}}),e.$on("change",r[10]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].softness),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Rl(r){let e,t;return e=new ee({props:{value:r[1].flowPct}}),e.$on("change",r[12]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].flowPct),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function El(r){let e,t;return e=new ee({props:{value:r[1].spacingPct}}),e.$on("change",r[14]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].spacingPct),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Sl(r){let e,t;return e=new bl({props:{sender:r[0],color:Xe(r[1].color.toRgb())}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.sender=n[0]),s&2&&(o.color=Xe(n[1].color.toRgb())),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function kl(r){let e,t;return e=new ml({props:{sender:r[0],color:r[1].color}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.sender=n[0]),s&2&&(o.color=n[1].color),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Tl(r){let e,t;return e=new qe({props:{checked:r[1].pressureAffectsOpacity}}),e.$on("change",r[16]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.checked=n[1].pressureAffectsOpacity),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Fl(r){let e,t;return e=new qe({props:{checked:r[1].pressureAffectsSize}}),e.$on("change",r[17]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.checked=n[1].pressureAffectsSize),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Al(r){let e,t;return e=new ee({props:{value:r[1].delay.duration/500}}),e.$on("change",r[18]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].delay.duration/500),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ll(r){let e,t,n,s,o,l,a,i,c,u,h,f,d,m,p,v,b,A,E,x,C,z,N,U,K,re,fe,se,ce;n=new nl({props:{choices:r[1].colorMode,show:io}}),n.$on("select",r[5]),o=new Ao({props:{color:r[1].color,colorType:r[1].colorMode.focus}}),o.$on("colorChange",r[6]),i=new Ms({props:{color:r[1].color,colorSecondary:r[1].colorSecondary}}),i.$on("click",function(){Ht(r[0].swapColorFrom)&&r[0].swapColorFrom.apply(this,arguments)}),h=new ns({props:{initialValue:r[1].color.toStyle()}}),h.$on("enter",r[7]),d=new Q({props:{label:"Size",valuePostfix:" px",value:r[1].diameterPx.toFixed(1),$$slots:{default:[yl]},$$scope:{ctx:r}}}),d.$on("change",r[9]),p=new Q({props:{label:"Softness",value:r[1].softness.toFixed(2),$$slots:{default:[wl]},$$scope:{ctx:r}}}),p.$on("change",r[11]),b=new Q({props:{label:"Flow",value:r[1].flowPct.toFixed(2),$$slots:{default:[Rl]},$$scope:{ctx:r}}}),b.$on("change",r[13]),E=new Q({props:{label:"Spacing",valuePostfix:"%",value:r[1].spacingPct.toFixed(2),$$slots:{default:[El]},$$scope:{ctx:r}}}),E.$on("change",r[15]);const pt=[kl,Sl],me=[];function De(V,O){return V[2]===J.Hsluv?0:V[2]===J.Hsv?1:-1}return~(C=De(r))&&(z=me[C]=pt[C](r)),U=new Ye({props:{label:"Pressure-Opacity",$$slots:{default:[Tl]},$$scope:{ctx:r}}}),re=new Ye({props:{label:"Pressure-Size",$$slots:{default:[Fl]},$$scope:{ctx:r}}}),se=new Q({props:{label:"Delay",valuePostfix:"ms",value:r[1].delay.duration.toFixed(0),$$slots:{default:[Al]},$$scope:{ctx:r}}}),se.$on("change",r[19]),{c(){e=P("div"),t=P("div"),S(n.$$.fragment),s=I(),S(o.$$.fragment),l=I(),a=P("div"),S(i.$$.fragment),c=I(),u=P("div"),S(h.$$.fragment),f=I(),S(d.$$.fragment),m=I(),S(p.$$.fragment),v=I(),S(b.$$.fragment),A=I(),S(E.$$.fragment),x=I(),z&&z.c(),N=I(),S(U.$$.fragment),K=I(),S(re.$$.fragment),fe=I(),S(se.$$.fragment),this.h()},l(V){e=M(V,"DIV",{class:!0});var O=L(e);t=M(O,"DIV",{style:!0});var gt=L(t);k(n.$$.fragment,gt),gt.forEach(_),s=B(O),k(o.$$.fragment,O),l=B(O),a=M(O,"DIV",{style:!0});var We=L(a);k(i.$$.fragment,We),We.forEach(_),c=B(O),u=M(O,"DIV",{style:!0});var Ke=L(u);k(h.$$.fragment,Ke),Ke.forEach(_),f=B(O),k(d.$$.fragment,O),m=B(O),k(p.$$.fragment,O),v=B(O),k(b.$$.fragment,O),A=B(O),k(E.$$.fragment,O),x=B(O),z&&z.l(O),N=B(O),k(U.$$.fragment,O),K=B(O),k(re.$$.fragment,O),fe=B(O),k(se.$$.fragment,O),O.forEach(_),this.h()},h(){ve(t,"margin","0.5rem 0"),ve(a,"margin","0.5rem 0"),ve(u,"margin","0.5rem 0"),R(e,"class","detailsContainer svelte-15pr5om")},m(V,O){H(V,e,O),y(e,t),T(n,t,null),y(e,s),T(o,e,null),y(e,l),y(e,a),T(i,a,null),y(e,c),y(e,u),T(h,u,null),y(e,f),T(d,e,null),y(e,m),T(p,e,null),y(e,v),T(b,e,null),y(e,A),T(E,e,null),y(e,x),~C&&me[C].m(e,null),y(e,N),T(U,e,null),y(e,K),T(re,e,null),y(e,fe),T(se,e,null),ce=!0},p(V,O){r=V;const gt={};O&2&&(gt.choices=r[1].colorMode),n.$set(gt);const We={};O&2&&(We.color=r[1].color),O&2&&(We.colorType=r[1].colorMode.focus),o.$set(We);const Ke={};O&2&&(Ke.color=r[1].color),O&2&&(Ke.colorSecondary=r[1].colorSecondary),i.$set(Ke);const On={};O&2&&(On.initialValue=r[1].color.toStyle()),h.$set(On);const Vt={};O&2&&(Vt.value=r[1].diameterPx.toFixed(1)),O&1048579&&(Vt.$$scope={dirty:O,ctx:r}),d.$set(Vt);const Xt={};O&2&&(Xt.value=r[1].softness.toFixed(2)),O&1048579&&(Xt.$$scope={dirty:O,ctx:r}),p.$set(Xt);const Yt={};O&2&&(Yt.value=r[1].flowPct.toFixed(2)),O&1048579&&(Yt.$$scope={dirty:O,ctx:r}),b.$set(Yt);const Gt={};O&2&&(Gt.value=r[1].spacingPct.toFixed(2)),O&1048579&&(Gt.$$scope={dirty:O,ctx:r}),E.$set(Gt);let qt=C;C=De(r),C===qt?~C&&me[C].p(r,O):(z&&($e(),w(me[qt],1,1,()=>{me[qt]=null}),be()),~C?(z=me[C],z?z.p(r,O):(z=me[C]=pt[C](r),z.c()),$(z,1),z.m(e,N)):z=null);const zn={};O&1048579&&(zn.$$scope={dirty:O,ctx:r}),U.$set(zn);const Un={};O&1048579&&(Un.$$scope={dirty:O,ctx:r}),re.$set(Un);const Wt={};O&2&&(Wt.value=r[1].delay.duration.toFixed(0)),O&1048579&&(Wt.$$scope={dirty:O,ctx:r}),se.$set(Wt)},i(V){ce||($(n.$$.fragment,V),$(o.$$.fragment,V),$(i.$$.fragment,V),$(h.$$.fragment,V),$(d.$$.fragment,V),$(p.$$.fragment,V),$(b.$$.fragment,V),$(E.$$.fragment,V),$(z),$(U.$$.fragment,V),$(re.$$.fragment,V),$(se.$$.fragment,V),ce=!0)},o(V){w(n.$$.fragment,V),w(o.$$.fragment,V),w(i.$$.fragment,V),w(h.$$.fragment,V),w(d.$$.fragment,V),w(p.$$.fragment,V),w(b.$$.fragment,V),w(E.$$.fragment,V),w(z),w(U.$$.fragment,V),w(re.$$.fragment,V),w(se.$$.fragment,V),ce=!1},d(V){V&&_(e),F(n),F(o),F(i),F(h),F(d),F(p),F(b),F(E),~C&&me[C].d(),F(U),F(re),F(se)}}}function Pl(r){let e,t;return e=new mt({props:{$$slots:{default:[Ll]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,[s]){const o={};s&1048583&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ml(r,e,t){let n,{sender:s}=e,{brush:o}=e;const l=(N,U)=>{const K=ut(N.detail);K!=null&&U(K)},a=N=>{const U=Js.fromCss(N);U!==null&&s.setColor(Se(U))},i=N=>s.setColorMode(N.detail),c=N=>s.setColor(N.detail),u=N=>a(N.detail),h=N=>s.setDiameter(N.detail*500),f=N=>l(N,s.setDiameter),d=N=>s.setSoftness(N.detail),m=N=>l(N,s.setSoftness),p=N=>s.setOpacity(N.detail),v=N=>l(N,s.setOpacity),b=N=>s.setSpacing(N.detail),A=N=>l(N,s.setSpacing),E=N=>s.setPressureAffectsOpacity(N.detail),x=N=>s.setPressureAffectsSize(N.detail),C=N=>s.setDelay(N.detail*500),z=N=>l(N,s.setDelay);return r.$$set=N=>{"sender"in N&&t(0,s=N.sender),"brush"in N&&t(1,o=N.brush)},r.$$.update=()=>{r.$$.dirty&2&&t(2,n=o.colorMode.focus)},[s,o,n,l,a,i,c,u,h,f,d,m,p,v,b,A,E,x,C,z]}class xl extends G{constructor(e){super(),q(this,e,Ml,Pl,W,{sender:0,brush:1})}}function Cl(r){let e,t;return e=new ee({props:{value:r[1].diameterPx/500}}),e.$on("change",r[3]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].diameterPx/500),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Il(r){let e,t;return e=new ee({props:{value:r[1].softness}}),e.$on("change",r[5]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].softness),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Bl(r){let e,t;return e=new ee({props:{value:r[1].flowPct}}),e.$on("change",r[7]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].flowPct),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Dl(r){let e,t;return e=new ee({props:{value:r[1].spacingPct}}),e.$on("change",r[9]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].spacingPct),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Nl(r){let e,t;return e=new qe({props:{checked:r[1].pressureAffectsOpacity}}),e.$on("change",r[11]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.checked=n[1].pressureAffectsOpacity),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Hl(r){let e,t;return e=new qe({props:{checked:r[1].pressureAffectsSize}}),e.$on("change",r[12]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.checked=n[1].pressureAffectsSize),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ol(r){let e,t;return e=new ee({props:{value:r[1].delay.duration/500}}),e.$on("change",r[13]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].delay.duration/500),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function zl(r){let e,t,n,s,o,l,a,i,c,u,h,f,d,m,p;return t=new Q({props:{label:"Size",valuePostfix:" px",value:r[1].diameterPx.toFixed(1),$$slots:{default:[Cl]},$$scope:{ctx:r}}}),t.$on("change",r[4]),s=new Q({props:{label:"Softness",value:r[1].softness.toFixed(2),$$slots:{default:[Il]},$$scope:{ctx:r}}}),s.$on("change",r[6]),l=new Q({props:{label:"Flow",value:r[1].flowPct.toFixed(2),$$slots:{default:[Bl]},$$scope:{ctx:r}}}),l.$on("change",r[8]),i=new Q({props:{label:"Spacing",valuePostfix:"%",value:r[1].spacingPct.toFixed(2),$$slots:{default:[Dl]},$$scope:{ctx:r}}}),i.$on("change",r[10]),u=new Ye({props:{label:"Pressure-Opacity",$$slots:{default:[Nl]},$$scope:{ctx:r}}}),f=new Ye({props:{label:"Pressure-Size",$$slots:{default:[Hl]},$$scope:{ctx:r}}}),m=new Q({props:{label:"Delay",valuePostfix:"ms",value:r[1].delay.duration.toFixed(0),$$slots:{default:[Ol]},$$scope:{ctx:r}}}),m.$on("change",r[14]),{c(){e=P("div"),S(t.$$.fragment),n=I(),S(s.$$.fragment),o=I(),S(l.$$.fragment),a=I(),S(i.$$.fragment),c=I(),S(u.$$.fragment),h=I(),S(f.$$.fragment),d=I(),S(m.$$.fragment),this.h()},l(v){e=M(v,"DIV",{class:!0});var b=L(e);k(t.$$.fragment,b),n=B(b),k(s.$$.fragment,b),o=B(b),k(l.$$.fragment,b),a=B(b),k(i.$$.fragment,b),c=B(b),k(u.$$.fragment,b),h=B(b),k(f.$$.fragment,b),d=B(b),k(m.$$.fragment,b),b.forEach(_),this.h()},h(){R(e,"class","detailsContainer svelte-15pr5om")},m(v,b){H(v,e,b),T(t,e,null),y(e,n),T(s,e,null),y(e,o),T(l,e,null),y(e,a),T(i,e,null),y(e,c),T(u,e,null),y(e,h),T(f,e,null),y(e,d),T(m,e,null),p=!0},p(v,b){const A={};b&2&&(A.value=v[1].diameterPx.toFixed(1)),b&32771&&(A.$$scope={dirty:b,ctx:v}),t.$set(A);const E={};b&2&&(E.value=v[1].softness.toFixed(2)),b&32771&&(E.$$scope={dirty:b,ctx:v}),s.$set(E);const x={};b&2&&(x.value=v[1].flowPct.toFixed(2)),b&32771&&(x.$$scope={dirty:b,ctx:v}),l.$set(x);const C={};b&2&&(C.value=v[1].spacingPct.toFixed(2)),b&32771&&(C.$$scope={dirty:b,ctx:v}),i.$set(C);const z={};b&32771&&(z.$$scope={dirty:b,ctx:v}),u.$set(z);const N={};b&32771&&(N.$$scope={dirty:b,ctx:v}),f.$set(N);const U={};b&2&&(U.value=v[1].delay.duration.toFixed(0)),b&32771&&(U.$$scope={dirty:b,ctx:v}),m.$set(U)},i(v){p||($(t.$$.fragment,v),$(s.$$.fragment,v),$(l.$$.fragment,v),$(i.$$.fragment,v),$(u.$$.fragment,v),$(f.$$.fragment,v),$(m.$$.fragment,v),p=!0)},o(v){w(t.$$.fragment,v),w(s.$$.fragment,v),w(l.$$.fragment,v),w(i.$$.fragment,v),w(u.$$.fragment,v),w(f.$$.fragment,v),w(m.$$.fragment,v),p=!1},d(v){v&&_(e),F(t),F(s),F(l),F(i),F(u),F(f),F(m)}}}function Ul(r){let e,t;return e=new mt({props:{$$slots:{default:[zl]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,[s]){const o={};s&32771&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Vl(r,e,t){let{sender:n}=e,{brush:s}=e;const o=(A,E)=>{const x=ut(A.detail);x!=null&&E(x)},l=A=>n.setDiameter(A.detail*500),a=A=>o(A,n.setDiameter),i=A=>n.setSoftness(A.detail),c=A=>o(A,n.setSoftness),u=A=>n.setOpacity(A.detail),h=A=>o(A,n.setOpacity),f=A=>n.setSpacing(A.detail),d=A=>o(A,n.setSpacing),m=A=>n.setPressureAffectsOpacity(A.detail),p=A=>n.setPressureAffectsSize(A.detail),v=A=>n.setDelay(A.detail*500),b=A=>o(A,n.setSpacing);return r.$$set=A=>{"sender"in A&&t(0,n=A.sender),"brush"in A&&t(1,s=A.brush)},[n,s,o,l,a,i,c,u,h,f,d,m,p,v,b]}class Xl extends G{constructor(e){super(),q(this,e,Vl,Ul,W,{sender:0,brush:1})}}function Yl(r){let e,t;return e=new Po({}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Gl(r){let e,t;return e=new xo({}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ql(r){let e,t;return e=new Io({}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function or(r){let e,t,n,s;const o=[Kl,Wl],l=[];function a(i,c){return i[3]==="Brush"?0:i[3]==="Eraser"?1:-1}return~(e=a(r))&&(t=l[e]=o[e](r)),{c(){t&&t.c(),n=lt()},l(i){t&&t.l(i),n=lt()},m(i,c){~e&&l[e].m(i,c),H(i,n,c),s=!0},p(i,c){let u=e;e=a(i),e===u?~e&&l[e].p(i,c):(t&&($e(),w(l[u],1,1,()=>{l[u]=null}),be()),~e?(t=l[e],t?t.p(i,c):(t=l[e]=o[e](i),t.c()),$(t,1),t.m(n.parentNode,n)):t=null)},i(i){s||($(t),s=!0)},o(i){w(t),s=!1},d(i){~e&&l[e].d(i),i&&_(n)}}}function Wl(r){let e,t;return e=new Xl({props:{brush:r[1].eraser,sender:r[0].eraser}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.brush=n[1].eraser),s&1&&(o.sender=n[0].eraser),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Kl(r){let e,t;return e=new xl({props:{brush:r[1].brush,sender:r[0].brush}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.brush=n[1].brush),s&1&&(o.sender=n[0].brush),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function jl(r){let e,t,n,s,o,l,a,i,c;n=new Kt({props:{isDown:r[3]==="Brush",$$slots:{default:[Yl]},$$scope:{ctx:r}}}),n.$on("click",r[4]),o=new Kt({props:{isDown:r[3]==="Eraser",$$slots:{default:[Gl]},$$scope:{ctx:r}}}),o.$on("click",r[5]),a=new Kt({props:{isDown:r[3]==="Zoom",$$slots:{default:[ql]},$$scope:{ctx:r}}}),a.$on("click",r[6]);let u=r[2].isDetailsExpanded&&or(r);return{c(){e=P("div"),t=P("div"),S(n.$$.fragment),s=I(),S(o.$$.fragment),l=I(),S(a.$$.fragment),i=I(),u&&u.c(),this.h()},l(h){e=M(h,"DIV",{class:!0});var f=L(e);t=M(f,"DIV",{class:!0});var d=L(t);k(n.$$.fragment,d),s=B(d),k(o.$$.fragment,d),l=B(d),k(a.$$.fragment,d),d.forEach(_),i=B(f),u&&u.l(f),f.forEach(_),this.h()},h(){R(t,"class","surfaceLike leftBar svelte-11igebj"),R(e,"class","toolBarContainer svelte-11igebj")},m(h,f){H(h,e,f),y(e,t),T(n,t,null),y(t,s),T(o,t,null),y(t,l),T(a,t,null),y(e,i),u&&u.m(e,null),c=!0},p(h,[f]){const d={};f&8&&(d.isDown=h[3]==="Brush"),f&128&&(d.$$scope={dirty:f,ctx:h}),n.$set(d);const m={};f&8&&(m.isDown=h[3]==="Eraser"),f&128&&(m.$$scope={dirty:f,ctx:h}),o.$set(m);const p={};f&8&&(p.isDown=h[3]==="Zoom"),f&128&&(p.$$scope={dirty:f,ctx:h}),a.$set(p),h[2].isDetailsExpanded?u?(u.p(h,f),f&4&&$(u,1)):(u=or(h),u.c(),$(u,1),u.m(e,null)):u&&($e(),w(u,1,1,()=>{u=null}),be())},i(h){c||($(n.$$.fragment,h),$(o.$$.fragment,h),$(a.$$.fragment,h),$(u),c=!0)},o(h){w(n.$$.fragment,h),w(o.$$.fragment,h),w(a.$$.fragment,h),w(u),c=!1},d(h){h&&_(e),F(n),F(o),F(a),u&&u.d()}}}function Zl(r,e,t){let n,{sender:s}=e,{tool:o}=e,{transientState:l}=e;const a=()=>s.setTool("Brush"),i=()=>s.setTool("Eraser"),c=()=>s.setTool("Zoom");return r.$$set=u=>{"sender"in u&&t(0,s=u.sender),"tool"in u&&t(1,o=u.tool),"transientState"in u&&t(2,l=u.transientState)},r.$$.update=()=>{r.$$.dirty&2&&t(3,n=o.current)},[s,o,l,n,a,i,c]}class Ql extends G{constructor(e){super(),q(this,e,Zl,jl,W,{sender:0,tool:1,transientState:2})}}function Jl(r){let e,t,n,s,o,l=r[0].opacity.toFixed(2)+"",a;return{c(){e=P("span"),t=P("span"),n=X("Opacity:"),s=I(),o=P("span"),a=X(l)},l(i){e=M(i,"SPAN",{});var c=L(e);t=M(c,"SPAN",{});var u=L(t);n=Y(u,"Opacity:"),u.forEach(_),s=B(c),o=M(c,"SPAN",{});var h=L(o);a=Y(h,l),h.forEach(_),c.forEach(_)},m(i,c){H(i,e,c),y(e,t),y(t,n),y(e,s),y(e,o),y(o,a)},p(i,c){c&1&&l!==(l=i[0].opacity.toFixed(2)+"")&&ie(a,l)},d(i){i&&_(e)}}}function ea(r){let e;return{c(){e=X("Hidden")},l(t){e=Y(t,"Hidden")},m(t,n){H(t,e,n)},p:Z,d(t){t&&_(e)}}}function ta(r){let e,t,n,s,o=(r[0].name||"Layer "+r[0].id)+"",l,a,i;function c(f,d){return f[0].isHidden?ea:Jl}let u=c(r),h=u(r);return{c(){e=P("div"),t=I(),n=P("div"),s=P("div"),l=X(o),a=I(),i=P("div"),h.c(),this.h()},l(f){e=M(f,"DIV",{class:!0}),L(e).forEach(_),t=B(f),n=M(f,"DIV",{class:!0});var d=L(n);s=M(d,"DIV",{class:!0});var m=L(s);l=Y(m,o),m.forEach(_),a=B(d),i=M(d,"DIV",{class:!0});var p=L(i);h.l(p),p.forEach(_),d.forEach(_),this.h()},h(){R(e,"class","layerLeft svelte-1xkk8yf"),R(s,"class","layerName svelte-1xkk8yf"),R(i,"class","layerOpacity svelte-1xkk8yf"),R(n,"class","layerRight svelte-1xkk8yf")},m(f,d){H(f,e,d),H(f,t,d),H(f,n,d),y(n,s),y(s,l),y(n,a),y(n,i),h.m(i,null)},p(f,d){d&1&&o!==(o=(f[0].name||"Layer "+f[0].id)+"")&&ie(l,o),u===(u=c(f))&&h?h.p(f,d):(h.d(1),h=u(f),h&&(h.c(),h.m(i,null)))},d(f){f&&_(e),f&&_(t),f&&_(n),h.d()}}}function na(r){let e,t,n,s,o,l;return t=new mt({props:{$$slots:{default:[ta]},$$scope:{ctx:r}}}),{c(){e=P("div"),S(t.$$.fragment),this.h()},l(a){e=M(a,"DIV",{class:!0});var i=L(e);k(t.$$.fragment,i),i.forEach(_),this.h()},h(){R(e,"class",n=we(r[2]?"selectedLayerWrapper":"unselectedLayerWrapper")+" svelte-1xkk8yf")},m(a,i){H(a,e,i),T(t,e,null),s=!0,o||(l=ne(e,"click",r[4]),o=!0)},p(a,[i]){const c={};i&33&&(c.$$scope={dirty:i,ctx:a}),t.$set(c),(!s||i&4&&n!==(n=we(a[2]?"selectedLayerWrapper":"unselectedLayerWrapper")+" svelte-1xkk8yf"))&&R(e,"class",n)},i(a){s||($(t.$$.fragment,a),s=!0)},o(a){w(t.$$.fragment,a),s=!1},d(a){a&&_(e),F(t),o=!1,l()}}}function ra(r,e,t){let n,{selectedId:s}=e,{layer:o}=e,{onClick:l}=e;const a=()=>l(o.id);return r.$$set=i=>{"selectedId"in i&&t(3,s=i.selectedId),"layer"in i&&t(0,o=i.layer),"onClick"in i&&t(1,l=i.onClick)},r.$$.update=()=>{r.$$.dirty&9&&t(2,n=s===o.id)},[o,l,n,s,a]}class sa extends G{constructor(e){super(),q(this,e,ra,na,W,{selectedId:3,layer:0,onClick:1})}}function lr(r,e,t){const n=r.slice();return n[11]=e[t],n}function oa(r){let e;return{c(){e=X("New")},l(t){e=Y(t,"New")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function la(r){let e;return{c(){e=X("Delete")},l(t){e=Y(t,"Delete")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function aa(r){let e,t,n,s;return e=new wt({props:{title:"New layer",style:"width: 100%",$$slots:{default:[oa]},$$scope:{ctx:r}}}),e.$on("click",r[5]),n=new wt({props:{title:"Delete layer",style:"width: 100%",$$slots:{default:[la]},$$scope:{ctx:r}}}),n.$on("click",r[6]),{c(){S(e.$$.fragment),t=I(),S(n.$$.fragment)},l(o){k(e.$$.fragment,o),t=B(o),k(n.$$.fragment,o)},m(o,l){T(e,o,l),H(o,t,l),T(n,o,l),s=!0},p(o,l){const a={};l&16384&&(a.$$scope={dirty:l,ctx:o}),e.$set(a);const i={};l&16384&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){s||($(e.$$.fragment,o),$(n.$$.fragment,o),s=!0)},o(o){w(e.$$.fragment,o),w(n.$$.fragment,o),s=!1},d(o){F(e,o),o&&_(t),F(n,o)}}}function ia(r){let e,t;return e=new qe({props:{checked:r[1].isHidden}}),e.$on("change",r[7]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.checked=n[1].isHidden),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ca(r){let e,t;return e=new ee({props:{value:r[1].opacity}}),e.$on("change",r[8]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&2&&(o.value=n[1].opacity),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ua(r){let e,t,n,s,o,l,a;return t=new ts({props:{spacing:.25,$$slots:{default:[aa]},$$scope:{ctx:r}}}),s=new Ye({props:{label:"Hidden",$$slots:{default:[ia]},$$scope:{ctx:r}}}),l=new Q({props:{label:"Opacity",value:r[1].opacity.toFixed(2),$$slots:{default:[ca]},$$scope:{ctx:r}}}),l.$on("change",r[9]),{c(){e=P("div"),S(t.$$.fragment),n=I(),S(s.$$.fragment),o=I(),S(l.$$.fragment),this.h()},l(i){e=M(i,"DIV",{class:!0});var c=L(e);k(t.$$.fragment,c),n=B(c),k(s.$$.fragment,c),o=B(c),k(l.$$.fragment,c),c.forEach(_),this.h()},h(){R(e,"class","layersControlsWrapper svelte-8rt2vb")},m(i,c){H(i,e,c),T(t,e,null),y(e,n),T(s,e,null),y(e,o),T(l,e,null),a=!0},p(i,c){const u={};c&16387&&(u.$$scope={dirty:c,ctx:i}),t.$set(u);const h={};c&16387&&(h.$$scope={dirty:c,ctx:i}),s.$set(h);const f={};c&2&&(f.value=i[1].opacity.toFixed(2)),c&16387&&(f.$$scope={dirty:c,ctx:i}),l.$set(f)},i(i){a||($(t.$$.fragment,i),$(s.$$.fragment,i),$(l.$$.fragment,i),a=!0)},o(i){w(t.$$.fragment,i),w(s.$$.fragment,i),w(l.$$.fragment,i),a=!1},d(i){i&&_(e),F(t),F(s),F(l)}}}function ar(r){let e,t;return e=new sa({props:{layer:r[11],selectedId:r[1].id,onClick:r[10]}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&4&&(o.layer=n[11]),s&2&&(o.selectedId=n[1].id),s&1&&(o.onClick=n[10]),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function fa(r){let e,t,n,s,o;t=new mt({props:{$$slots:{default:[ua]},$$scope:{ctx:r}}});let l=r[2],a=[];for(let c=0;c<l.length;c+=1)a[c]=ar(lr(r,l,c));const i=c=>w(a[c],1,1,()=>{a[c]=null});return{c(){e=P("div"),S(t.$$.fragment),n=I(),s=P("div");for(let c=0;c<a.length;c+=1)a[c].c();this.h()},l(c){e=M(c,"DIV",{class:!0});var u=L(e);k(t.$$.fragment,u),n=B(u),s=M(u,"DIV",{class:!0});var h=L(s);for(let f=0;f<a.length;f+=1)a[f].l(h);h.forEach(_),u.forEach(_),this.h()},h(){R(s,"class","layersListWrapper svelte-8rt2vb"),R(e,"class","layersWrapper svelte-8rt2vb")},m(c,u){H(c,e,u),T(t,e,null),y(e,n),y(e,s);for(let h=0;h<a.length;h+=1)a[h].m(s,null);o=!0},p(c,[u]){const h={};if(u&16387&&(h.$$scope={dirty:u,ctx:c}),t.$set(h),u&7){l=c[2];let f;for(f=0;f<l.length;f+=1){const d=lr(c,l,f);a[f]?(a[f].p(d,u),$(a[f],1)):(a[f]=ar(d),a[f].c(),$(a[f],1),a[f].m(s,null))}for($e(),f=l.length;f<a.length;f+=1)i(f);be()}},i(c){if(!o){$(t.$$.fragment,c);for(let u=0;u<l.length;u+=1)$(a[u]);o=!0}},o(c){w(t.$$.fragment,c),a=a.filter(Boolean);for(let u=0;u<a.length;u+=1)w(a[u]);o=!1},d(c){c&&_(e),F(t),sn(a,c)}}}function ha(r,e,t){let n,s,{layers:o}=e,{sender:l}=e;const a=(m,p)=>{const v=ut(m.detail);v!=null&&p(v)},i=()=>l.newLayer(s.id),c=()=>l.removeLayer(s.id),u=m=>l.setHidden(s.id,m.detail),h=m=>l.setOpacity(s.id,m.detail),f=m=>a(m,p=>l.setOpacity(s.id,p)),d=m=>l.selectLayer(m);return r.$$set=m=>{"layers"in m&&t(4,o=m.layers),"sender"in m&&t(0,l=m.sender)},r.$$.update=()=>{r.$$.dirty&16&&t(2,n=o.layers.children),r.$$.dirty&16&&t(1,s=o.current())},[l,s,n,a,o,i,c,u,h,f,d]}class da extends G{constructor(e){super(),q(this,e,ha,fa,W,{layers:4,sender:0})}}function ma(r){let e,t;return e=new ee({props:{value:r[0].zoomPct/4}}),e.$on("change",r[5]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.value=n[0].zoomPct/4),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function pa(r){let e,t;return e=new ee({props:{value:r[0].rotateTurns}}),e.$on("change",r[7]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.value=n[0].rotateTurns),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ga(r){let e,t;return e=new ee({props:{value:ae((r[0].offsetX+2500)/5e3,-5e3,5e3)}}),e.$on("change",r[9]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.value=ae((n[0].offsetX+2500)/5e3,-5e3,5e3)),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function _a(r){let e,t;return e=new ee({props:{value:ae((r[0].offsetY+2500)/5e3,-5e3,5e3)}}),e.$on("change",r[11]),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.value=ae((n[0].offsetY+2500)/5e3,-5e3,5e3)),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function va(r){let e,t,n,s,o,l,a,i,c;return t=new Q({props:{label:"Zoom",valuePostfix:"%",value:r[2](r[0].zoomPct),$$slots:{default:[ma]},$$scope:{ctx:r}}}),t.$on("change",r[6]),s=new Q({props:{label:"Rotate",valuePostfix:" deg",value:r[3](r[0].rotateTurns),$$slots:{default:[pa]},$$scope:{ctx:r}}}),s.$on("change",r[8]),l=new Q({props:{label:"Offset X",valuePostfix:" px",value:r[0].offsetX.toFixed(0),$$slots:{default:[ga]},$$scope:{ctx:r}}}),l.$on("change",r[10]),i=new Q({props:{label:"Offset Y",valuePostfix:" px",value:r[0].offsetY.toFixed(0),$$slots:{default:[_a]},$$scope:{ctx:r}}}),i.$on("change",r[12]),{c(){e=P("div"),S(t.$$.fragment),n=I(),S(s.$$.fragment),o=I(),S(l.$$.fragment),a=I(),S(i.$$.fragment),this.h()},l(u){e=M(u,"DIV",{class:!0});var h=L(e);k(t.$$.fragment,h),n=B(h),k(s.$$.fragment,h),o=B(h),k(l.$$.fragment,h),a=B(h),k(i.$$.fragment,h),h.forEach(_),this.h()},h(){R(e,"class","container svelte-1o7mh2m")},m(u,h){H(u,e,h),T(t,e,null),y(e,n),T(s,e,null),y(e,o),T(l,e,null),y(e,a),T(i,e,null),c=!0},p(u,[h]){const f={};h&1&&(f.value=u[2](u[0].zoomPct)),h&8195&&(f.$$scope={dirty:h,ctx:u}),t.$set(f);const d={};h&1&&(d.value=u[3](u[0].rotateTurns)),h&8195&&(d.$$scope={dirty:h,ctx:u}),s.$set(d);const m={};h&1&&(m.value=u[0].offsetX.toFixed(0)),h&8195&&(m.$$scope={dirty:h,ctx:u}),l.$set(m);const p={};h&1&&(p.value=u[0].offsetY.toFixed(0)),h&8195&&(p.$$scope={dirty:h,ctx:u}),i.$set(p)},i(u){c||($(t.$$.fragment,u),$(s.$$.fragment,u),$(l.$$.fragment,u),$(i.$$.fragment,u),c=!0)},o(u){w(t.$$.fragment,u),w(s.$$.fragment,u),w(l.$$.fragment,u),w(i.$$.fragment,u),c=!1},d(u){u&&_(e),F(t),F(s),F(l),F(i)}}}function $a(r,e,t){const n=v=>(v*100).toFixed(2),s=v=>(v*360).toFixed(1),o=(v,b)=>{const A=ut(v.detail);A!=null&&b(A)};let{camera:l}=e,{sender:a}=e;const i=v=>{a.setZoom(v.detail*4)},c=v=>{o(v,a.setZoom)},u=v=>{a.setRotation(v.detail)},h=v=>{o(v,a.setRotation)},f=v=>{a.setOffset(v.detail*5e3-2500,l.offsetY)},d=v=>{o(v,b=>a.setOffset(b,l.offsetY))},m=v=>{a.setOffset(l.offsetX,v.detail*5e3-2500)},p=v=>{o(v,b=>a.setOffset(l.offsetX,b))};return r.$$set=v=>{"camera"in v&&t(0,l=v.camera),"sender"in v&&t(1,a=v.sender)},[l,a,n,s,o,i,c,u,h,f,d,m,p]}class ba extends G{constructor(e){super(),q(this,e,$a,va,W,{camera:0,sender:1})}}const Nt=class{constructor(e,t,n,s){g(this,"sample0");g(this,"sample1");g(this,"sample2");g(this,"sample3");this.sample0=e,this.sample1=t,this.sample2=n,this.sample3=s}update(e){return new Nt(e,this.sample0,this.sample1,this.sample2)}length(){return this.sample0.length+this.sample1.length+this.sample2.length+this.sample3.length}forEach(e){let t=this.sample0,n=0;for(let s=0;s<t.length;s++)e(t[s],s);n+=t.length,t=this.sample1;for(let s=0;s<t.length;s++)e(t[s],n+s);n+=t.length,t=this.sample2;for(let s=0;s<t.length;s++)e(t[s],n+s);n+=t.length,t=this.sample3;for(let s=0;s<t.length;s++)e(t[s],n+s)}};let Mt=Nt;g(Mt,"empty",new Nt([],[],[],[]));const rs=ct(Mt.empty);function ya(r){let e,t,n,s=r[1].toFixed(3)+"",o,l,a,i,c,u=(r[2]/r[0]).toFixed(3)+"",h,f;return{c(){e=P("div"),t=P("div"),n=X("Max: "),o=X(s),l=X("ms"),a=I(),i=P("div"),c=X("Avg: "),h=X(u),f=X("ms")},l(d){e=M(d,"DIV",{});var m=L(e);t=M(m,"DIV",{});var p=L(t);n=Y(p,"Max: "),o=Y(p,s),l=Y(p,"ms"),p.forEach(_),a=B(m),i=M(m,"DIV",{});var v=L(i);c=Y(v,"Avg: "),h=Y(v,u),f=Y(v,"ms"),v.forEach(_),m.forEach(_)},m(d,m){H(d,e,m),y(e,t),y(t,n),y(t,o),y(t,l),y(e,a),y(e,i),y(i,c),y(i,h),y(i,f)},p(d,[m]){m&2&&s!==(s=d[1].toFixed(3)+"")&&ie(o,s),m&5&&u!==(u=(d[2]/d[0]).toFixed(3)+"")&&ie(h,u)},i:Z,o:Z,d(d){d&&_(e)}}}function wa(r,e,t){let n=0,s=Number.MIN_VALUE,o=0;return Me(()=>rs.subscribe(l=>{t(0,n=l.length()),t(1,s=Number.MIN_VALUE),t(2,o=0),l.forEach(a=>{const i=a.endMs-a.startMs;t(2,o+=i),i>s&&t(1,s=i)})})),[n,s,o]}class Ra extends G{constructor(e){super(),q(this,e,wa,ya,W,{})}}function Ea(r){let e,t;return e=new qe({props:{checked:r[0].displayStats}}),e.$on("change",function(){Ht(r[1].toggleDisplayStats)&&r[1].toggleDisplayStats.apply(this,arguments)}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){r=n;const o={};s&1&&(o.checked=r[0].displayStats),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Sa(r){let e,t;return e=new qe({props:{checked:r[0].highlightRenderBlocks}}),e.$on("change",function(){Ht(r[1].toggleHighlightRenderBlocks)&&r[1].toggleHighlightRenderBlocks.apply(this,arguments)}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){r=n;const o={};s&1&&(o.checked=r[0].highlightRenderBlocks),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ka(r){let e,t,n,s;return e=new Ye({props:{label:"Display rendering stats",$$slots:{default:[Ea]},$$scope:{ctx:r}}}),n=new Ye({props:{label:"Highlight blocks",$$slots:{default:[Sa]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment),t=I(),S(n.$$.fragment)},l(o){k(e.$$.fragment,o),t=B(o),k(n.$$.fragment,o)},m(o,l){T(e,o,l),H(o,t,l),T(n,o,l),s=!0},p(o,[l]){const a={};l&7&&(a.$$scope={dirty:l,ctx:o}),e.$set(a);const i={};l&7&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){s||($(e.$$.fragment,o),$(n.$$.fragment,o),s=!0)},o(o){w(e.$$.fragment,o),w(n.$$.fragment,o),s=!1},d(o){F(e,o),o&&_(t),F(n,o)}}}function Ta(r,e,t){let{config:n}=e,{sender:s}=e;return r.$$set=o=>{"config"in o&&t(0,n=o.config),"sender"in o&&t(1,s=o.sender)},[n,s]}class Fa extends G{constructor(e){super(),q(this,e,Ta,ka,W,{config:0,sender:1})}}class Aa{isEmpty(){return!0}isNonEmpty(){return!1}cons(e){return new Ve(e,this)}foldl(e,t){return t}reverse(){return this}toArray(){return[]}toString(){return"()"}}class Ve{constructor(e,t){g(this,"head");g(this,"tail");this.head=e,this.tail=t}static of(e){return new Ve(e,Te())}isEmpty(){return!1}isNonEmpty(){return!0}cons(e){return new Ve(e,this)}foldl(e,t){let n=this,s=t;for(;n.isNonEmpty();)s=e(s,n.head),n=n.tail;return s}reverse(){let e=this.tail,t=Ve.of(this.head);for(;e.isNonEmpty();)t=t.cons(e.head),e=e.tail;return t}toArray(){const e=[this.head];let t=this.tail;for(;t.isNonEmpty();)e.push(t.head),t=t.tail;return e}toString(){let e="("+this.head,t=this.tail;for(;t.isNonEmpty();)e=e+", "+t.head,t=t.tail;return e+")"}}function Te(){return new Aa}class Et{constructor(e,t,n,s){g(this,"id");g(this,"name");g(this,"opacity");g(this,"isHidden");this.id=e,this.name=t,this.opacity=n,this.isHidden=s}static init(e){return new Et(e,"",1,!1)}get isLeaf(){return!0}with(e){const t=tt(e.name,this.name),n=tt(e.opacity,this.opacity),s=tt(e.isHidden,this.isHidden);return new Et(this.id,t,n,s)}}class $t{constructor(e,t,n,s,o){g(this,"id");g(this,"name");g(this,"opacity");g(this,"isHidden");g(this,"children");this.id=e,this.name=t,this.opacity=n,this.isHidden=s,this.children=o}static init(e){return new $t(e,"",1,!1,[])}get isLeaf(){return!1}with(e){return new $t(this.id,tt(e.name,this.name),tt(e.opacity,this.opacity),tt(e.isHidden,this.isHidden),this.children)}withChildren(e){return new $t(this.id,this.name,this.opacity,this.isHidden,e)}get(e){const t=e.head,n=this.children[t];if(e.tail.isNonEmpty()){if(n.isLeaf)throw new Error("Invariant violation");return n.get(e.tail)}return n}getWithContext(e,t){const n=e.head,s=this.children[n];if(e.tail.isNonEmpty()){if(s.isLeaf)throw new Error("Invariant violation");return s.getWithContext(e.tail,this.isHidden?0:t*this.opacity)}return{id:s.id,name:s.name,opacity:s.isHidden?0:t*s.opacity}}findPath(e){const t=this.children;for(let n=0;n<this.children.length;n++){const s=t[n];if(s.isLeaf){if(s.id===e)return Te().cons(n)}else{const o=s.findPath(e);if(o!==null)return o.cons(n)}}return null}insert(e,t){const n=e.head,s=this.children[n];if(e.tail.isNonEmpty()){if(s.isLeaf)throw new Error("Invariant violation");const o=s.insert(e.tail,t),l=St(this.children,n,o);return this.withChildren(l)}else return this.withChildren(lo(this.children,n,t))}remove(e){const t=e.head,n=this.children[t];if(e.tail.isNonEmpty()){if(n.isLeaf)throw new Error("Invariant violation");const[s,o]=n.remove(e.tail),l=St(this.children,t,s);return[this.withChildren(l),o.cons(t)]}else{const s=this.withChildren(ao(this.children,t));if(s.children.length===0)return[s,Te()];const o=this.children.length===t+1?t-1:t,l=t===o?e:Ve.of(o);return[s,l]}}update(e,t){const n=e.head,s=this.children[n];if(e.tail.isNonEmpty()){if(s.isLeaf)throw new Error("Invariant violation");const o=s.update(e.tail,t),l=St(this.children,n,o);return this.withChildren(l)}else{const o=t(s),l=St(this.children,n,o);return this.withChildren(l)}}collectLeaves(e,t){const n=this.children;for(let s=0;s<n.length;s++){const o=n[s],l=o.isHidden?0:t*o.opacity;o.isLeaf?e.push({id:o.id,name:o.name,opacity:l}):o.collectLeaves(e,l)}}}var he;(function(r){r[r.NewLayerMsg=0]="NewLayerMsg",r[r.RemoveMsg=1]="RemoveMsg",r[r.SelectMsg=2]="SelectMsg",r[r.SetOpacityMsg=3]="SetOpacityMsg",r[r.SetHiddenMsg=4]="SetHiddenMsg"})(he||(he={}));class La{constructor(e){g(this,"id");g(this,"type",he.NewLayerMsg);this.id=e}}class Pa{constructor(e){g(this,"id");g(this,"type",he.RemoveMsg);this.id=e}}class Ma{constructor(e){g(this,"id");g(this,"type",he.SelectMsg);this.id=e}}class xa{constructor(e,t){g(this,"id");g(this,"opacity");g(this,"type",he.SetOpacityMsg);this.id=e,this.opacity=t}}class Ca{constructor(e,t){g(this,"id");g(this,"isHidden");g(this,"type",he.SetHiddenMsg);this.id=e,this.isHidden=t}}class Ia{constructor(e){g(this,"sendMessage");g(this,"newLayer",e=>{this.sendMessage(new La(e))});g(this,"removeLayer",e=>{this.sendMessage(new Pa(e))});g(this,"selectLayer",e=>{this.sendMessage(new Ma(e))});g(this,"setOpacity",(e,t)=>{this.sendMessage(new xa(e,t))});g(this,"setHidden",(e,t)=>{this.sendMessage(new Ca(e,t))});this.sendMessage=e}}class Ce{constructor(e,t,n){g(this,"getNextLayerId");g(this,"layers");g(this,"selectedPath");g(this,"cachedSplitLayers",null);this.getNextLayerId=e,this.layers=t,this.selectedPath=n}static init(){const e=(()=>{let s=1;return()=>s++})(),t=Et.init(e()),n=$t.init(e()).withChildren([t]);return new Ce(e,n,Te().cons(0))}current(){return this.layers.get(this.selectedPath)}update(e){switch(e.type){case he.NewLayerMsg:return this.current().id===e.id?this.newLayer():this;case he.RemoveMsg:return this.current().id===e.id?this.removeCurrent():this;case he.SelectMsg:return this.current().id===e.id?this:this.select(e.id);case he.SetOpacityMsg:{const{id:t,opacity:n}=e;return this.current().id===t?this.updateCurrent(o=>o.with({opacity:n})):this}case he.SetHiddenMsg:{const{id:t,isHidden:n}=e;return this.current().id===t?this.updateCurrent(o=>o.with({isHidden:n})):this}default:throw{"unexpected msg":e}}}split(){if(this.cachedSplitLayers===null){const e=this.layers.children,t=this.selectedPath.head,n=[],s=[],o=1;for(let a=0;a<t;a++){const i=e[a];i.isLeaf?n.push({id:i.id,name:i.name,opacity:o*i.opacity}):i.collectLeaves(n,o)}for(let a=this.selectedPath.head+1;a<e.length;a++){const i=e[a];i.isLeaf?s.push({id:i.id,name:i.name,opacity:o*i.opacity}):i.collectLeaves(s,o)}const l=this.layers.get(this.selectedPath);l.isLeaf?this.cachedSplitLayers={above:n,current:this.layers.getWithContext(this.selectedPath,o),below:s}:(l.collectLeaves(s,o),this.cachedSplitLayers={above:n,current:null,below:s})}return this.cachedSplitLayers}select(e){const t=this.layers.findPath(e);return t===null?this:new Ce(this.getNextLayerId,this.layers,t)}newLayer(){const e=this.layers.insert(this.selectedPath,Et.init(this.getNextLayerId()));return new Ce(this.getNextLayerId,e,this.selectedPath)}removeCurrent(){const[e,t]=this.layers.remove(this.selectedPath);if(t.isNonEmpty())return new Ce(this.getNextLayerId,e,t);const n=this.selectedPath.head,s=e.children.length<=n?n:n-1;return new Ce(this.getNextLayerId,e,Ve.of(s))}updateCurrent(e){return new Ce(this.getNextLayerId,this.layers.update(this.selectedPath,e),this.selectedPath)}}function Ba(r){return{prevPoint:r}}function ss(r,e,t){if(r===null){const m={alpha:t.alpha,color:t.color,position:t.position,rotation:t.rotation,scaledDiameter:e.diameterPx*t.pressure};return[{prevPoint:t},[m]]}const n=r.prevPoint,s=e.spacingPct*e.diameterPx,o=Da(s,n,t);if(o.length===0)return[r,[]];const l=n.pressure===t.pressure,a=n.alpha===t.alpha,i=n.color.is(t.color),c=n.rotation===t.rotation,u=o.length,h=new Array(u);for(let m=0;m<u;m++){const p=o[m],v=a?n.alpha:Oe(p,n.alpha,t.alpha),b=i?n.color:n.color.mix(p,t.color),A=oe.lerp(p,n.position,t.position),E=e.diameterPx*(l?n.pressure:Oe(p,n.pressure,t.pressure)),x=c?n.rotation:Oe(p,n.rotation,t.rotation);h[m]={alpha:v,color:b,position:A,scaledDiameter:E,rotation:x}}const f=h[o.length-1];return[{prevPoint:{alpha:f.alpha,color:f.color,position:f.position,pressure:Oe(o[o.length-1],n.pressure,t.pressure),rotation:f.rotation}},h]}function Da(r,e,t){const n=[],s=t.position.x,o=t.position.y,l=t.pressure,a=Math.max(r*l,.05);let i=e.position.x,c=e.position.y,u=e.pressure;const h=Gn(i,c,s,o);let f=h,d=.5,m=i,p=c,v=u;for(;f>a&&d>0;)d=r*u/f,i+=d*(s-i),c+=d*(o-c),u+=d*(l-u),f=Gn(i,c,s,o),(i!==m||c!==p||u!==v)&&(n.push(1-f/h),m=i,p=c,v=u);return n}function os(r){return r**.92}function ls(r){return console.assert(r>=0,"Delay can't be negative"),{duration:r}}class Fn{constructor(e,t,n){g(this,"x");g(this,"y");g(this,"pressure");this.x=e,this.y=t,this.pressure=n}lerp(e,t){return new Fn(Oe(e,this.x,t.x),Oe(e,this.y,t.y),Oe(e,this.pressure,t.pressure))}}function Na(r,e){return{startTime:r,start:e,end:e}}function Ha(r,e,t,n){if(r.duration===0)return[{startTime:t,start:n,end:n},n];const s=t-e.startTime,o=os(Math.min(s/r.duration,1)),l=e.start.lerp(o,n);return[{startTime:t,start:l,end:n},l]}function Oa(r,e,t){const n=t-e.startTime;if(n>=r.duration)return[e,e.end];const s=os(Math.min(n/r.duration,1)),o=e.start.lerp(s,e.end);return[e,o]}class He{constructor(e,t,n){g(this,"__left");g(this,"focus");g(this,"__right");this.__left=e,this.focus=t,this.__right=n}static singleton(e){return new He(Te(),e,Te())}static fromArray(e){return e.length===0?null:He.unsafeFromArray(e)}static unsafeFromArray(e){let t=Te();for(let n=e.length-1;n>0;n--)t=t.cons(e[n]);return new He(Te(),e[0],t)}getLeft(){return this.__left.reverse().toArray()}getRight(){return this.__right.toArray()}hasLeft(){return this.__left.isNonEmpty()}hasRight(){return this.__right.isNonEmpty()}focusLeft(){return this.__left.isNonEmpty()?new He(this.__left.tail,this.__left.head,this.__right.cons(this.focus)):this}focusRight(){return this.__right.isNonEmpty()?new He(this.__left.cons(this.focus),this.__right.head,this.__right.tail):this}focusf(e){if(e(this.focus))return this;let t=this;for(;t.hasLeft();)if(t=t.focusLeft(),e(t.focus))return t;for(t=this;t.hasRight();)if(t=t.focusRight(),e(t.focus))return t;return this}toArray(){const e=[];let t=this.__left.reverse();for(;t.isNonEmpty();)e.push(t.head),t=t.tail;for(e.push(this.focus),t=this.__right;t.isNonEmpty();)e.push(t.head),t=t.tail;return e}}class ir{constructor(e){g(this,"sendMessage");g(this,"setColor",e=>this.sendMessage(D("SetColor",e)));g(this,"setColorMode",e=>this.sendMessage(D("SetColorMode",e)));g(this,"setDelay",e=>this.sendMessage(D("SetDelay",{delayMs:e})));g(this,"setDiameter",e=>this.sendMessage(D("SetDiameter",{diameterPx:e})));g(this,"setOpacity",e=>this.sendMessage(D("SetOpacity",{opacityPct:e})));g(this,"setSoftness",e=>this.sendMessage(D("SetSoftness",{softnessPct:e})));g(this,"setSpacing",e=>this.sendMessage(D("SetSpacing",{spacingPct:e})));g(this,"setPressureAffectsOpacity",e=>this.sendMessage(D("SetPressureAffectsOpacity",e)));g(this,"setPressureAffectsSize",e=>this.sendMessage(D("SetPressureAffectsSize",e)));g(this,"swapColorFrom",()=>this.sendMessage(D("SwapColor")));this.sendMessage=e}}function gn(){return null}const cr={diameterPx:15,softness:.4,flowPct:.3,colorMode:He.unsafeFromArray([J.Hsluv,J.Hsv]),color:new It(73,100,16),colorSecondary:new It(0,0,100),spacingPct:.05,pressureAffectsOpacity:!1,pressureAffectsSize:!0,delay:ls(5)};function ur(r,e){switch(e.tag){case"SetDiameter":return{...r,diameterPx:ae(e.val.diameterPx,.1,500)};case"SetSoftness":return{...r,softness:ae(e.val.softnessPct,0,1)};case"SetOpacity":return{...r,flowPct:ae(e.val.opacityPct,.01,1)};case"SetColor":return{...r,color:e.val};case"SetColorMode":return{...r,colorMode:r.colorMode.focusf(t=>t===e.val)};case"SetSpacing":return{...r,spacingPct:ae(e.val.spacingPct,.01,1)};case"SetPressureAffectsOpacity":return{...r,pressureAffectsOpacity:e.val};case"SetPressureAffectsSize":return{...r,pressureAffectsSize:e.val};case"SwapColor":return{...r,color:r.colorSecondary,colorSecondary:r.color};case"SetDelay":return{...r,delay:ls(ae(e.val.delayMs,0,500))};default:throw{"unexpected msg":e}}}function _n(r,e,t){const n=as(t),s=Ba(An(r,n)),o=Na(t.time,n);return[{interpState:s,delayState:o},za(r,n)]}function fr(r,e,t,n){if(t===null){const a=_n(r,e,n[0]);return[a[0],[a[1]]]}let s=t.interpState,o=[],l=t.delayState;for(let a=0;a<n.length;a++){const i=n[a],c=as(i),u=Ha(r.delay,l,i.time,c),h=ss(s,r,An(r,u[1]));l=u[0],s=h[0],o=o.concat(h[1])}return[{delayState:l,interpState:s},o]}function hr(r,e,t){if(e===null)return[null,[]];const[n,s]=Oa(r.delay,e.delayState,t),[o,l]=ss(e.interpState,r,An(r,s));return[{delayState:n,interpState:o},l]}function dr(){return[null,[]]}function as(r){return new Fn(r.x,r.y,r.pressure)}function za(r,e){const t=r.flowPct*e.pressure,n=r.color.toRgb().toLinear(),s=new oe(e.x,e.y);return{alpha:t,color:n,position:s,rotation:0,scaledDiameter:r.diameterPx*e.pressure}}function An(r,e){const t=r.flowPct*e.pressure,n=r.color.toRgb().toLinear(),s=new oe(e.x,e.y);return{alpha:t,color:n,position:s,pressure:e.pressure,rotation:0}}class Ua{constructor(e){g(this,"sendMessage");g(this,"setRotation",e=>this.sendMessage(D("SetRotation",{rotationTurns:e})));g(this,"setOffset",(e,t)=>this.sendMessage(D("SetOffset",{offsetX:e,offsetY:t})));g(this,"setZoom",e=>this.sendMessage(D("SetZoom",{zoomPct:e})));this.sendMessage=e}}const Va={offsetX:0,offsetY:0,zoomPct:1,rotateTurns:0};function Xa(r,e){switch(e.tag){case"SetZoom":return{...r,zoomPct:Math.max(.01,e.val.zoomPct)};case"SetOffset":return{...r,offsetX:e.val.offsetX,offsetY:e.val.offsetY};case"SetRotation":return{...r,rotateTurns:e.val.rotationTurns};default:throw{"unexpected msg":e}}}function Ln(r,e,t){let s=(t.x-e.clickPoint.x)/500;s>=0?s=s**2:s=-((-s)**2);const o=e.originalScale+s;return{...r,zoomPct:Math.min(5e3,o)}}function Pn(r,e,t){throw new Error("todo: should be turns, not rad")}function Mn(r,e,t){const n=t.x-e.prevPoint.x,s=t.y-e.prevPoint.y;return{...r,offsetX:r.offsetX+n,offsetY:r.offsetY+s}}class Ya{constructor(e){g(this,"sendMessage");g(this,"brush");g(this,"eraser");g(this,"camera");g(this,"setTool",e=>this.sendMessage(D("SetToolMsg",e)));this.sendMessage=e,this.brush=new ir(t=>e(D("BrushMsg",t))),this.eraser=new ir(t=>e(D("EraserMsg",t))),this.camera=new Ua(t=>e(D("CameraMsg",t)))}}const Ga={brush:cr,eraser:cr,camera:Va,current:"Brush"};function qa(r,e){switch(e.tag){case"SetToolMsg":switch(e.val){case"Brush":return{...r,current:"Brush"};case"Eraser":return{...r,current:"Eraser"};case"Move":return{...r,current:"Move"};case"Zoom":return{...r,current:"Zoom"};case"Rotate":return{...r,current:"Rotate"};default:throw{"unexpected tool type: ":e}}case"BrushMsg":return{...r,brush:ur(r.brush,e.val)};case"EraserMsg":return{...r,eraser:ur(r.eraser,e.val)};case"CameraMsg":return{...r,camera:Xa(r.camera,e.val)};default:throw{"unexpected msg":e}}}function Wa(r,e,t){const n=zt(r,e);switch(n.tag){case"Brush":{const[s,o]=_n(r.brush,r.camera,t);return[r,D("Brush",s),[o]]}case"Eraser":{const[s,o]=_n(r.eraser,r.camera,t);return[r,D("Eraser",s),[o]]}case"Move":{if(n.val!==null)return[r,n,[]];const s={clickPoint:t,prevPoint:t,originalScale:r.camera.zoomPct},o=Mn(r.camera,s,t);return[{...r,camera:o},D("Move",s),[]]}case"Zoom":{if(n.val!==null)return[r,n,[]];const s={clickPoint:t,prevPoint:t,originalScale:r.camera.zoomPct},o=Ln(r.camera,s,t);return[{...r,camera:o},D("Zoom",s),[]]}case"Rotate":{if(n.val!==null)return[r,n,[]];const s={clickPoint:t,prevPoint:t,originalScale:r.camera.zoomPct},o=Pn(r.camera);return[{...r,camera:o},D("Rotate",s),[]]}default:throw{"unxpected state":n}}}function Ka(r,e,t){const n=zt(r,e);switch(n.tag){case"Brush":{const[s,o]=fr(r.brush,r.camera,n.val,t);return[r,D("Brush",s),o]}case"Eraser":{const[s,o]=fr(r.eraser,r.camera,n.val,t);return[r,D("Eraser",s),o]}case"Move":{if(n.val===null)return[r,n,[]];const s=t[t.length-1],o=Mn(r.camera,n.val,s),l={clickPoint:n.val.clickPoint,prevPoint:s,originalScale:n.val.originalScale};return[{...r,camera:o},D("Move",l),[]]}case"Zoom":{if(n.val===null)return[r,n,[]];const s=t[t.length-1],o=Ln(r.camera,n.val,s),l={clickPoint:n.val.clickPoint,prevPoint:s,originalScale:n.val.originalScale};return[{...r,camera:o},D("Zoom",l),[]]}case"Rotate":{if(n.val===null)return[r,n,[]];const s=t[t.length-1],o=Pn(r.camera,n.val),l={clickPoint:n.val.clickPoint,prevPoint:s,originalScale:n.val.originalScale};return[{...r,camera:o},D("Rotate",l),[]]}default:throw{"unxpected state":n}}}function ja(r,e,t){const n=zt(r,e);switch(n.tag){case"Brush":{const[s,o]=dr();return[r,D("Brush",s),o]}case"Eraser":{const[s,o]=dr();return[r,D("Eraser",s),o]}case"Move":{if(n.val===null)return[r,n,[]];const s=Mn(r.camera,n.val,t);return[{...r,camera:s},D("Move",null),[]]}case"Zoom":{if(n.val===null)return[r,n,[]];const s=Ln(r.camera,n.val,t);return[{...r,camera:s},D("Zoom",null),[]]}case"Rotate":{if(n.val===null)return[r,n,[]];const s=Pn(r.camera,n.val);return[{...r,camera:s},D("Rotate",null),[]]}default:throw{"unxpected state":n}}}function Za(r,e,t){const n=zt(r,e);switch(n.tag){case"Brush":{const[s,o]=hr(r.brush,n.val,t);return s===n.val&&o.length===0?[n,o]:[D("Brush",s),o]}case"Eraser":{const[s,o]=hr(r.eraser,n.val,t);return s===n.val&&o.length===0?[n,o]:[D("Eraser",s),o]}default:return[n,[]]}}var mr;(function(r){r[r.BrushState=0]="BrushState",r[r.EraserState=1]="EraserState",r[r.MoveState=2]="MoveState",r[r.ZoomState=3]="ZoomState",r[r.RotateState=4]="RotateState"})(mr||(mr={}));function Qa(){return D("Brush",gn())}function zt(r,e){if(e.tag===r.current)return e;switch(r.current){case"Brush":return D("Brush",gn());case"Eraser":return D("Eraser",gn());case"Move":return D("Move",null);case"Rotate":return D("Rotate",null);case"Zoom":return D("Zoom",null);default:throw r.current,{"Unknown tool type: ":r.current}}}function Ja(r){switch(r.current){case"Brush":return Ue.Normal;case"Eraser":return Ue.Erase;default:return Ue.Normal}}function ei(r){switch(r.current){case"Brush":return r.brush.softness;case"Eraser":return r.eraser.softness;default:return 0}}const kt={None:0,create(r,e,t){let n=0;return r&&(n+=1),e&&(n+=2),t&&(n+=4),n},hasModifiers(r,e){return(r&e)>0},hasShift(r){return(r&1)>0},hasAlt(r){return(r&2)>0},hasCtrl(r){return(r&4)>0},toString(r){return r.toString()},fromString(r){const e=parseInt(r,10);return isNaN(e)?null:e}},Ut={toString(r){return kt.toString(r.modifiers)+"|"+r.code},createKey(r){return Ut.toString({code:r.code,modifiers:kt.create(!!r.shift,!!r.alt,!!r.ctrl)})},fromString(r){const e=r.split("|");if(e.length!==2)return null;const t=e[1],n=kt.fromString(e[0]);return n===null?null:{code:t,modifiers:n}},fromKeyboardEvent(r){return console.log(r),{code:r.code,modifiers:kt.create(r.shiftKey,r.altKey,r.ctrlKey)}}};function ti(r,e){const t=Ut.toString(e),n=[];let s=r.layers;for(;s.isNonEmpty();){if(t in s.head){const o=s.head[t];if(n.push(o.msg),!o.passive)break}s=s.tail}return n}function ni(r){function e(t){r.handle(Ut.fromKeyboardEvent(t))}return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}class ri{nextInt(){return[this.asInt(),this.step()]}nextFloat(){return[this.asInt()/4294967295,this.step()]}next2Floats(){const[e,t]=this.nextFloat(),[n,s]=t.nextFloat();return[e,n,s]}next3Floats(){const[e,t]=this.nextFloat(),[n,s]=t.nextFloat(),[o,l]=s.nextFloat();return[e,n,o,l]}}class Dt extends ri{constructor(t,n,s,o,l){super();g(this,"a");g(this,"b");g(this,"c");g(this,"d");g(this,"value");this.a=t,this.b=n,this.c=s,this.d=o,this.value=l}static create(t){let n=new Dt(t,0,0,0,null);for(let s=0;s<32;s++)n=n.step();return n}asInt(){return this.force().asInt}step(){return this.force().next}display(){return`Xorshift 128 (${this.a}, ${this.b}, ${this.c}, ${this.d})`}force(){if(this.value===null){const t=this.a;let n=this.d;n^=n<<11,n^=n>>>8,n^=t,n^=t>>>19,this.value={asInt:n>>>0,next:new Dt(n,t,this.b,this.c,null)}}return this.value}}function xn(r){return e=>[r,e]}function pr(r,e){return t=>si(r,e,t)}function si(r,e,t){const[n,s]=t.nextFloat(),o=e-r;return[n*o+r,s]}function is(r){return e=>oi(r,e)}function oi(r,e){const t={};for(const n in r){const[s,o]=r[n](e);t[n]=s,e=o}return[t,e]}function li(r,e,t,n){return s=>ai(r,e,t,n,s)}function ai(r,e,t,n,s){const[o,l]=r(s),[a,i]=e(l),[c,u]=t(i);return[n(o,a,c),u]}const it={"--color-primary":r=>r.color.primary.toStyle(),"--color-primaryLight":r=>r.color.primaryLight.toStyle(),"--color-primaryDark":r=>r.color.primaryDark.toStyle(),"--color-secondary":r=>r.color.secondary.toStyle(),"--color-secondaryLight":r=>r.color.secondaryLight.toStyle(),"--color-secondaryDark":r=>r.color.secondaryDark.toStyle(),"--color-onPrimary":r=>r.color.onPrimary.toStyle(),"--color-onSecondary":r=>r.color.onSecondary.toStyle(),"--color-onSurface":r=>r.color.onSurface.toStyle(),"--color-surface":r=>r.color.surface.toStyle(),"--color-background":r=>r.color.background.toStyle(),"--shadows-button":r=>r.shadows.button,"--shadows-menu":r=>r.shadows.menu,"--shadows-surface":r=>r.shadows.surface,"--fonts-monospace":r=>r.fonts.monospace,"--fonts-normal":r=>r.fonts.normal};function ii(r,e,t){for(const n in it){const s=it[n],o=s(e),l=s(t);o!==l&&r.style.setProperty(n,l)}}function ci(r,e){for(const t in it){const n=it[t];r.style.setProperty(t,n(e))}}function ui(r){const e=[];for(const t in it){const n=it[t];e.push(t+":"+n(r))}return e.join("; ")}const pe=(r,e)=>li(pr(0,360),pr(0,r),xn(e),(t,n,s)=>new It(t,n,s)),fi=is({primary:pe(100,80),primaryLight:pe(100,90),primaryDark:pe(100,70),secondary:pe(70,77),secondaryLight:pe(70,87),secondaryDark:pe(70,67),background:pe(20,46),surface:pe(35,38),onPrimary:pe(100,0),onSecondary:pe(100,0),onSurface:pe(100,100)}),hi=xn({button:"0 1px 5px 0 rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12)",surface:"0 1px 5px 0 rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12)",menu:"2px 2px 2px rgba(0, 0, 0, 0.45), 0 5px 8px 0 rgba(0, 0, 0, 0.3)"}),di=xn({normal:'"Helvetica", "Arial", sans-serif',monospace:'"Courier New", Courier, monospace'}),cs=is({color:fi,shadows:hi,fonts:di}),mi=`
precision highp float;

attribute vec2 a_position;

uniform vec2 u_resolution;

varying vec2 v_tex_coords;

void main() {
    vec2 pos = a_position / u_resolution;
    pos.y = 1.0 - pos.y;
    v_tex_coords = pos;
    pos = pos * 2.0;
    pos = pos - 1.0;
    gl_Position = vec4(pos, 0.0, 1.0);
    
}
`,pi=`
precision highp float;

${fo}

varying vec2 v_tex_coords;

uniform sampler2D u_texture;

void main() {
    vec4 pixel = texture2D(u_texture, v_tex_coords);
    gl_FragColor = vec4(from_linear(pixel.rgb), pixel.a);
}
`,Tt=r=>new dt(r,[{name:"a_position",size:2,type:de.Float}]),gi={u_resolution:te.F2,u_texture:te.I1};class Cn{constructor(e,t,n){g(this,"program");g(this,"locations");g(this,"buffer");g(this,"array");g(this,"capacity",1024);this.program=t,this.locations=n,this.buffer=e.createBuffer(),this.array=new Float32Array(Tt(e).size*6*this.capacity)}static create(e){const t=Re(e,mi,pi);if(t===null)return null;const n=ft(e,t,gi);return n===null?null:(Tt(e).bindAttribLocations(e,t),new Cn(e,t,n))}render(e,t){const{sfact:n,dfact:s}=Ge(e);e.blendFunc(n,s),e.useProgram(this.program),e.bindFramebuffer(e.FRAMEBUFFER,null),this.capacity<t.blocks.length&&(this.capacity=t.blocks.length,this.array=new Float32Array(Tt(e).size*6*this.capacity));const o=this.array;let l=0;for(let a=0;a<t.blocks.length;a++){const{x0:i,y0:c,x1:u,y1:h}=t.blocks[a];o[l++]=i,o[l++]=c,o[l++]=i,o[l++]=h,o[l++]=u,o[l++]=c,o[l++]=i,o[l++]=h,o[l++]=u,o[l++]=c,o[l++]=u,o[l++]=h}e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),ht(e,this.locations,t.uniforms),Tt(e).vertexAttrib(e),e.drawArrays(e.TRIANGLES,0,6*t.blocks.length)}dispose(e){e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}}const _i=`
precision highp float;

attribute vec2 a_position;

varying vec2 v_position;

void main() {
  gl_Position = vec4(a_position, 0.0, 1.0);
  
  v_position = a_position;
}
`,vi=`
precision highp float;

varying vec2 v_position;

uniform float u_softness;

void main() {
  float radius = 1.0 - u_softness;
  float dist = sqrt(dot(v_position, v_position));
  float a = 1.0 - smoothstep(radius, radius + u_softness, dist);

  gl_FragColor = vec4(vec3(0.0), (a));
}
`,gr=r=>new dt(r,[{name:"a_position",size:2,type:de.Float}]),$i={u_softness:te.F1};class In{constructor(e,t,n){g(this,"program");g(this,"locations");g(this,"buffer");g(this,"array");this.program=t,this.locations=n,this.buffer=e.createBuffer();const s=new Float32Array(12);s[0]=-1,s[1]=-1,s[2]=-1,s[3]=1,s[4]=1,s[5]=-1,s[6]=-1,s[7]=1,s[8]=1,s[9]=-1,s[10]=1,s[11]=1,this.array=s}static create(e){const t=Re(e,_i,vi);if(t===null)return null;const n=ft(e,t,$i);return n===null?null:(gr(e).bindAttribLocations(e,t),new In(e,t,n))}generateBrushTexture(e,t){const{sfact:n,dfact:s}=Ge(e);e.blendFunc(n,s),e.useProgram(this.program),e.viewport(0,0,t.size.x,t.size.y),e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),ht(e,this.locations,t.uniforms),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.array,e.STATIC_DRAW),gr(e).vertexAttrib(e),e.drawArrays(e.TRIANGLES,0,6)}dispose(e){e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}}const bi=`
precision highp float;

attribute vec2 a_position;

uniform vec2 u_resolution;

varying vec2 v_tex_coords;

void main() {
    vec2 pos = a_position / u_resolution;
    pos.y = 1.0 - pos.y;
    pos = pos * 2.0;
    pos = pos - 1.0;
    gl_Position = vec4(pos, 0.0, 1.0);
    
    v_tex_coords = a_position / u_resolution;
}
`,yi=`
precision highp float;

varying vec2 v_tex_coords;

uniform sampler2D u_texture;
uniform float u_opacity;

void main() {
    vec4 pixel = texture2D(u_texture, v_tex_coords);
    gl_FragColor = pixel * u_opacity;
}
`,Ft=r=>new dt(r,[{name:"a_position",size:2,type:de.Float}]),wi={u_texture:te.I1,u_resolution:te.F2,u_opacity:te.F1};class Bn{constructor(e,t,n){g(this,"program");g(this,"locations");g(this,"buffer");g(this,"array");g(this,"capacity",1024);this.program=t,this.locations=n,this.buffer=e.createBuffer(),this.array=new Float32Array(Ft(e).size*6*this.capacity)}static create(e){const t=Re(e,bi,yi);if(t===null)return null;const n=ft(e,t,wi);return n===null?null:(Ft(e).bindAttribLocations(e,t),new Bn(e,t,n))}render(e,t){if(t.framebuffer==null)throw new Error("Framebuffer should be defined");const{sfact:n,dfact:s}=Ge(e);e.blendFunc(n,s),e.useProgram(this.program),e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer),this.capacity<t.blocks.length&&(this.capacity=t.blocks.length,this.array=new Float32Array(Ft(e).size*6*this.capacity));const o=this.array;let l=0;for(let a=0;a<t.blocks.length;a++){const{x0:i,y0:c,x1:u,y1:h}=t.blocks[a];o[l++]=i,o[l++]=c,o[l++]=i,o[l++]=h,o[l++]=u,o[l++]=c,o[l++]=i,o[l++]=h,o[l++]=u,o[l++]=c,o[l++]=u,o[l++]=h}e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),ht(e,this.locations,t.uniforms),Ft(e).vertexAttrib(e),e.drawArrays(e.TRIANGLES,0,6*t.blocks.length)}dispose(e){e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}}const Ri=`
precision highp float;

attribute vec2 a_position;

uniform vec2 u_resolution;

void main() {
    vec2 pos = a_position / u_resolution;
    pos.y = 1.0 - pos.y;
    pos = pos * 2.0;
    pos = pos - 1.0;
    gl_Position = vec4(pos, 0.0, 1.0);
}
`,Ei=`
precision highp float;

uniform vec4 u_rgba;

void main() {
    gl_FragColor = u_rgba;
}
`,At=r=>new dt(r,[{name:"a_position",size:2,type:de.Float}]),Si={u_resolution:te.F2,u_rgba:te.F4};class Dn{constructor(e,t,n){g(this,"program");g(this,"locations");g(this,"buffer");g(this,"array");g(this,"capacity",1024);this.program=t,this.locations=n,this.buffer=e.createBuffer(),this.array=new Float32Array(At(e).size*6*this.capacity)}static create(e){const t=Re(e,Ri,Ei);if(t===null)return null;const n=ft(e,t,Si);return n===null?null:(At(e).bindAttribLocations(e,t),new Dn(e,t,n))}render(e,t){if(t.framebuffer==null)throw new Error("Framebuffer should be defined");const{sfact:n,dfact:s}=Ge(e);e.blendFunc(n,s),e.useProgram(this.program),e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer),this.capacity<t.blocks.length&&(this.capacity=t.blocks.length,this.array=new Float32Array(At(e).size*6*this.capacity));const o=this.array;let l=0;for(let a=0;a<t.blocks.length;a++){const{x0:i,y0:c,x1:u,y1:h}=t.blocks[a];o[l++]=i,o[l++]=c,o[l++]=i,o[l++]=h,o[l++]=u,o[l++]=c,o[l++]=i,o[l++]=h,o[l++]=u,o[l++]=c,o[l++]=u,o[l++]=h}e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),ht(e,this.locations,t.uniforms),At(e).vertexAttrib(e),e.drawArrays(e.TRIANGLES,0,6*t.blocks.length)}dispose(e){e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}}const ki=`
precision highp float;

attribute vec2 a_position;
attribute float a_opacity;

uniform vec2 u_resolution;

varying float v_opacity;

void main() {
    vec2 pos = a_position / u_resolution;
    pos.y = 1.0 - pos.y;
    pos = pos * 2.0;
    pos = pos - 1.0;
    gl_Position = vec4(pos, 0.0, 1.0);

    v_opacity = a_opacity;
}
`,Ti=`
precision highp float;

varying float v_opacity;

uniform vec4 u_rgba;

void main() {
    gl_FragColor = u_rgba * v_opacity;
}
`,Fi=r=>new dt(r,[{name:"a_position",size:2,type:de.Float},{name:"a_opacity",size:1,type:de.Float}]),Ai={u_resolution:te.F2,u_rgba:te.F4},Qe=class{constructor(e,t,n){g(this,"program");g(this,"locations");g(this,"buffer");g(this,"array");g(this,"capacity",1024);this.program=t,this.locations=n,this.buffer=e.createBuffer(),this.array=new Float32Array(Qe.attributesInfo.size*6*this.capacity)}static create(e){const t=Re(e,ki,Ti);if(t===null)return null;const n=ft(e,t,Ai);return n===null?null:(this.attributesInfo=Fi(e),this.attributesInfo.bindAttribLocations(e,t),new Qe(e,t,n))}render(e,t){if(t.framebuffer==null)throw new Error("Framebuffer should be defined");const{sfact:n,dfact:s}=Ge(e);e.blendFunc(n,s),e.useProgram(this.program),e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer),this.capacity<t.blockHighlights.length&&(this.capacity=t.blockHighlights.length,this.array=new Float32Array(Qe.attributesInfo.size*6*this.capacity));const o=this.array;let l=0;for(let a=0;a<t.blockHighlights.length;a++){const{block:i,opacity:c}=t.blockHighlights[a],{x0:u,y0:h,x1:f,y1:d}=i;o[l++]=u,o[l++]=h,o[l++]=c,o[l++]=u,o[l++]=d,o[l++]=c,o[l++]=f,o[l++]=h,o[l++]=c,o[l++]=u,o[l++]=d,o[l++]=c,o[l++]=f,o[l++]=h,o[l++]=c,o[l++]=f,o[l++]=d,o[l++]=c}e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),ht(e,this.locations,t.uniforms),Qe.attributesInfo.vertexAttrib(e),e.drawArrays(e.TRIANGLES,0,6*t.blockHighlights.length)}dispose(e){e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}};let xt=Qe;g(xt,"attributesInfo");const Li=5e3,Pi=`
precision highp float;

attribute vec4 a_color;
attribute vec2 a_tex_coords;
attribute vec2 a_position;

uniform vec2 u_resolution;

varying vec4 v_color;
varying vec2 v_tex_coords;

void main() {
    vec2 pos = (a_position / u_resolution) * vec2(2.0, -2.0) + vec2(-1.0, 1.0);
    gl_Position = vec4(pos, 0.0, 1.0);

    v_color = vec4(a_color.rgb * a_color.a, a_color.a);
    v_tex_coords = a_tex_coords;
}
`,Mi=`
precision highp float;

varying vec4 v_color;
varying vec2 v_tex_coords;

uniform sampler2D u_texture;

void main() {
    float alpha = texture2D(u_texture, v_tex_coords).a;
    gl_FragColor = v_color * alpha;
}
`,Lt=r=>new dt(r,[{name:"a_color",size:4,type:de.Float},{name:"a_tex_coords",size:2,type:de.Float},{name:"a_position",size:2,type:de.Float}]),xi={u_resolution:te.F2,u_texture:te.I1};function _r(){return{x0:Number.MAX_VALUE,y0:Number.MAX_VALUE,x1:Number.MIN_VALUE,y1:Number.MIN_VALUE}}class Nn{constructor(e,t,n){g(this,"gl");g(this,"program");g(this,"locations");g(this,"buffer");g(this,"array");g(this,"offset");g(this,"affectedArea");this.gl=e,this.program=t,this.locations=n;const s=Lt(e).size*6*Li;this.buffer=e.createBuffer(),this.array=new Float32Array(s),this.offset=0,this.affectedArea=_r()}static create(e){const t=Re(e,Pi,Mi);if(t===null)return null;const n=ft(e,t,xi);return n===null?null:(Lt(e).bindAttribLocations(e,t),new Nn(e,t,n))}get canFlush(){return this.offset>0}addPoints(e){const t=6*Lt(this.gl).size*e.length+this.offset;for(;t>this.array.length;)this.array=Ci(this.array);const n=this.array,s=e.length;let o=this.offset;for(let l=0;l<s;l++)o=Ii(n,o,e[l],this.affectedArea);this.offset=o}getAffectedArea(){const{affectedArea:e}=this;return new at(e.x0,e.y0,e.x1,e.y1)}flush(e,t){e.useProgram(this.program);const n=this.array.subarray(0,this.offset),{sfact:s,dfact:o}=mo(e,t.blendMode);e.blendFunc(s,o),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,n,e.DYNAMIC_DRAW),ht(e,this.locations,t.uniforms);const l=Lt(e);l.vertexAttrib(e);const a=l.getDrawCount(this.offset);e.drawArrays(e.TRIANGLES,0,a),this.offset=0,this.affectedArea=_r()}dispose(e){e.deleteBuffer(this.buffer),e.deleteProgram(this.program)}}function Ci(r){const e=new Float32Array(r.length*2);for(let t=0;t<r.length;t++)e[t]=r[t];return e}function Ii(r,e,t,n){const s=t.position.x,o=t.position.y,l=t.scaledDiameter*.5,a=s-l,i=o-l,c=s+l,u=o+l;return e=Ze(r,e,t,0,0,a,i),e=Ze(r,e,t,1,0,c,i),e=Ze(r,e,t,0,1,a,u),e=Ze(r,e,t,1,1,c,u),e=Ze(r,e,t,0,1,a,u),e=Ze(r,e,t,1,0,c,i),a<n.x0&&(n.x0=a),i<n.y0&&(n.y0=i),c>n.x1&&(n.x1=c),u>n.y1&&(n.y1=u),e}function Ze(r,e,t,n,s,o,l){return r[e++]=t.color.r,r[e++]=t.color.g,r[e++]=t.color.b,r[e++]=t.alpha,r[e++]=n,r[e++]=s,r[e++]=o,r[e++]=l,e}const bt=32,yt=32;class vr{constructor(e,t){g(this,"x0");g(this,"y0");g(this,"x1");g(this,"y1");this.x0=e*bt,this.y0=t*yt,this.x1=(e+1)*bt,this.y1=(t+1)*yt}eq(e){return this.x0===e.x0&&this.y0===e.y0}getHashcode(){let e=0;return e=(e<<5)-e+this.x0,e=(e<<5)-e+this.y0,e}contains(e){return e.x>=this.x0&&e.x<=this.x1&&e.y>=this.y0&&e.y<=this.y1}}class Bi{constructor(e){g(this,"debugHighlightTimeMs");g(this,"_newBrushPoints",[]);g(this,"_strokeBlocks",[]);g(this,"_renderBlocks",[]);g(this,"_finalHighlights",[]);g(this,"_lastUpdateMs",0);this.debugHighlightTimeMs=e}getFrameBlocks(){const e=this._renderBlocks,t=this._finalHighlights,n=e.length+t.length,s=new Array(n);let o=0;for(let l=0;l<e.length;l++)s[o++]=e[l].block;for(let l=0;l<t.length;l++)s[o++]=t[l];return s}getStrokeBlocks(){return this._strokeBlocks}getHighlights(){if(this.debugHighlightTimeMs===0)return[];const e=this.debugHighlightTimeMs,t=this._renderBlocks,n=this._lastUpdateMs,s=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o],a=n-l.drawTimeMs;s[o]={opacity:ae(1-a/e,0,1),block:l.block}}return s}addBrushPoints(e){for(let t=0;t<e.length;t++)this._newBrushPoints.push(e[t])}update(e){const t=this._newBrushPoints,n=this._renderBlocks,s=this._finalHighlights;s.length=0;for(let l=0;l<n.length;l++)e-n[l].drawTimeMs>this.debugHighlightTimeMs&&(s.push(n[l].block),n.splice(l,1),l-=1);for(let l=0;l<t.length;l++){const a=t[l],i=a.scaledDiameter/2,c=a.position.x-i,u=a.position.y-i,h=a.position.x+i,f=a.position.y+i,d=c/bt|0,m=u/yt|0,p=h/bt|0,v=f/yt|0;for(let b=m;b<=v;b++)for(let A=d;A<=p;A++){const E=new vr(A,b);let x=-1;for(let C=0;C<n.length;C++)if(n[C].block.eq(E)){n[C].drawTimeMs=e,x=C;break}x===-1&&n.push({drawTimeMs:e,block:E})}}t.length=0;const o=this._strokeBlocks;for(let l=0;l<n.length;l++){const{block:a}=n[l];let i=!1;for(let c=0;c<o.length;c++)if(a.eq(o[c])){i=!0;break}i||o.push(a)}this._lastUpdateMs=e}fillAll(e,t){const n=t.x/bt|0,s=t.y/yt|0,o=this._renderBlocks;let l=0;for(let a=0;a<s;a++)for(let i=0;i<n;i++){const c=new vr(i,a);o[l++]={drawTimeMs:e,block:c}}}strokeEnded(){this._strokeBlocks.length=0}}let Di=1;class us{constructor(e,t){g(this,"id");g(this,"texture");g(this,"framebuffer");this.id=Di++,this.texture=e,this.framebuffer=t}}function ke(r,e,t,n){const s=new us(r.createTexture(),r.createFramebuffer());e.push(s),xe(r,t,s),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.x,n.y,0,r.RGBA,r.FLOAT,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindFramebuffer(r.FRAMEBUFFER,s.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s.texture,0);const o=r.checkFramebufferStatus(r.FRAMEBUFFER);switch(o){case r.FRAMEBUFFER_COMPLETE:break;case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT for texture:",s);break;case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT for texture:",s);break;case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS for texture:",s);break;case r.FRAMEBUFFER_UNSUPPORTED:console.warn("FRAMEBUFFER_UNSUPPORTED for texture:",s);break;default:throw new Error("Unexpected status: "+o)}return s}function xe(r,e,{texture:t,id:n}){for(let s=0;s<e.length;s++)if(e[s][0]===n)return r.activeTexture(r.TEXTURE0+s),s;for(let s=0;s<e.length;s++)if(e[s][0]===null)return r.activeTexture(r.TEXTURE0+s),r.bindTexture(r.TEXTURE_2D,t),e[s]=[n,performance.now()],s;{let s=Number.MAX_VALUE,o=0;for(let l=0;l<e.length;l++){const a=e[l][1];a<s&&(s=a,o=l)}return r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,t),e[o]=[n,performance.now()],o}}class Ni{constructor(e,t){g(this,"above");g(this,"below");g(this,"current");g(this,"anyChange");const n=t.above,s=t.below;let o=null,l=null;if($r(e.above,n)){o=[];for(let a=0;a<n.length;a++){const i=n[a];i.opacity!==0&&o.push(i)}}if($r(e.below,s)){l=[];for(let a=s.length-1;a>=0;a--){const i=s[a];i.opacity!==0&&l.push(i)}}this.above=o,this.below=l,this.current=t.current,this.anyChange=e.current!==t.current||o!==null||l!==null}}function $r(r,e){if(r.length!==e.length)return!0;for(let t=0;t<e.length;t++)if(r[t].id!==e[t].id)return!0;return!1}function Hi(r){const{gl:e,allTextures:t,resolution:n,layersToRender:s,textureShader:o,textureBindings:l,layerTextureMap:a}=r,i=s.above,c=s.below,u=s.current;if(e.clearColor(0,0,0,0),i!==null){e.bindFramebuffer(e.FRAMEBUFFER,r.textureAbove.framebuffer),e.clear(e.COLOR_BUFFER_BIT);for(let h=0;h<i.length;h++){const f=i[h];let d=a.get(f.id);d==null&&(d=ke(e,t,l,n),a.set(f.id,d)),o.render(e,{blocks:[{x0:0,y0:0,x1:n.x,y1:n.y}],framebuffer:r.textureAbove.framebuffer,uniforms:{u_opacity:f.opacity,u_resolution:n,u_texture:nn(e,l,d)}})}}if(c!==null){e.bindFramebuffer(e.FRAMEBUFFER,r.textureBelow.framebuffer),e.clear(e.COLOR_BUFFER_BIT);for(let h=0;h<c.length;h++){const f=c[h];let d=a.get(f.id);d==null&&(d=ke(e,t,l,n),a.set(f.id,d)),o.render(e,{blocks:[{x0:0,y0:0,x1:n.x,y1:n.y}],framebuffer:r.textureBelow.framebuffer,uniforms:{u_opacity:f.opacity,u_resolution:n,u_texture:nn(e,l,d)}})}}if(u!==null){let h=a.get(u.id);h==null&&(h=ke(e,t,l,n),a.set(u.id,h)),e.bindFramebuffer(e.FRAMEBUFFER,r.textureCurrent.framebuffer),e.clear(e.COLOR_BUFFER_BIT),o.render(e,{blocks:[{x0:0,y0:0,x1:n.x,y1:n.y}],framebuffer:r.textureCurrent.framebuffer,uniforms:{u_opacity:u.opacity,u_resolution:n,u_texture:nn(e,l,h)}})}}function nn(r,e,{texture:t,id:n}){for(let s=0;s<e.length;s++)if(e[s][0]===n)return r.activeTexture(r.TEXTURE0+s),s;for(let s=0;s<e.length;s++)if(e[s][0]===null)return r.activeTexture(r.TEXTURE0+s),r.bindTexture(r.TEXTURE_2D,t),e[s]=[n,performance.now()],s;{let s=Number.MAX_VALUE,o=0;for(let l=0;l<e.length;l++){const a=e[l][1];a<s&&(s=a,o=l)}return r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,t),e[o]=[n,performance.now()],o}}function Oi(r){const e={antialias:!1,depth:!1,alpha:!1,premultipliedAlpha:!1,stencil:!1,preserveDrawingBuffer:!0,desynchronized:!0},t=r.getContext("webgl",e);if(t===null)return console.error("Failed to initialize WebGL renderer for canvas: ",r),new ge("Failed to initialize WebGL");const n=t.getContextAttributes();n&&n.desynchronized||console.warn("Low latency canvas not supported. Boo!"),t.getExtension("OES_texture_float_linear")===null&&console.warn(`Couldn't enable "OES_texture_float_linear"`),t.getExtension("OES_texture_float")===null&&console.warn(`Couldn't enable "OES_texture_float"`),t.viewport(0,0,r.width,r.height),t.enable(t.BLEND),t.disable(t.DEPTH_TEST);const{sfact:l,dfact:a}=Ge(t);t.blendFunc(l,a);const i=Nn.create(t);if(i===null){const p="Failed to initialize BrushShader";return console.error(p),new ge(p)}const c=In.create(t);if(c===null){const p="Failed to initialize BrushTextureGenerator";return console.error(p),new ge(p)}const u=Bn.create(t);if(u===null){const p="Failed to initialize TextureShader";return console.error(p),new ge(p)}const h=Dn.create(t);if(h===null){const p="Failed to initialize ClearBlocksShader";return console.error(p),new ge(p)}const f=Cn.create(t);if(f===null){const p="Failed to initialize OutputShader";return console.error(p),new ge(p)}const d=xt.create(t);if(d===null){const p="Failed to initialize BlockHighlightShader";return console.error(p),new ge(p)}t.viewport(0,0,r.width,r.height);const m=new zi({gl:t,brushTextureGenerator:c,drawpointBatch:i,outputRenderer:f,textureRenderer:u,clearBlocksRenderer:h,blockHighlightShader:d,resolution:new oe(r.width,r.height)});return new Bt([m,t])}class zi{constructor(e){g(this,"gl");g(this,"brushTextureGenerator");g(this,"textureRenderer");g(this,"clearBlocksRenderer");g(this,"blockHighlightShader");g(this,"outputRenderer");g(this,"drawpointBatch");g(this,"allTextures");g(this,"textureBindings");g(this,"layerTextureMap");g(this,"internalCanvasSize");g(this,"stroke");g(this,"renderBlockSystem");g(this,"prevLayers");g(this,"brushTexture");g(this,"outputTexture");g(this,"combinedLayers");this.gl=e.gl,this.brushTextureGenerator=e.brushTextureGenerator,this.textureRenderer=e.textureRenderer,this.clearBlocksRenderer=e.clearBlocksRenderer,this.blockHighlightShader=e.blockHighlightShader,this.outputRenderer=e.outputRenderer,this.drawpointBatch=e.drawpointBatch,this.allTextures=[],this.textureBindings=new Array(32).fill([null,0]),this.layerTextureMap=new Map,this.internalCanvasSize=e.resolution,this.stroke=null,this.renderBlockSystem=new Bi(500),this.prevLayers={above:[],below:[],current:null};{const n=new oe(128,128);this.brushTexture=ke(this.gl,this.allTextures,this.textureBindings,n),this.brushTextureGenerator.generateBrushTexture(this.gl,{framebuffer:this.brushTexture.framebuffer,size:n,uniforms:{u_softness:0}})}this.outputTexture=ke(this.gl,this.allTextures,this.textureBindings,e.resolution);const t=this.outputTexture.framebuffer;this.combinedLayers={above:ke(this.gl,this.allTextures,this.textureBindings,e.resolution),below:ke(this.gl,this.allTextures,this.textureBindings,e.resolution),current:ke(this.gl,this.allTextures,this.textureBindings,e.resolution)},this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t),this.gl.viewport(0,0,e.resolution.x,e.resolution.y),this.gl.clearColor(.6,.6,.6,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.outputRenderer.render(this.gl,{uniforms:{u_resolution:e.resolution,u_texture:xe(this.gl,this.textureBindings,this.outputTexture)},blocks:[{x0:0,y0:0,x1:e.resolution.x,y1:e.resolution.y}]})}addBrushPoints(e){this.drawpointBatch.addPoints(e),this.renderBlockSystem.addBrushPoints(e)}endStroke(){const{gl:e,stroke:t,prevLayers:n,internalCanvasSize:s,textureRenderer:o,combinedLayers:l,renderBlockSystem:a,textureBindings:i}=this;t===null||n.current===null||(e.viewport(0,0,s.x,s.y),o.render(e,{framebuffer:l.current.framebuffer,uniforms:{u_opacity:1,u_resolution:s,u_texture:xe(e,i,t)},blocks:a.getStrokeBlocks()}),e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),a.strokeEnded())}render(e){const{blendMode:t,nextLayers:n,resolution:s,brush:o}=e,{gl:l,renderBlockSystem:a,drawpointBatch:i,layerTextureMap:c,allTextures:u,textureBindings:h,internalCanvasSize:f,brushTexture:d,brushTextureGenerator:m,prevLayers:p,combinedLayers:v,outputTexture:b}=this,A=new Ni(p,n);A.anyChange&&a.fillAll(e.currentTime,s),a.update(e.currentTime);const E=a.getFrameBlocks();if(E.length===0)return;if(i.canFlush)if(n.current===null)console.warn("Drawpoint batch has data to flush, but no layer is currently selected");else{let C=c.get(n.current.id);C==null&&(C=ke(l,u,h,f),c.set(n.current.id,C)),m.generateBrushTexture(l,{framebuffer:d.framebuffer,size:new oe(128,128),uniforms:{u_softness:Math.max(o.softness,1e-6)}}),l.viewport(0,0,s.x,s.y),l.bindFramebuffer(l.FRAMEBUFFER,C.framebuffer),i.flush(l,{blendMode:t,uniforms:{u_resolution:s,u_texture:xe(l,h,d)}})}Hi({gl:l,resolution:s,allTextures:u,layerTextureMap:c,textureBindings:h,textureShader:this.textureRenderer,layersToRender:A,textureAbove:v.above,textureBelow:v.below,textureCurrent:v.current});const x=b.framebuffer;if(l.bindFramebuffer(l.FRAMEBUFFER,x),this.clearBlocksRenderer.render(l,{framebuffer:x,uniforms:{u_resolution:s,u_rgba:at.fromRgba(new Yn(.6,.6,.6),1)},blocks:E}),this.textureRenderer.render(l,{framebuffer:x,uniforms:{u_opacity:1,u_resolution:s,u_texture:xe(l,h,v.below)},blocks:E}),n.current!==null&&this.textureRenderer.render(l,{framebuffer:x,uniforms:{u_opacity:n.current.opacity,u_resolution:s,u_texture:xe(l,h,v.current)},blocks:E}),this.textureRenderer.render(l,{framebuffer:x,uniforms:{u_opacity:1,u_resolution:s,u_texture:xe(l,h,v.above)},blocks:E}),e.highlightRenderBlocks){const C=a.getHighlights();this.blockHighlightShader.render(l,{framebuffer:x,uniforms:{u_resolution:s,u_rgba:at.fromRgba(new Yn(0,0,1),1)},blockHighlights:C})}this.outputRenderer.render(l,{uniforms:{u_resolution:s,u_texture:xe(l,h,b)},blocks:E}),l.flush(),this.prevLayers=n}dispose(){const{gl:e}=this;this.brushTextureGenerator.dispose(e),this.textureRenderer.dispose(e),this.outputRenderer.dispose(e),this.drawpointBatch.dispose(e);for(const t of this.allTextures)e.deleteTexture(t.texture),t instanceof us&&e.deleteFramebuffer(t.framebuffer)}}const Ne=D("NoOp");class fs{constructor(e){g(this,"sendMessage");g(this,"tool");g(this,"layer");g(this,"onFrame",e=>this.sendMessage(D("OnFrame",e)));g(this,"onClick",e=>this.sendMessage(D("OnClick",e)));g(this,"onRelease",e=>this.sendMessage(D("OnRelease",e)));g(this,"onDrag",e=>{if(e.length===0){const t="Expected inputs be be 1 or greater";throw console.error(t,e),{[t]:e}}this.sendMessage(D("OnDrag",e))});g(this,"onKeyboard",e=>this.sendMessage(D("OnKeyboard",e)));g(this,"randomizeTheme",()=>this.sendMessage(D("RandomizeTheme")));g(this,"toggleHighlightRenderBlocks",()=>this.sendMessage(D("ToggleHighlightRenderBlocks")));g(this,"toggleDisplayStats",()=>this.sendMessage(D("ToggleDisplayStats")));this.sendMessage=e,this.tool=new Ya(t=>e(D("ToolMsg",t))),this.layer=new Ia(t=>e(D("LayersMsg",t)))}}function hs(){const[r,e]=cs(Dt.create(145264772)),t=Ut.createKey,n={theme:r,tool:Ga,layers:Ce.init(),highlightRenderBlocks:!1,displayStats:!1,keyboard:{layers:Te().cons({[t({code:"KeyB"})]:{msg:D("ToolMsg",D("SetToolMsg","Brush")),passive:!1},[t({code:"KeyE"})]:{msg:D("ToolMsg",D("SetToolMsg","Eraser")),passive:!1},[t({code:"KeyZ"})]:{msg:D("ToolMsg",D("SetToolMsg","Zoom")),passive:!1},[t({code:"KeyM"})]:{msg:D("ToolMsg",D("SetToolMsg","Move")),passive:!1},[t({code:"KeyR"})]:{msg:D("ToolMsg",D("SetToolMsg","Rotate")),passive:!1},[t({code:"KeyP"})]:{msg:D("ToggleHighlightRenderBlocks"),passive:!1}})}},s={themeRng:e,tool:Qa(),hasPressedDown:!1};return[n,s]}function vn(r,e,t){const n=new oe(t.x,t.y).subtract(r.offset).subtractScalars(e.offsetX,e.offsetY).subtract(r.halfResoution).multiplyScalar(1/e.zoomPct),{x:s,y:o}=co(-e.rotateTurns,oe.zeroes,n).add(r.halfResoution);return{x:s,y:o,pressure:t.pressure,time:t.time,originalX:t.x,originalY:t.y}}function Ui(r,e,t){const n=new Array(t.length);for(let s=0;s<t.length;s++)n[s]=vn(r,e,t[s]);return n}function ds(r,e,t,n){switch(n.tag){case"OnFrame":{const[s,o]=Za(e.tool,t.tool,n.val),l=D("RenderFrame",{brushPoints:o,config:e});return[e,{...t,tool:s},l]}case"OnClick":{const[s,o,l]=Wa(e.tool,t.tool,vn(r,e.tool.camera,n.val)),a={...e,tool:s},i={...t,hasPressedDown:!0,tool:o},c=D("AddBrushPoints",l);return[a,i,c]}case"OnRelease":{const[s,o,l]=ja(e.tool,t.tool,vn(r,e.tool.camera,n.val)),a={...e,tool:s},i={...t,hasPressedDown:!1,tool:o},c=D("EndStroke",l);return[a,i,c]}case"OnDrag":{if(!t.hasPressedDown)return[e,t,Ne];const[s,o,l]=Ka(e.tool,t.tool,Ui(r,e.tool.camera,n.val)),a={...e,tool:s},i={...t,tool:o},c=D("AddBrushPoints",l);return[a,i,c]}case"OnKeyboard":{const s=ti(e.keyboard,n.val),o=[];let l=Ne,a=e,i=t;for(let c=0;c<s.length;c++)[a,i,l]=ds(r,a,i,s[c]),l.tag!=="NoOp"&&o.push(l);return o.length>0&&(l=D("Batch",o)),[a,i,l]}case"RandomizeTheme":{const[s,o]=cs(t.themeRng),l={...e,theme:s},a={...t,themeRng:o};return[l,a,Ne]}case"ToggleHighlightRenderBlocks":return[{...e,highlightRenderBlocks:!e.highlightRenderBlocks},t,Ne];case"ToggleDisplayStats":return[{...e,displayStats:!e.displayStats},t,Ne];case"ToolMsg":return[{...e,tool:qa(e.tool,n.val)},t,Ne];case"LayersMsg":return[{...e,layers:e.layers.update(n.val)},t,Ne];default:throw{"unexpected msg":n}}}class Hn{constructor(e,t,n){g(this,"resolution");g(this,"hooks");g(this,"context");g(this,"perfTracker");this.resolution=e,this.hooks=t,this.context=n,this.perfTracker=new so({maxSamples:50,onSamples:this.hooks.onStats})}static create(e,t){const n=Oi(e);return n.isOk()?(t.onWebglContextCreated(n.value[1]),new Hn(new oe(e.width,e.height),t,n.value[0])):(console.error("Error in Context setup:",n.value),null)}handle(e){switch(e.tag){case"NoOp":return;case"Batch":{const t=e.val;for(let n=0;n<t.length;n++)this.handle(t[n]);return}case"RenderFrame":{const{brushPoints:t,config:n}=e.val;this.perfTracker.start(),this.context.addBrushPoints(t),this.context.render({blendMode:Ja(n.tool),nextLayers:n.layers.split(),resolution:this.resolution,brush:{softness:ei(n.tool)},currentTime:performance.now(),highlightRenderBlocks:n.highlightRenderBlocks}),this.perfTracker.end();return}case"AddBrushPoints":{this.context.addBrushPoints(e.val);return}case"EndStroke":{this.context.addBrushPoints(e.val),this.context.endStroke();return}default:throw{"unexpected effect":e}}}dispose(){this.context.dispose()}}function Vi(r){return window.PointerEvent!==void 0?qi(r):Wi(r)}const $n={};function br(r){r.pressure===0||r.pressure===.5||$n[r.pointerId]||($n[r.pointerId]=!0)}function Xi(r){return $n[r.pointerId]?r.pressure:r.pressure===.5?1:r.pressure}const Yi=()=>PointerEvent.prototype.getCoalescedEvents===void 0?r=>[r]:r=>r.getCoalescedEvents();function bn(r,e,t){return{x:e.x,y:e.y,pressure:Xi(t),shift:e.shiftKey,alt:e.altKey,ctrl:e.ctrlKey,time:r}}function Gi(r,e){const t=Yi()(e),n=new Array(t.length);for(let s=0;s<t.length;s++)n[s]=bn(r,t[s],e);return n}function nt(r,e){return{subscribe(t){return r.addEventListener(e,t,{passive:!0}),()=>{r.removeEventListener(e,t)}}}}function rt(r,e){return{subscribe(t){return r.subscribe(n=>t(e(n)))}}}function ms(r,e){return{subscribe(t){let n;const s=r.subscribe(o=>{n==null||n(),n=e(o).subscribe(t)});return()=>{n==null||n(),s()}}}}function ps(r,e){return{subscribe(t){const n=()=>{s(),o()},s=r.subscribe(t),o=e.subscribe(n);return n}}}function qi(r){const e=rt(nt(r,"pointerdown"),o=>(br(o),bn(performance.now(),o,o))),t=rt(nt(document.body,"pointermove"),o=>(br(o),Gi(performance.now(),o))),n=rt(nt(document.body,"pointerup"),o=>bn(performance.now(),o,o)),s=ms(e,o=>ps(t,n));return{click:e,move:t,drag:s,release:n}}function Wi(r){const e=rt(nt(r,"mousedown"),o=>rn(performance.now(),o,!1)),t=rt(nt(document.body,"mousemove"),o=>[rn(performance.now(),o,!1)]),n=rt(nt(document.body,"mouseup"),o=>rn(performance.now(),o,!0)),s=ms(e,o=>ps(t,n));return{click:e,move:t,drag:s,release:n}}function rn(r,e,t){return{x:e.x,y:e.y,pressure:t?0:1,shift:e.shiftKey,alt:e.altKey,ctrl:e.ctrlKey,time:r}}const yn=new oe(800,800),[ze,gs]=hs(),wn=({canvasOffset:r,canvasResolution:e})=>({resolution:e,halfResoution:e.multiplyScalar(.5),offset:r}),Ki=wn({canvasOffset:new oe(ze.tool.camera.offsetX,ze.tool.camera.offsetY),canvasResolution:yn}),ji=new fs(r=>{}),Zi=ct(),_s=ct(ze),vs=ct(ji),$s=ct(Ki),bs=ct(gs),Qi=_s,Ji=vs,ec=$s,tc=bs,nc=({getCanvas:r,getContainer:e})=>{let t=wn({canvasOffset:new oe(ze.tool.camera.offsetX,ze.tool.camera.offsetY),canvasResolution:yn});Me(()=>{const n=r(),s=e();if(!s)throw new Error("Container not found");if(!n)throw new Error("Canvas not found");const o=Hn.create(n,{onStats:h=>{rs.update(f=>f.update(h))},onWebglContextCreated:h=>{console.log("debuggingGl set"),Zi.set(h)}});if(o===null)throw new Error("Failed to initialize Canvas");const l=sc(s);l(ze.theme);const a=no({initialState:ze,initialEphemeral:gs,effectsHandler:h=>o.handle(h),forceRender:(h,f)=>{_s.set(h),bs.set(f),l(h.theme)},update:(h,f,d)=>{const m=ds(t,h,f,d);return d.tag!=="OnFrame"&&console.log(`UPD [${d.tag}]`,m),m}}),i=new fs(a.send);vs.set(i),console.log("Painter mounted");const c=[],u=Vi(n);return c.push(u.click.subscribe(i.onClick)),c.push(u.release.subscribe(i.onRelease)),c.push(u.move.subscribe(()=>{})),c.push(u.drag.subscribe(i.onDrag)),c.push(ni({handle:i.onKeyboard})),c.push(ro.make(i.onFrame)),c.push(()=>o.dispose()),()=>{for(const h of c)typeof h!="function"?h.unsubscribe():h();console.log("Painter unmounted")}}),oc(()=>{const n=r();!n||(t=wn({canvasOffset:rc(n),canvasResolution:yn}),$s.set(t))})},rc=r=>new oe(r.offsetLeft,r.offsetTop),sc=r=>{let e=null;return t=>{e===null?ci(r,t):ii(r,e,t),e=t}},oc=r=>{Tr(()=>{r()}),Me(()=>(window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}))};function lc(r){let e;return{c(){e=X("Debug")},l(t){e=Y(t,"Debug")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function yr(r){let e,t,n;return t=new mt({props:{$$slots:{default:[ic]},$$scope:{ctx:r}}}),{c(){e=P("div"),S(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var o=L(e);k(t.$$.fragment,o),o.forEach(_),this.h()},h(){R(e,"class","backdrop svelte-1sceo41")},m(s,o){H(s,e,o),T(t,e,null),n=!0},p(s,o){const l={};o&139&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){n||($(t.$$.fragment,s),n=!0)},o(s){w(t.$$.fragment,s),n=!1},d(s){s&&_(e),F(t)}}}function ac(r){let e;return{c(){e=X("Close")},l(t){e=Y(t,"Close")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function ic(r){let e,t,n,s,o,l,a,i,c,u,h,f=r[3].display()+"",d,m,p,v,b,A,E,x,C,z,N;return E=new Fa({props:{config:r[0],sender:r[1]}}),z=new wt({props:{$$slots:{default:[ac]},$$scope:{ctx:r}}}),z.$on("click",r[4]),{c(){e=P("div"),t=P("div"),n=P("h2"),s=X("Debug info"),o=I(),l=P("div"),a=P("div"),i=P("h3"),c=X("RNG"),u=I(),h=P("div"),d=X(f),m=I(),p=P("div"),v=P("h3"),b=X("Options"),A=I(),S(E.$$.fragment),x=I(),C=P("div"),S(z.$$.fragment),this.h()},l(U){e=M(U,"DIV",{class:!0});var K=L(e);t=M(K,"DIV",{class:!0});var re=L(t);n=M(re,"H2",{});var fe=L(n);s=Y(fe,"Debug info"),fe.forEach(_),re.forEach(_),o=B(K),l=M(K,"DIV",{class:!0});var se=L(l);a=M(se,"DIV",{});var ce=L(a);i=M(ce,"H3",{});var pt=L(i);c=Y(pt,"RNG"),pt.forEach(_),u=B(ce),h=M(ce,"DIV",{class:!0});var me=L(h);d=Y(me,f),me.forEach(_),ce.forEach(_),m=B(se),p=M(se,"DIV",{class:!0});var De=L(p);v=M(De,"H3",{});var V=L(v);b=Y(V,"Options"),V.forEach(_),A=B(De),k(E.$$.fragment,De),De.forEach(_),se.forEach(_),x=B(K),C=M(K,"DIV",{class:!0});var O=L(C);k(z.$$.fragment,O),O.forEach(_),K.forEach(_),this.h()},h(){R(t,"class","header"),R(h,"class","monospaced svelte-1sceo41"),R(p,"class","options svelte-1sceo41"),R(l,"class","body svelte-1sceo41"),R(C,"class","footer svelte-1sceo41"),R(e,"class","container svelte-1sceo41")},m(U,K){H(U,e,K),y(e,t),y(t,n),y(n,s),y(e,o),y(e,l),y(l,a),y(a,i),y(i,c),y(a,u),y(a,h),y(h,d),y(l,m),y(l,p),y(p,v),y(v,b),y(p,A),T(E,p,null),y(e,x),y(e,C),T(z,C,null),N=!0},p(U,K){(!N||K&8)&&f!==(f=U[3].display()+"")&&ie(d,f);const re={};K&1&&(re.config=U[0]),K&2&&(re.sender=U[1]),E.$set(re);const fe={};K&128&&(fe.$$scope={dirty:K,ctx:U}),z.$set(fe)},i(U){N||($(E.$$.fragment,U),$(z.$$.fragment,U),N=!0)},o(U){w(E.$$.fragment,U),w(z.$$.fragment,U),N=!1},d(U){U&&_(e),F(E),F(z)}}}function cc(r){let e,t,n,s;e=new wt({props:{$$slots:{default:[lc]},$$scope:{ctx:r}}}),e.$on("click",r[5]);let o=r[2]&&yr(r);return{c(){S(e.$$.fragment),t=I(),o&&o.c(),n=lt()},l(l){k(e.$$.fragment,l),t=B(l),o&&o.l(l),n=lt()},m(l,a){T(e,l,a),H(l,t,a),o&&o.m(l,a),H(l,n,a),s=!0},p(l,[a]){const i={};a&128&&(i.$$scope={dirty:a,ctx:l}),e.$set(i),l[2]?o?(o.p(l,a),a&4&&$(o,1)):(o=yr(l),o.c(),$(o,1),o.m(n.parentNode,n)):o&&($e(),w(o,1,1,()=>{o=null}),be())},i(l){s||($(e.$$.fragment,l),$(o),s=!0)},o(l){w(e.$$.fragment,l),w(o),s=!1},d(l){F(e,l),l&&_(t),o&&o.d(l),l&&_(n)}}}function uc(r,e,t){let n,s;Pt(r,tc,u=>t(6,s=u));let{config:o}=e,{sender:l}=e,a=!1;function i(){t(2,a=!1)}function c(){t(2,a=!a)}return r.$$set=u=>{"config"in u&&t(0,o=u.config),"sender"in u&&t(1,l=u.sender)},r.$$.update=()=>{r.$$.dirty&64&&t(3,n=s==null?void 0:s.themeRng)},[o,l,a,n,i,c,s]}class fc extends G{constructor(e){super(),q(this,e,uc,cc,W,{config:0,sender:1})}}const hc=()=>{Me(()=>{const r=e=>{e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}})},wr=r=>{const e="translate("+r.offsetX+"px, "+r.offsetY+"px) ",t="rotate("+r.rotateTurns+"turn) ",n="scale("+r.zoomPct+", "+r.zoomPct+")";return e+t+n};function Rr(r){let e,t;return e=new Ql({props:{sender:r[2].tool,tool:r[3].tool,transientState:{isDetailsExpanded:!0}}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&4&&(o.sender=n[2].tool),s&8&&(o.tool=n[3].tool),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Er(r){let e,t,n,s,o;return t=new mt({props:{$$slots:{default:[dc]},$$scope:{ctx:r}}}),s=new da({props:{layers:r[3].layers,sender:r[2].layer}}),{c(){e=P("div"),S(t.$$.fragment),n=I(),S(s.$$.fragment),this.h()},l(l){e=M(l,"DIV",{class:!0});var a=L(e);k(t.$$.fragment,a),n=B(a),k(s.$$.fragment,a),a.forEach(_),this.h()},h(){R(e,"class","layers-view-container svelte-1hhpzge")},m(l,a){H(l,e,a),T(t,e,null),y(e,n),T(s,e,null),o=!0},p(l,a){const i={};a&1036&&(i.$$scope={dirty:a,ctx:l}),t.$set(i);const c={};a&8&&(c.layers=l[3].layers),a&4&&(c.sender=l[2].layer),s.$set(c)},i(l){o||($(t.$$.fragment,l),$(s.$$.fragment,l),o=!0)},o(l){w(t.$$.fragment,l),w(s.$$.fragment,l),o=!1},d(l){l&&_(e),F(t),F(s)}}}function dc(r){let e,t;return e=new ba({props:{camera:r[3].tool.camera,sender:r[2].tool.camera}}),{c(){S(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,s){T(e,n,s),t=!0},p(n,s){const o={};s&8&&(o.camera=n[3].tool.camera),s&4&&(o.sender=n[2].tool.camera),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Sr(r){let e,t,n,s,o,l,a,i=r[3].displayStats&&kr();return s=new Ar({props:{$$slots:{default:[mc]},$$scope:{ctx:r}}}),s.$on("click",function(){Ht(r[2].randomizeTheme)&&r[2].randomizeTheme.apply(this,arguments)}),l=new fc({props:{sender:r[2],config:r[3]}}),{c(){e=P("div"),i&&i.c(),t=I(),n=P("div"),S(s.$$.fragment),o=I(),S(l.$$.fragment),this.h()},l(c){e=M(c,"DIV",{class:!0});var u=L(e);i&&i.l(u),t=B(u),n=M(u,"DIV",{class:!0});var h=L(n);k(s.$$.fragment,h),o=B(h),k(l.$$.fragment,h),h.forEach(_),u.forEach(_),this.h()},h(){R(n,"class","utility-buttons svelte-1hhpzge"),R(e,"class","bottom-left svelte-1hhpzge")},m(c,u){H(c,e,u),i&&i.m(e,null),y(e,t),y(e,n),T(s,n,null),y(n,o),T(l,n,null),a=!0},p(c,u){r=c,r[3].displayStats?i?u&8&&$(i,1):(i=kr(),i.c(),$(i,1),i.m(e,t)):i&&($e(),w(i,1,1,()=>{i=null}),be());const h={};u&1024&&(h.$$scope={dirty:u,ctx:r}),s.$set(h);const f={};u&4&&(f.sender=r[2]),u&8&&(f.config=r[3]),l.$set(f)},i(c){a||($(i),$(s.$$.fragment,c),$(l.$$.fragment,c),a=!0)},o(c){w(i),w(s.$$.fragment,c),w(l.$$.fragment,c),a=!1},d(c){c&&_(e),i&&i.d(),F(s),F(l)}}}function kr(r){let e,t,n;return t=new Ra({}),{c(){e=P("div"),S(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var o=L(e);k(t.$$.fragment,o),o.forEach(_),this.h()},h(){R(e,"class","render-stats svelte-1hhpzge")},m(s,o){H(s,e,o),T(t,e,null),n=!0},i(s){n||($(t.$$.fragment,s),n=!0)},o(s){w(t.$$.fragment,s),n=!1},d(s){s&&_(e),F(t)}}}function mc(r){let e;return{c(){e=X("Next theme")},l(t){e=Y(t,"Next theme")},m(t,n){H(t,e,n)},d(t){t&&_(e)}}}function pc(r){let e,t,n,s,o,l,a,i,c,u,h=r[2]&&r[3]&&Rr(r),f=r[2]&&r[3]&&Er(r),d=r[2]&&r[3]&&Sr(r);return{c(){e=P("div"),t=P("div"),h&&h.c(),n=I(),s=P("canvas"),i=I(),f&&f.c(),c=I(),d&&d.c(),this.h()},l(m){e=M(m,"DIV",{class:!0,style:!0});var p=L(e);t=M(p,"DIV",{class:!0});var v=L(t);h&&h.l(v),n=B(v),s=M(v,"CANVAS",{class:!0,width:!0,height:!0,style:!0}),L(s).forEach(_),i=B(v),f&&f.l(v),v.forEach(_),c=B(p),d&&d.l(p),p.forEach(_),this.h()},h(){var m,p;R(s,"class","canvas svelte-1hhpzge"),R(s,"width",o=(m=r[4].resolution.x)!=null?m:800),R(s,"height",l=(p=r[4].resolution.y)!=null?p:800),R(s,"style",a=r[3]?`transform: ${wr(r[3].tool.camera)}`:void 0),R(t,"class","wrapper svelte-1hhpzge"),R(e,"class","app-container svelte-1hhpzge"),R(e,"style",ui(r[5]))},m(m,p){H(m,e,p),y(e,t),h&&h.m(t,null),y(t,n),y(t,s),r[8](s),y(t,i),f&&f.m(t,null),y(e,c),d&&d.m(e,null),r[9](e),u=!0},p(m,[p]){var v,b;m[2]&&m[3]?h?(h.p(m,p),p&12&&$(h,1)):(h=Rr(m),h.c(),$(h,1),h.m(t,n)):h&&($e(),w(h,1,1,()=>{h=null}),be()),(!u||p&16&&o!==(o=(v=m[4].resolution.x)!=null?v:800))&&R(s,"width",o),(!u||p&16&&l!==(l=(b=m[4].resolution.y)!=null?b:800))&&R(s,"height",l),(!u||p&8&&a!==(a=m[3]?`transform: ${wr(m[3].tool.camera)}`:void 0))&&R(s,"style",a),m[2]&&m[3]?f?(f.p(m,p),p&12&&$(f,1)):(f=Er(m),f.c(),$(f,1),f.m(t,null)):f&&($e(),w(f,1,1,()=>{f=null}),be()),m[2]&&m[3]?d?(d.p(m,p),p&12&&$(d,1)):(d=Sr(m),d.c(),$(d,1),d.m(e,null)):d&&($e(),w(d,1,1,()=>{d=null}),be())},i(m){u||($(h),$(f),$(d),u=!0)},o(m){w(h),w(f),w(d),u=!1},d(m){m&&_(e),h&&h.d(),r[8](null),f&&f.d(),d&&d.d(),r[9](null)}}}function gc(r,e,t){let n,s,o,l,a;Pt(r,Ji,d=>t(6,o=d)),Pt(r,Qi,d=>t(7,l=d)),Pt(r,ec,d=>t(4,a=d));let i,c;nc({getCanvas(){return c},getContainer(){return i}}),hc();const[{theme:u}]=hs();function h(d){Ie[d?"unshift":"push"](()=>{c=d,t(1,c)})}function f(d){Ie[d?"unshift":"push"](()=>{i=d,t(0,i)})}return r.$$.update=()=>{r.$$.dirty&128&&t(3,n=l),r.$$.dirty&64&&t(2,s=o)},[i,c,s,n,a,u,o,l,h,f]}class _c extends G{constructor(e){super(),q(this,e,gc,pc,W,{})}}function vc(r){let e,t,n,s;return n=new _c({}),{c(){e=I(),t=P("main"),S(n.$$.fragment),this.h()},l(o){Rs("svelte-w8bttj",document.head).forEach(_),e=B(o),t=M(o,"MAIN",{style:!0});var a=L(t);k(n.$$.fragment,a),a.forEach(_),this.h()},h(){document.title="Paint tool v2",ve(t,"background-color","var(--color-background, #555)")},m(o,l){H(o,e,l),H(o,t,l),T(n,t,null),s=!0},p:Z,i(o){s||($(n.$$.fragment,o),s=!0)},o(o){w(n.$$.fragment,o),s=!1},d(o){o&&_(e),o&&_(t),F(n)}}}class wc extends G{constructor(e){super(),q(this,e,null,vc,W,{})}}export{wc as default};
