{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/ivi/dist/module/vdom/factories.js","webpack:///./node_modules/ivi-html/dist/module/index.js","webpack:///./src/util/store.ts","webpack:///./src/util/decode.ts","webpack:///./src/util/maybe.ts","webpack:///./src/util/result.ts","webpack:///./src/util/vec2.ts","webpack:///./src/util/vec3.ts","webpack:///./src/util/vec4.ts","webpack:///./src/util/frameStream.ts","webpack:///./src/util/perfTracker.ts","webpack:///./src/util/index.ts","webpack:///./src/webgl/index.ts","webpack:///./src/webgl/glsl.ts","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/@babel/runtime/helpers/objectSpread.js","webpack:///./node_modules/color/dist/index.js","webpack:///./node_modules/ivi/dist/module/core/shortcuts.js","webpack:///./node_modules/ivi/dist/module/dom/shortcuts.js","webpack:///./src/views/labeled.ts","webpack:///./src/views/slider.ts","webpack:///./src/tools/camera.ts","webpack:///./src/tools/index.ts","webpack:///./node_modules/ivi/dist/module/vdom/operations.js","webpack:///./node_modules/ivi/dist/module/core/error.js","webpack:///./node_modules/ivi/dist/module/core/array.js","webpack:///./node_modules/ivi/dist/module/core/repeatable_task_list.js","webpack:///./node_modules/ivi/dist/module/scheduler/index.js","webpack:///./node_modules/ivi/dist/module/vdom/context.js","webpack:///./src/views/buttons.ts","webpack:///./src/tools/brushDelay.ts","webpack:///./src/views/surface.ts","webpack:///./src/tools/eraser.ts","webpack:///./src/collections/zipperList.ts","webpack:///./src/views/menu.ts","webpack:///./src/views/colorWheel.ts","webpack:///./src/views/colorDisplay.ts","webpack:///./src/tools/brush.ts","webpack:///./src/rng/generators.ts","webpack:///./src/rng/rng.ts","webpack:///./src/rng/index.ts","webpack:///./src/layers/view.scss?011f","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///./node_modules/ivi/dist/module/vdom/hooks.js","webpack:///./node_modules/ivi/dist/module/core/token.js","webpack:///./src/views/inlineLabeled.ts","webpack:///./src/views/switch.ts","webpack:///./src/tools/interpolation.ts","webpack:///./node_modules/ivi/dist/module/dom/namespaces.js","webpack:///./node_modules/ivi/dist/module/vdom/reconciler.js","webpack:///./src/views/menu.scss?6d66","webpack:///./src/collections/stack.ts","webpack:///./src/views/switch.scss?9850","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/ivi/dist/module/vdom/root.js","webpack:///./src/theme/index.ts","webpack:///./node_modules/ivi/dist/module/ssr/render.js","webpack:///./node_modules/ivi/dist/module/ssr/escape.js","webpack:///./src/views/labeled.scss?3517","webpack:///./src/views/slider.scss?592d","webpack:///./src/layers/model.ts","webpack:///./src/canvas/outputShader.ts","webpack:///./src/canvas/brushTextureGenerator.ts","webpack:///./src/canvas/textureShader.ts","webpack:///./src/canvas/clearBlocksShader.ts","webpack:///./src/canvas/brushShader.ts","webpack:///./src/canvas/blockRender.ts","webpack:///./src/canvas/texture.ts","webpack:///./src/canvas/render.ts","webpack:///./src/canvas/index.ts","webpack:///./src/canvas/context.ts","webpack:///./node_modules/ivi/dist/module/events/native_events.js","webpack:///./node_modules/ivi/dist/module/events/utils.js","webpack:///./node_modules/ivi/dist/module/dom/feature_detection.js","webpack:///./src/views/buttons.scss?13a9","webpack:///./node_modules/ivi/dist/module/core/equal.js","webpack:///./node_modules/ivi/dist/module/vdom/state.js","webpack:///./src/app/index.scss?ce4f","webpack:///./src/views/colorWheel.scss?d59f","webpack:///./src/views/colorDisplay.scss?eb7e","webpack:///./src/views/row.scss?1419","webpack:///./src/debugging/index.scss?8b98","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./src/tools/brush.scss?06f0","webpack:///./src/views/inlineLabeled.scss?1aed","webpack:///./src/views/surface.scss?3456","webpack:///./src/tools/toolbar.scss?8c09","webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///./src/debugging/scripting.scss?1548","webpack:///./node_modules/ivi/dist/module/core/box.js","webpack:///./node_modules/ivi/dist/module/vdom/utils.js","webpack:///./node_modules/ivi/dist/module/vdom/ref.js","webpack:///./node_modules/ivi/dist/module/vdom/attribute_directive.js","webpack:///./src/tools/toolbar.ts","webpack:///./node_modules/ivi/dist/module/events/dispatch.js","webpack:///./src/tools/eraser.scss?feec","webpack:///./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/inherits.js","webpack:///./src/input/index.ts","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:///./src/debugging/scripting.ts","webpack:///./src/signals/index.ts","webpack:///./src/views/row.ts","webpack:///./src/layers/view.ts","webpack:///./src/app/index.ts","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./node_modules/regenerator-runtime/runtime-module.js","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./src/debugging/performance.ts","webpack:///./src/debugging/index.ts","webpack:///./node_modules/ivi/dist/module/core/noop.js","webpack:///./node_modules/ivi/dist/module/core/memo.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","instance","Constructor","TypeError","__webpack_exports__","elementFactory","htmlElementFactory","component","_operations__WEBPACK_IMPORTED_MODULE_0__","tag","flags","v","e","type","props","process","VALUE","CONTENT","button","canvas","div","li","span","ul","textarea","input","ivi__WEBPACK_IMPORTED_MODULE_0__","ivi__WEBPACK_IMPORTED_MODULE_1__","ivi__WEBPACK_IMPORTED_MODULE_2__","ivi__WEBPACK_IMPORTED_MODULE_3__","VALUE_EMPTY","u","updateValue","renderToStringValue","renderToStringContent","element","prev","next","env","IVI_TARGET","Store","args","effectsHandler","initialState","initialEphemeral","forceRender","update","state","ephemeral","send","msg","_update","_update2","slicedToArray_default","nextState","nextEphemeral","effect","getState","Decode","Maybe","Result","ok","isOk","err","bool","val","int","Number","isInteger","number","string","nullable","decoder","nullable_","maybe","undefined","maybe_","array","decode","typeof_default","Array","isArray","arr","length","res","push","array_","decoders","resObj","propName","prop","object_","dictionary","val_","keys","dictionary_","tuple2","decoder1","decoder2","first","second","tuple2_","tuple3","decoder3","third","tuple3_","oneOf","oneOf_","map","transform","map_","filter","predicate","filter_","extend","baseRes","extend_","lazy","lazyDecoder","createJsonDecoder","json","JSON","parse","ex","decodeJson","decodeValue","of","withDefault","def","withDefaultf","f","map2","val1","val2","map3","val3","andThen","isErr","mapErr","Vec2","x","y","classCallCheck_default","this","createClass_default","other","eq","lerp","pct","begin","end","distance","Math","sqrt","Vec3","z","Vec4","w","fromRgba","rgb","alpha","g","b","FrameStream","make","fn","shouldStop","window","requestId","requestAnimationFrame","callback","performance","now","cancelAnimationFrame","PerfTracker","maxSamples","onSamples","samples","nextIdx","startTimeMs","endMs","startMs","ColorMode","Lazy","__fn","__value","SetOnce","orDefault","x0","y0","x1","y1","start","clamp","min","max","delay","ms","Promise","setTimeout","arrUpdate","index","newArr","slice","splice","arrInsert","arrRemove","colorModeToString","Hsv","Hsluv","UniformType","createProgram","gl","vSrc","fSrc","vShader","compileShader","WebGLRenderingContext","VERTEX_SHADER","fShader","FRAGMENT_SHADER","program","attachShader","linkedProgram","linkProgram","getProgramParameter","LINK_STATUS","deleteProgram","deleteShader","src","shaderType","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","lines","split","lineNumberLength","toString","line","text","fillChar","padCount","pad","join","padStart","withNumberedLines","AttribType","Uniform","location","getUniformLocation","uniforms","result","notFound","textureLoc","updateUniforms","uniform","I1","arg","uniform1i","F1","uniform1f","F2","uniform2f","F3","uniform3f","F4","uniform4f","unexpected type","Blend","AttribInternal","attrib","size","Float","glType","FLOAT","bytes","Unexpected type on attribute","AttributesInfo","attributes","attributes_","totalSize","stride","bindAttribLocation","sizeOffset","vertexAttribPointer","enableVertexAttribArray","offset","Mode","factorsNormal","sfact","ONE","dfact","ONE_MINUS_SRC_ALPHA","factorsErase","ZERO","getFactors","Normal","Erase","arrayWithHoles","iterableToArrayLimit","nonIterableRest","_defineProperties","target","descriptor","configurable","writable","protoProps","staticProps","arguments","source","ownKeys","getOwnPropertySymbols","concat","sym","getOwnPropertyDescriptor","forEach","Rgb","[object Object]","css","replace","startsWith","vals","parseFloat","validateRgb","parseRgbCss","substr","parseHexCss","floatToByte","RgbLinear","toLinear","mix","White","Black","fromLinear","pow","isNaN","isFinite","parseHex","parseHexPair","hex","toLowerCase","NaN","from","to","h","__cachedRgb","hsvToRgb","toRgb","toStyle","q","Luv","hsluvToRgb","Hpluv","hpluvToRgb","Lch","Xyz","mInv","refY","refU","refV","kappa","epsilon","lengthOfRayUntilIntersect","theta","vec","sin","cos","getBounds","sub1","sub2","bounds","m1","m2","m3","top1","top2","bottom","maxSafeChromaForL","MAX_VALUE","vec1","vec2","maxChromaForLH","hrad","PI","luvToLch","atan2","lchToLuv","mat3map","mat","rgbToXyz","lrgb","xyz","xyzToRgb","fromLinear$1","lchToHsluv","mx","hsluvToLch","lchToHpluv","hpluvToLch","rgbToLch","xyzToLuv","lchToRgb","lch","luvToXyz","hsluv","hpluv","initU","initV","rgbToHsv","maxValue","minValue","luvToRgb","luv","rgbToHsluv","rgbToHpluv","toGray","gray","_","doc","objectHasOwnProperty","nodeInsertBefore","nodeRemoveChild","nodeCloneNode","elementSetAttribute","elementRemoveAttribute","nodeSetTextContent","elementSetClassName","htmlElementGetStyle","svgElementGetStyle","getDescriptor","nodeProto","Node","elementProto","Element","document","insertBefore","removeChild","replaceChild","cloneNode","setAttribute","setAttributeNS","removeAttribute","set","HTMLElement","SVGElement","Labeled","ivi_html__WEBPACK_IMPORTED_MODULE_1__","_labeled_scss__WEBPACK_IMPORTED_MODULE_2__","_ref","label","children","styles","Slider","ivi__WEBPACK_IMPORTED_MODULE_4__","ivi__WEBPACK_IMPORTED_MODULE_5__","ivi__WEBPACK_IMPORTED_MODULE_6__","ivi__WEBPACK_IMPORTED_MODULE_7__","ivi__WEBPACK_IMPORTED_MODULE_8__","ivi_html__WEBPACK_IMPORTED_MODULE_9__","_slider_scss__WEBPACK_IMPORTED_MODULE_10__","noOp","containerRef","box","isDown","handler","signal","ev","findDOMNode","getBoundingClientRect","width","Rem","localX","clientX","left","dotWidth","onDown","invalidate","onUp","onMove","listenToMouse","useEffect","body","addEventListener","passive","removeEventListener","onChange","color","percentage","Events","onMouseDown","Ref","style","background-color","MsgType","SetZoomMsg","zoomPct","SetOffsetMsg","offsetPx","SetRotationMsg","rotationRad","objectSpread_default","unexpected msg","createSender","sendMessage","setRotation","setOffset","xyPx","setZoom","zoomToolUpdate","camera","dragState","xd","prevPoint","rotateToolUpdate","_camera","clickPoint","moveToolUpdate","yd","ToolMsgType","ToolType","SetToolMsg","subType","BrushMsg","EraserMsg","CameraMsg","brush","Brush","eraser","Eraser","Camera","setTool","EphemeralStateType","BrushState","EraserState","MoveState","Move","ZoomState","Zoom","RotateState","Rotate","init","current","initEphemeral","brushToolInit","tool","unexpected tool type: ","syncEphemeral","Unknown tool type: ","onClick","ephemeral_","pointer","_Brush$onClick","_Brush$onClick2","brushPoint","_Eraser$onClick","_Eraser$onClick2","cameraMsg","onDrag","pointers","_Brush$onDrag","_Brush$onDrag2","brushPoints","_Eraser$onDrag","_Eraser$onDrag2","expected state","onRelease","_Brush$onRelease","_Brush$onRelease2","_Eraser$onRelease","_Eraser$onRelease2","onFrame","currentTime","_Brush$onFrame","_Brush$onFrame2","_Eraser$onFrame","_Eraser$onFrame2","getBlendMode","getSoftness","softness","createOpType","createValueOp","createContainerOp","createDOMElementOp","EVENTS","ERROR_HANDLERS","error","unorderedArrayDeleteByIndex","last","pop","runRepeatableTasks","tasks","run","token","withSchedulerTick","clock","scheduleMicrotask","scheduleMutationEffect","scheduleLayoutEffect","render","_flags","_frameStartTime","_clock","_resolvedPromise","resolve","_microtasks","_mutationEffects","_layoutEffects","_beforeMutations","_afterMutations","inner","apply","runMicrotasks","noop","task","then","_handleNextFrame","time","vdom_root","withNextFrame","_handleNextFrameSync","requestNextFrame","requestDirtyCheck","container","root","resetContext","pushContext","getContext","setContext","PrimaryButton","DefaultButton","SinkableButton","ivi_html__WEBPACK_IMPORTED_MODULE_2__","_buttons_scss__WEBPACK_IMPORTED_MODULE_3__","title","content","_ref2","className","onDownClick","updateWithInput","_util__WEBPACK_IMPORTED_MODULE_0__","easing","duration","inputLerp","pressure","startTime","config","deltaTime","output","surfaceLook","Surface","_surface_scss__WEBPACK_IMPORTED_MODULE_2__","SetDiameterMsg","diameterPx","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default","SetSoftnessMsg","softnessPct","SetOpacityMsg","opacityPct","SetSpacingMsg","spacingPct","SetPressureAffectsOpacityMsg","pressureAffectsOpacity","SetPressureAffectsSizeMsg","pressureAffectsSize","SetDelayMsg","delayMs","createBrushSender","setDelay","setDiameter","px","setSoftness","setOpacity","setSpacing","setPressureAffectsOpacity","setPressureAffectsSize","initTempState","flowPct","BrushDelay","_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_1___default","unexpected message","brushInput","pointerToBrushInput","interpState","Interp","createInputPoint","delayState","createBrushPoint","tempState","inputs","brushDelayInput","updateResult","interpReslt","_BrushDelay$update","_BrushDelay$update2","_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default","newBrushInput","_Interp$interpolate","_Interp$interpolate2","Color","position","rotation","scaledDiameter","Details","sender","messageSender","toFixed","InlineLabeled","Switch","checked","onCheck","ZipperList","__left","focus","__right","reverse","toArray","isNonEmpty","tail","head","cons","attempt","hasLeft","focusLeft","hasRight","focusRight","stack","Stack","empty","unsafeFromArray","right","PointerState","Menu","isExpanded","selectHandler","onGlobalClick","containerNode","parentElement","closeMenu","openMenu","closeAndCallback","onSelect","onBlur","show","choices","margin-top","height","getLeft","getRight","MARGIN","ColorWheel","canvasRef","glState","pointerState","Default","colorMode","colorHandler","signalOuter","clientY","top","hue","hsv","with","signalInner","marginX","marginY","pctX","pctY","initializeCanvas","useMutationEffect","canvas ref not fonud","GlState","dispose","renderCanvas","a","is","_ev","DownOnInner","DownOnOuter","isInclusive","colorType","canvasNode","thumbData","getThumbPositions","circleThumbX","circleThumbY","border-color","angle","areaThumbX","areaThumbY","blendFunc","enable","BLEND","disable","DEPTH_TEST","ringRenderer","RingRenderer","satValRenderer","SatValRenderer","clearColor","clear","COLOR_BUFFER_BIT","canvasRect","xPct","yPct","cx","cy","RING_VERT_SRC","makeRingFragSrc","DEFINE_toRgb","DEFINE_TAU","RING_FRAG_SRC_HSV","DEFINE_hsvToRgb","RING_FRAG_SRC_HSLUV","DEFINE_hsluv_etc","colorLocation","prevColorType","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","useProgram","drawArrays","TRIANGLE_STRIP","deleteBuffer","WI","SATVAL_VERT_SRC","makeSatValFragSrc","SATVAL_FRAG_SRC_HSV","SATVAL_FRAG_SRC_HSLUV","prevColorMode","unexpected color mode","TRIANGLES","ColorDisplay","colorSecondary","SetColorMsg","SetColorModeMsg","SwapColorMsg","setColor","setColorMode","swapColorFrom","focusf","onColorText","fromCss","margin","onPaste","ColorSliders","HsluvSliders","HsvSliders","Generators","XorshiftSeed","_Seed","_this","possibleConstructorReturn_default","getPrototypeOf_default","inherits_default","force","asInt","seed","step","Seed","_this$nextFloat","nextFloat","_this$nextFloat2","_state2$nextFloat","_state2$nextFloat2","_this$nextFloat3","_this$nextFloat4","_state2$nextFloat3","_state2$nextFloat4","_state3$nextFloat","_state3$nextFloat2","always","rng","_rng$nextFloat","_rng$nextFloat2","_rng$nextFloat3","_rng$nextFloat4","nextSeed","int_","float","_rng$nextFloat5","_rng$nextFloat6","float_","t2","genA","genB","rng0","_genA","_genA2","valA","rng1","_genB","_genB2","valB","rng2","t2_","t3","genC","_genA3","_genA4","_genB3","_genB4","_genC","_genC2","valC","rng3","t3_","gen","_gen","_gen2","nextRng","gens","obj","_gens$prop","_gens$prop2","_genA5","_genA6","_genA7","_genA8","_genB5","_genB6","map2_","_genA9","_genA10","_genB7","_genB8","_genC3","_genC4","map3_","map4","genD","_genA11","_genA12","_genB9","_genB10","_genC5","_genC6","_genD","_genD2","valD","rng4","map4_","_genA13","_genA14","andThen_","createGen","cachedGen","rng_XorshiftSeed","generators_Generators","layersWrapper","layersListWrapper","layersControlsWrapper","unselectedLayerWrapper","selectedLayerWrapper","layerLeft","layerRight","layerName","layerOpacity","_typeof2","iterator","constructor","_typeof","useSelect","useUnmount","useLayoutEffect","_core__WEBPACK_IMPORTED_MODULE_0__","_scheduler__WEBPACK_IMPORTED_MODULE_1__","selector","areEqual","nextProps","lastChecked","prevSelector","hook","hooks","addHook","withEffect","scheduleTask","reset","TASK_TOKEN","SELECT_TOKEN","UNMOUNT_TOKEN","EMPTY_OBJECT","_inlineLabeled_scss__WEBPACK_IMPORTED_MODULE_2__","_switch_scss__WEBPACK_IMPORTED_MODULE_3__","interpolate","pcts","spacingPx","endX","endY","endPressure","endSpacing","totalDist","dist","prevX","prevY","prevPressure","interpolateWithPressureScaling","pressureIsEq","alphaIsEq","colorIsEq","rotationIsEq","pctsLen","lastBrushPoint","SVG_NAMESPACE","_nextNode","_deepStateFlags","_resetState","visitNodes","opState","visitor","getDOMNode","_dirtyCheck","moveNode","singleChild","_moveNodes","shortcuts","context","_unmount","_unmountRemove","_unmountWalk","_createElement","node","op","svg","tagName","createElementNS","createElement","_updateClassName","_updateAttrs","_mount","vdom_state","childrenOps","newChildren","_mountFragment","opType","prevState","_mountObject","createTextNode","_mountText","nextOp","nodeValue","opStateChildren","prevData","nextData","nextValue","deepState","j","aEnd","bEnd","outer","k","pos","updated","aLength","bLength","sources","keyIndex","Map","seq","lis","_updateChildrenTrackByKeys","_updateAttr","matchCount","bValue","setProperty","removeProperty","_updateStyle","selectedDisplay","selectedDisplayExpanded","selectableOptions","optionDefault","optionSelected","Empty","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default","_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default","NonEmpty","initial","nonReversed","reversed","str","fromArray","xswitch","switchButtonContainer","switchButton","bgColorPrimary","bgColorSecondary","switchBar","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","len","marker","runClearTimeout","Item","nextTick","browser","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","ROOTS","findRoot","dirtyCheck","_reconciler__WEBPACK_IMPORTED_MODULE_0__","find","updateDiff","updateAll","random","color__WEBPACK_IMPORTED_MODULE_0__","_rng__WEBPACK_IMPORTED_MODULE_1__","styleMap","--color-primary","theme","primary","--color-primaryLight","primaryLight","--color-primaryDark","primaryDark","--color-secondary","secondary","--color-secondaryLight","secondaryLight","--color-secondaryDark","secondaryDark","--color-onPrimary","onPrimary","--color-onSecondary","onSecondary","--color-onSurface","onSurface","--color-surface","surface","--color-background","background","--shadows-button","shadows","--shadows-menu","menu","--shadows-surface","--fonts-monospace","fonts","monospace","--fonts-normal","normal","prevTheme","nextTheme","prevValue","hsluvGen","maxSat","luminance","Gen","colorsGen","shadowsGen","fontsGen","emitAttribute","emitChildren","_attributes","_children","attr","escapeText","indexOf","escape","charCodeAt","escapeAttributeValue","textContainer","baseLine","filledLineClass","emptyButton","LeafLayer","id","opacity","isHidden","GroupLayer","selectedPath","selected","isLeaf","getWithContext","child","path","findPath","leaf","newSelected","insert","withChildren","_selected$remove","remove","_selected$remove2","newSelectedPath","newIndex","updateFn","layer","nextOpacity","collectLeaves","NewLayerMsg","RemoveMsg","SelectMsg","SetHiddenMsg","newLayer","removeLayer","selectLayer","setHidden","State","getNextLayerId","layers","removeCurrent","select","updateCurrent","selectedIdx","above","below","_this$layers$remove","_this$layers$remove2","newLayers","oldIndex","layerId","group","FRAG_SRC","WebGL","Uniforms","u_resolution","u_texture","Shader","locations","capacity","_WebGL$Blend$factorsN","bindFramebuffer","FRAMEBUFFER","blocks","_args$blocks$i","DYNAMIC_DRAW","vertexAttrib","bindAttribLocations","u_softness","Generator","viewport","framebuffer","u_opacity","u_rgba","INITIAL_VARRAY_SIZE","initAffectedArea","MIN_VALUE","arrayLength","affectedArea","points","nextOffset","doubleSize","ptsLen","addPoint","arrayView","subarray","_WebGL$Blend$getFacto","blendMode","drawCount","getDrawCount","point","addCorner","tx","ty","PX_PER_BLOCK_X","PX_PER_BLOCK_Y","Block","BlockTracker","_frameBlocks","_strokeBlocks","frameBlocks","radius","xMin","yMin","xMax","yMax","xBlockMin","xBlockMax","yBlockMax","block","exists","strokeBlocks","_this$_frameBlocks","toConsumableArray_default","nextTextureId","Texture","texture","createTextureWithFramebuffer","allTextures","textureBindings","createTexture","createFramebuffer","ensureTextureIsBound","texImage2D","TEXTURE_2D","RGBA","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","framebufferTexture2D","COLOR_ATTACHMENT0","frameBufferStatus","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","FRAMEBUFFER_INCOMPLETE_ATTACHMENT","FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT","FRAMEBUFFER_INCOMPLETE_DIMENSIONS","FRAMEBUFFER_UNSUPPORTED","activeTexture","TEXTURE0","bindTexture","minTime","minTimeIdx","layersAreDifferent","CanvasMsgType","InternalContext","brushTextureGenerator","textureRenderer","clearBlocksRenderer","outputRenderer","drawpointBatch","fill","layerTextureMap","internalCanvasSize","resolution","stroke","renderBlocks","BlockRender","prevLayers","brushTexture","generateBrushTexture","outputTexture","outFramebuffer","combinedLayers","addPoints","getStrokeBlocks","strokeEnded","endStroke","nextLayers","getFrameBlocks","canFlush","currentLayerTex","flush","layersToCombine","nextAbove","nextBelow","Render","layersToRender","textureShader","layersAbove","layersBelow","layersCurrent","textureAbove","textureBelow","textureCurrent","bgColor","afterFrame","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","done","deleteTexture","deleteFramebuffer","return","initState","_Theme$random","Theme","Rng","_Theme$random2","Tools","Layers","hasPressedDown","EffectType","OnFrame","OnClick","OnRelease","OnDrag","RandomizeTheme","ToolMsg","LayersMsg","NoOpEffect","FrameEffect","BrushPointsEffect","ReleaseEffect","timeMs","randomizeTheme","_Tools$onFrame","_Tools$onFrame2","nextToolEphemeral","_Tools$onClick","_Tools$onClick2","nextTool","_Tools$onRelease","_Tools$onRelease2","defineProperty_default","_Tools$onDrag","_Tools$onDrag2","_Theme$random3","_Theme$random4","Canvas","canvasElement","perfTracker","onStats","splitLayers","newState","eff","addBrushPoints","unexpected effect","antialias","depth","premultipliedAlpha","stencil","preserveDrawingBuffer","desynchronized","attrs","getContextAttributes","getExtension","_Blend$factorsNormal","BrushShader","BrushTextureShader","TextureShader","ClearBlocksShader","OutputShader","Context","_dom_shortcuts__WEBPACK_IMPORTED_MODULE_0__","_dispatch__WEBPACK_IMPORTED_MODULE_2__","_utils__WEBPACK_IMPORTED_MODULE_3__","dispatchNativeEvent","event","currentTarget","createNativeEventSource","options","ABORT_EVENT","ACTIVATE_EVENT","ARIA_REQUEST_EVENT","BEFORE_ACTIVATE_EVENT","BEFORE_COPY_EVENT","BEFORE_CUT_EVENT","BEFORE_DEACTIVATE_EVENT","BEFORE_PASTE_EVENT","BLUR_EVENT","CAN_PLAY_EVENT","CAN_PLAYTHROUGH_EVENT","CHANGE_EVENT","CLICK_EVENT","CONTEXT_MENU_EVENT","COPY_EVENT","CUE_CHANGE_EVENT","CUT_EVENT","DOUBLE_CLICK_EVENT","DEACTIVATE_EVENT","DRAG_EVENT","DRAG_END_EVENT","DRAG_ENTER_EVENT","DRAG_LEAVE_EVENT","DRAG_OVER_EVENT","DRAG_START_EVENT","DROP_EVENT","DURATION_CHANGE_EVENT","EMPTIED_EVENT","ENCRYPTED_EVENT","ENDED_EVENT","ERROR_EVENT","FOCUS_EVENT","GOT_POINTER_CAPTURE_EVENT","BEFORE_INPUT_EVENT","INPUT_EVENT","INVALID_EVENT","KEY_DOWN_EVENT","KEY_PRESS_EVENT","KEY_UP_EVENT","LOAD_EVENT","LOADED_DATA_EVENT","LOADED_METADATA_EVENT","LOAD_START_EVENT","LOST_POINTER_CAPTURE_EVENT","MOUSE_DOWN_EVENT","MOUSE_MOVE_EVENT","MOUSE_OUT_EVENT","MOUSE_OVER_EVENT","MOUSE_UP_EVENT","PASTE_EVENT","PAUSE_EVENT","PLAY_EVENT","PLAYING_EVENT","POINTER_CANCEL_EVENT","POINTER_DOWN_EVENT","POINTER_MOVE_EVENT","POINTER_OUT_EVENT","POINTER_OVER_EVENT","POINTER_UP_EVENT","PROGRESS_EVENT","RATE_CHANGE_EVENT","RESET_EVENT","SCROLL_EVENT","SEEKED_EVENT","SEEKING_EVENT","SELECT_EVENT","SELECT_START_EVENT","STALLED_EVENT","SUBMIT_EVENT","SUSPEND_EVENT","TIME_UPDATE_EVENT","TOUCH_CANCEL_EVENT","TOUCH_END_EVENT","TOUCH_MOVE_EVENT","TOUCH_START_EVENT","TRANSITION_CANCEL_EVENT","TRANSITION_END_EVENT","TRANSITION_RUN_EVENT","TRANSITION_START_EVENT","UNLOAD_EVENT","VOLUME_CHANGE_EVENT","WAITING_EVENT","WHEEL_EVENT","ACTIVE_TOUCH_END_EVENT","ACTIVE_TOUCH_MOVE_EVENT","ACTIVE_TOUCH_START_EVENT","ACTIVE_WHEEL_EVENT","nativeEventHandlerFactory","bubbleDescriptor","captureDescriptor","capture","EVENT_CAPTURE_ACTIVE_OPTIONS","_dom_feature_detection__WEBPACK_IMPORTED_MODULE_0__","PASSIVE_EVENTS","ddefault","sinkableUnsunk","sinkableSunk","strictEqual","shallowEqual","shallowEqualArray","aKeys","bKeys","createStateNode","wrapper","bottomLeft","bottomRight","appContainer","cicleThumb","areaThumb","row","column","contentContainer","monospaced","textInput","detailsContainer","toolBarContainer","leftBar","codeInput","_reconciler__WEBPACK_IMPORTED_MODULE_1__","_factories__WEBPACK_IMPORTED_MODULE_1__","_hooks__WEBPACK_IMPORTED_MODULE_2__","_Ref","updateRef","IGNORE_RENDER_TO_STRING","View","ivi_html__WEBPACK_IMPORTED_MODULE_3__","___WEBPACK_IMPORTED_MODULE_4__","_brush__WEBPACK_IMPORTED_MODULE_5__","_eraser__WEBPACK_IMPORTED_MODULE_6__","_views_buttons__WEBPACK_IMPORTED_MODULE_7__","_views_surface__WEBPACK_IMPORTED_MODULE_8__","_toolbar_scss__WEBPACK_IMPORTED_MODULE_9__","memo","currentToolType","msgSender","transientState","isDetailsExpanded","dispatchEvent","_vdom_root__WEBPACK_IMPORTED_MODULE_0__","collectDispatchTargets","match","targets","contains","visitUp","stateNode","parentNode","visitDown","collectDispatchTargetsFromEventsOpState","assertThisInitialized","self","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","subClass","superClass","listen","PointerEvent","pointerDown","click","localizePointer","pointerUp","release","pointerMove","move","uncoalesceAndLocalize","drag","checkPressureSupport","listenForPointers","mouseDown","localizeMouse","mouseUp","mouseMove","listenForMouse","pointerSupportsPressure","pointerId","uncoalesce","getCoalescedEvents","originalEvent","shift","shiftKey","alt","altKey","ctrl","ctrlKey","events","isRelease","arrayWithoutHoles","iterableToArray","nonIterableSpread","asyncGeneratorStep","reject","_next","_throw","info","Scripting","_scripting_scss__WEBPACK_IMPORTED_MODULE_10__","_scripting_scss__WEBPACK_IMPORTED_MODULE_10___default","textareaRef","code","onInput","onKeyboard","textareaNode","preventDefault","listenToKeyboard","initialValue","SignalWithPush","handlers","currentValue","SignalWrapper","idx","removeHandler","baseSignal","subscribe","Row","spacing","spacedChildren","margin-left","LayersView","topLayers","selectedId","LayerView","App","removeInputListeners","cancelFrameStream","canvasModel","debuggingGl","perfTrackerData","Signals","store","ef","handle","updateTheme","updateCanvas","setupCanvas","htmlCanvas","stats","onWebglContextCreated","Input","Toolbar","cursor","Buttons","rootElement","getElementById","_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default","hot","accept","originalModule","webpackPolyfill","_arr","_n","_d","_e","_s","_i","ReferenceError","_setPrototypeOf","arr2","iter","Function","hadRuntime","regeneratorRuntime","getOwnPropertyNames","oldRuntime","global","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","inModule","runtime","wrap","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","IteratorPrototype","getProto","NativeIteratorPrototype","values","Gp","GeneratorFunctionPrototype","GeneratorFunction","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","__await","defineIteratorMethods","AsyncIterator","async","innerFn","outerFn","tryLocsList","skipTempReset","sent","_sent","delegate","method","tryEntries","resetTryEntry","charAt","stop","rootRecord","completion","rval","dispatchException","exception","loc","caught","record","entry","tryLoc","hasCatch","hasFinally","catchLoc","finallyLoc","abrupt","finallyEntry","complete","afterLoc","finish","catch","thrown","delegateYield","iterable","resultName","nextLoc","protoGenerator","generator","_invoke","doneResult","delegateResult","maybeInvokeDelegate","tryCatch","makeInvokeMethod","previousPromise","callInvokeWithMethodAndArg","invoke","unwrapped","pushTryEntry","locs","iteratorMethod","Performance","SamplesOverTime","samplesSignal","nextSamples","samplecount","sum","sample","sample0","sample1","sample2","sample3","isOpen","open","close","display","perfSamplesSignal","NOOP","_equal__WEBPACK_IMPORTED_MODULE_0__"],"mappings":"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","file":"main-65359a554dfd766255f6.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 78);\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","import { checkElement } from \"../debug/element\";\nimport { createOpType, createDOMElementOp, createValueOp } from \"./operations\";\n/**\n * elementFactory creates a factory for DOM elements.\n *\n * @param tag HTML element tag name.\n * @param flags Node flags.\n * @returns HTML element operation factory.\n */\nexport function elementFactory(tag, flags) {\n    const t = createOpType(flags, tag);\n    return process.env.NODE_ENV !== \"production\" ?\n        (n, v, c = null) => {\n            checkElement(tag, v, (flags & 512 /* Svg */) !== 0);\n            return createDOMElementOp(t, v, c, n);\n        } :\n        /* istanbul ignore next */ (n, v, c = null) => createDOMElementOp(t, v, c, n);\n}\n/**\n * htmlElementFactory creates a factory for HTML elements.\n *\n * @param tag HTML element tag name.\n * @returns HTML element operation factory.\n */\nexport const htmlElementFactory = (tag) => elementFactory(tag, 2 /* Element */);\n/**\n * svgElementFactory creates a factory for SVG elements.\n *\n * @param tag SVG element tag name.\n * @returns SVG element operation factory.\n */\nexport const svgElementFactory = (tag) => elementFactory(tag, 2 /* Element */ | 512 /* Svg */);\n/**\n * `elementProto()` creates a factory that produces elements with predefined attributes.\n *\n * @example\n *\n *     const DivWithIdAttribute = elementProto(div(_, { id: \"predefined-id\" }));\n *\n *     render(\n *       DivWithIdAttribute(\"class-name\", { title: \"Title\" }, \"Hello World\"),\n *       document.getElementById(\"app\")!,\n *     );\n *\n * @param p Element prototype.\n * @returns Factory that produces elements with predefined attributes.\n */\nexport function elementProto(p) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        if (p.c !== null) {\n            throw new Error(`Invalid OpNode, element prototypes can't have any children`);\n        }\n        checkElement(p.t.d, p.v, (p.t.f & 512 /* Svg */) !== 0);\n    }\n    const t = createOpType(p.t.f | 64 /* ElementProto */, { n: null, p });\n    return (n, v, c = null) => createDOMElementOp(t, v, c, n);\n}\n/**\n * component creates a factory that produces component nodes.\n *\n * @example\n *\n *     const A = component<string>(() => {\n *       let _text;\n *       const click = onClick(() => { console.log(_text); });\n *\n *       return (text) => (\n *         _text = text,\n *         Events(click,\n *           button(_, _, \"Click Me\"),\n *         )\n *       );\n *     });\n *\n * @param c Component function.\n * @param e `areEqual` function.\n * @returns Factory that produces component nodes.\n */\nexport function component(c, e) {\n    const type = createOpType(4 /* Component */ | 256 /* Stateful */ | 16384 /* DirtyCheck */, { c, e });\n    return (props) => createValueOp(type, props);\n}\n/**\n * statelessComponent creates an factory that produces stateless components nodes.\n *\n * @example\n *\n *     const A = statelessComponent<string>((text) => div(_, _, text));\n *\n * @param c Update function.\n * @param e `areEqual` function.\n * @returns Factory that produces stateless component nodes.\n */\nexport function statelessComponent(c, e) {\n    const type = createOpType(4 /* Component */, { c, e });\n    return (props) => createValueOp(type, props);\n}\n//# sourceMappingURL=factories.js.map","import { elementFactory, htmlElementFactory, emitAttribute, emitChildren, escapeAttributeValue, escapeText, IGNORE_RENDER_TO_STRING, } from \"ivi\";\n/**\n * {@link AttributeDirective} with `\"\"` value and {@link updateValue} sync function.\n */\nconst VALUE_EMPTY = { v: \"\", u: updateValue };\n/**\n * {@link AttributeDirective} with `false` value and {@link updateChecked} sync function.\n */\nconst CHECKED_FALSE = { v: false, u: updateChecked };\n/**\n * {@link AttributeDirective} with `true` value and {@link updateChecked} sync function.\n */\nconst CHECKED_TRUE = { v: true, u: updateChecked };\n/**\n * {@link AttributeDirective} with `true` value that emits `checked` attribute.\n */\nconst CHECKED_TRUE_RENDER_TO_STRING = { v: true, s: () => { emitAttribute(\"checked\"); } };\n/**\n * Render to string function for an {@link AttributeDirective} created with {@link VALUE} function.\n *\n * @param key Attribute key.\n * @param value Value.\n */\nfunction renderToStringValue(key, value) {\n    emitAttribute(`value=\"${escapeAttributeValue(value)}\"`);\n}\n/**\n * Render to string function for an {@link AttributeDirective} created with {@link CONTENT} function.\n *\n * @param key Attribute key.\n * @param value Value.\n */\nfunction renderToStringContent(key, value) {\n    emitChildren(escapeText(value));\n}\n/**\n * Synchronization function for {@link AttributeDirective} created with {@link VALUE} function.\n *\n * @param element Target element.\n * @param key Attribute key.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction updateValue(element, key, prev, next) {\n    if (prev === void 0) {\n        if (next !== \"\") {\n            element.value = next;\n        }\n    }\n    else if (next !== void 0 && (element.value !== next)) {\n        element.value = next;\n    }\n}\n/**\n * Synchronization function for {@link AttributeDirective} created with {@link CHECKED} function.\n *\n * @param element Target element.\n * @param key Attribute key.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction updateChecked(element, key, prev, next) {\n    if (prev === void 0) {\n        if (next) {\n            element.checked = next;\n        }\n    }\n    else if (next !== void 0) {\n        if (element.checked !== next) {\n            element.checked = next;\n        }\n    }\n}\n/**\n * VALUE function creates a {@link AttributeDirective} that assigns a `value` property to an HTMLInputElement.\n *\n * @example\n *\n *   const e = input(\"\", { value: VALUE(\"value\") });\n *\n * @param v Value.\n * @returns {@link AttributeDirective}\n */\nexport const VALUE = (v) => (process.env.IVI_TARGET === \"ssr\" ?\n    v === \"\" ? IGNORE_RENDER_TO_STRING : { v, s: renderToStringValue } :\n    v === \"\" ? VALUE_EMPTY : { v, u: updateValue });\n/**\n * CONTENT function creates a {@link AttributeDirective} that assigns a `value` property to an HTMLTextAreaElement.\n *\n * @example\n *\n *   const e = textarea(\"\", { content: CONTENT(\"content\") });\n *\n * @param v Value.\n * @returns {@link AttributeDirective}\n */\nexport const CONTENT = (process.env.IVI_TARGET === \"ssr\" ?\n    (v) => (v === \"\" ? IGNORE_RENDER_TO_STRING : ({ v, s: renderToStringContent })) :\n    VALUE);\n/**\n * CHECKED function creates a {@link AttributeDirective} that assigns a `checked` property to an HTMLInputElement.\n *\n * @example\n *\n *   const e = input(\"\", { checked: CHECKED(true) });\n *\n * @param v Checked value.\n * @returns {@link AttributeDirective}\n */\nexport const CHECKED = (v) => (process.env.IVI_TARGET === \"ssr\" ?\n    v ? CHECKED_TRUE_RENDER_TO_STRING : IGNORE_RENDER_TO_STRING :\n    v ? CHECKED_TRUE : CHECKED_FALSE);\n/* tslint:disable:max-line-length */\n/**\n * Creates OpNode HTML element <a>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <a>\n */\nexport const a = /*#__PURE__*/ htmlElementFactory(\"a\");\n/**\n * Creates OpNode HTML element <abbr>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/abbr}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <abbr>\n */\nexport const abbr = /*#__PURE__*/ htmlElementFactory(\"abbr\");\n/**\n * Creates OpNode HTML element <address>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/address}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <address>\n */\nexport const address = /*#__PURE__*/ htmlElementFactory(\"address\");\n/**\n * Creates OpNode HTML element <article>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/article}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <article>\n */\nexport const article = /*#__PURE__*/ htmlElementFactory(\"article\");\n/**\n * Creates OpNode HTML element <aside>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/aside}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <aside>\n */\nexport const aside = /*#__PURE__*/ htmlElementFactory(\"aside\");\n/**\n * Creates OpNode HTML element <b>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/b}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <b>\n */\nexport const b = /*#__PURE__*/ htmlElementFactory(\"b\");\n/**\n * Creates OpNode HTML element <base>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <base>\n */\nexport const base = /*#__PURE__*/ elementFactory(\"base\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <bdo>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/bdo}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <bdo>\n */\nexport const bdo = /*#__PURE__*/ htmlElementFactory(\"bdo\");\n/**\n * Creates OpNode HTML element <blockquote>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/blockquote}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <blockquote>\n */\nexport const blockquote = /*#__PURE__*/ htmlElementFactory(\"blockquote\");\n/**\n * Creates OpNode HTML element <body>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/body}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <body>\n */\nexport const body = /*#__PURE__*/ htmlElementFactory(\"body\");\n/**\n * Creates OpNode HTML element <br>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/br}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <br>\n */\nexport const br = /*#__PURE__*/ elementFactory(\"br\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <button>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <button>\n */\nexport const button = /*#__PURE__*/ htmlElementFactory(\"button\");\n/**\n * Creates OpNode HTML element <canvas>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <canvas>\n */\nexport const canvas = /*#__PURE__*/ htmlElementFactory(\"canvas\");\n/**\n * Creates OpNode HTML element <caption>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/caption}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <caption>\n */\nexport const caption = /*#__PURE__*/ htmlElementFactory(\"caption\");\n/**\n * Creates OpNode HTML element <cite>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/cite}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <cite>\n */\nexport const cite = /*#__PURE__*/ htmlElementFactory(\"cite\");\n/**\n * Creates OpNode HTML element <code>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/code}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <code>\n */\nexport const code = /*#__PURE__*/ htmlElementFactory(\"code\");\n/**\n * Creates OpNode HTML element <col>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/col}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <col>\n */\nexport const col = /*#__PURE__*/ elementFactory(\"col\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <colgroup>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <colgroup>\n */\nexport const colgroup = /*#__PURE__*/ htmlElementFactory(\"colgroup\");\n/**\n * Creates OpNode HTML element <del>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/del}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <del>\n */\nexport const del = /*#__PURE__*/ htmlElementFactory(\"del\");\n/**\n * Creates OpNode HTML element <dfn>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dfn}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <dfn>\n */\nexport const dfn = /*#__PURE__*/ htmlElementFactory(\"dfn\");\n/**\n * Creates OpNode HTML element <div>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/div}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <div>\n */\nexport const div = /*#__PURE__*/ htmlElementFactory(\"div\");\n/**\n * Creates OpNode HTML element <dd>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dd}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <dd>\n */\nexport const dd = /*#__PURE__*/ htmlElementFactory(\"dd\");\n/**\n * Creates OpNode HTML element <dl>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dl}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <dl>\n */\nexport const dl = /*#__PURE__*/ htmlElementFactory(\"dl\");\n/**\n * Creates OpNode HTML element <dt>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dt}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <dt>\n */\nexport const dt = /*#__PURE__*/ htmlElementFactory(\"dt\");\n/**\n * Creates OpNode HTML element <em>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/em}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <em>\n */\nexport const em = /*#__PURE__*/ htmlElementFactory(\"em\");\n/**\n * Creates OpNode HTML element <fieldset>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/fieldset}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <fieldset>\n */\nexport const fieldset = /*#__PURE__*/ htmlElementFactory(\"fieldset\");\n/**\n * Creates OpNode HTML element <figcaption>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/figcaption}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <figcaption>\n */\nexport const figcaption = /*#__PURE__*/ htmlElementFactory(\"figcaption\");\n/**\n * Creates OpNode HTML element <figure>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/figure}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <figure>\n */\nexport const figure = /*#__PURE__*/ htmlElementFactory(\"figure\");\n/**\n * Creates OpNode HTML element <footer>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/footer}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <footer>\n */\nexport const footer = /*#__PURE__*/ htmlElementFactory(\"footer\");\n/**\n * Creates OpNode HTML element <form>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <form>\n */\nexport const form = /*#__PURE__*/ htmlElementFactory(\"form\");\n/**\n * Creates OpNode HTML element <h1>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h1}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <h1>\n */\nexport const h1 = /*#__PURE__*/ htmlElementFactory(\"h1\");\n/**\n * Creates OpNode HTML element <h2>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h2}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <h2>\n */\nexport const h2 = /*#__PURE__*/ htmlElementFactory(\"h2\");\n/**\n * Creates OpNode HTML element <h3>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h3}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <h3>\n */\nexport const h3 = /*#__PURE__*/ htmlElementFactory(\"h3\");\n/**\n * Creates OpNode HTML element <h4>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h4}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <h4>\n */\nexport const h4 = /*#__PURE__*/ htmlElementFactory(\"h4\");\n/**\n * Creates OpNode HTML element <h5>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h5}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <h5>\n */\nexport const h5 = /*#__PURE__*/ htmlElementFactory(\"h5\");\n/**\n * Creates OpNode HTML element <h6>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h6}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <h6>\n */\nexport const h6 = /*#__PURE__*/ htmlElementFactory(\"h6\");\n/**\n * Creates OpNode HTML element <head>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/head}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <head>\n */\nexport const head = /*#__PURE__*/ htmlElementFactory(\"head\");\n/**\n * Creates OpNode HTML element <header>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/header}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <header>\n */\nexport const header = /*#__PURE__*/ htmlElementFactory(\"header\");\n/**\n * Creates OpNode HTML element <hgroup>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/hgroup}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <hgroup>\n */\nexport const hgroup = /*#__PURE__*/ htmlElementFactory(\"hgroup\");\n/**\n * Creates OpNode HTML element <hr>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/hr}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <hr>\n */\nexport const hr = /*#__PURE__*/ elementFactory(\"hr\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <html>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/html}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <html>\n */\nexport const html = /*#__PURE__*/ htmlElementFactory(\"html\");\n/**\n * Creates OpNode HTML element <i>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/i}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <i>\n */\nexport const i = /*#__PURE__*/ htmlElementFactory(\"i\");\n/**\n * Creates OpNode HTML element <iframe>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <iframe>\n */\nexport const iframe = /*#__PURE__*/ htmlElementFactory(\"iframe\");\n/**\n * Creates OpNode HTML element <img>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <img>\n */\nexport const img = /*#__PURE__*/ elementFactory(\"img\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <area>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/area}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <area>\n */\nexport const area = /*#__PURE__*/ elementFactory(\"area\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <map>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/map}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <map>\n */\nexport const map = /*#__PURE__*/ htmlElementFactory(\"map\");\n/**\n * Creates OpNode HTML element <ins>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ins}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <ins>\n */\nexport const ins = /*#__PURE__*/ htmlElementFactory(\"ins\");\n/**\n * Creates OpNode HTML element <kbd>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/kbd}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <kbd>\n */\nexport const kbd = /*#__PURE__*/ htmlElementFactory(\"kbd\");\n/**\n * Creates OpNode HTML element <label>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/label}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <label>\n */\nexport const label = /*#__PURE__*/ htmlElementFactory(\"label\");\n/**\n * Creates OpNode HTML element <legend>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/legend}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <legend>\n */\nexport const legend = /*#__PURE__*/ htmlElementFactory(\"legend\");\n/**\n * Creates OpNode HTML element <li>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/li}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <li>\n */\nexport const li = /*#__PURE__*/ htmlElementFactory(\"li\");\n/**\n * Creates OpNode HTML element <link>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <link>\n */\nexport const link = /*#__PURE__*/ elementFactory(\"link\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <main>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/main}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <main>\n */\nexport const main = /*#__PURE__*/ htmlElementFactory(\"main\");\n/**\n * Creates OpNode HTML element <mark>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/mark}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <mark>\n */\nexport const mark = /*#__PURE__*/ htmlElementFactory(\"mark\");\n/**\n * Creates OpNode HTML element <menu>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/menu}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <menu>\n */\nexport const menu = /*#__PURE__*/ htmlElementFactory(\"menu\");\n/**\n * Creates OpNode HTML element <meta>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <meta>\n */\nexport const meta = /*#__PURE__*/ elementFactory(\"meta\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <meter>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meter}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <meter>\n */\nexport const meter = /*#__PURE__*/ htmlElementFactory(\"meter\");\n/**\n * Creates OpNode HTML element <nav>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/nav}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <nav>\n */\nexport const nav = /*#__PURE__*/ htmlElementFactory(\"nav\");\n/**\n * Creates OpNode HTML element <noscript>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/noscript}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <noscript>\n */\nexport const noscript = /*#__PURE__*/ htmlElementFactory(\"noscript\");\n/**\n * Creates OpNode HTML element <ol>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ol}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <ol>\n */\nexport const ol = /*#__PURE__*/ htmlElementFactory(\"ol\");\n/**\n * Creates OpNode HTML element <optgroup>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/optgroup}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <optgroup>\n */\nexport const optgroup = /*#__PURE__*/ htmlElementFactory(\"optgroup\");\n/**\n * Creates OpNode HTML element <option>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/option}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <option>\n */\nexport const option = /*#__PURE__*/ htmlElementFactory(\"option\");\n/**\n * Creates OpNode HTML element <p>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/p}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <p>\n */\nexport const p = /*#__PURE__*/ htmlElementFactory(\"p\");\n/**\n * Creates OpNode HTML element <picture>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <picture>\n */\nexport const picture = /*#__PURE__*/ htmlElementFactory(\"picture\");\n/**\n * Creates OpNode HTML element <pre>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/pre}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <pre>\n */\nexport const pre = /*#__PURE__*/ elementFactory(\"pre\", 2 /* Element */ | 2048 /* NewlineEatingElement */);\n/**\n * Creates OpNode HTML element <progress>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/progress}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <progress>\n */\nexport const progress = /*#__PURE__*/ htmlElementFactory(\"progress\");\n/**\n * Creates OpNode HTML element <q>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/q}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <q>\n */\nexport const q = /*#__PURE__*/ htmlElementFactory(\"q\");\n/**\n * Creates OpNode HTML element <rt>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/rt}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <rt>\n */\nexport const rt = /*#__PURE__*/ htmlElementFactory(\"rt\");\n/**\n * Creates OpNode HTML element <ruby>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ruby}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <ruby>\n */\nexport const ruby = /*#__PURE__*/ htmlElementFactory(\"ruby\");\n/**\n * Creates OpNode HTML element <s>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/s}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <s>\n */\nexport const s = /*#__PURE__*/ htmlElementFactory(\"s\");\n/**\n * Creates OpNode HTML element <samp>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/samp}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <samp>\n */\nexport const samp = /*#__PURE__*/ htmlElementFactory(\"samp\");\n/**\n * Creates OpNode HTML element <script>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <script>\n */\nexport const script = /*#__PURE__*/ htmlElementFactory(\"script\");\n/**\n * Creates OpNode HTML element <section>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/section}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <section>\n */\nexport const section = /*#__PURE__*/ htmlElementFactory(\"section\");\n/**\n * Creates OpNode HTML element <select>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <select>\n */\nexport const select = /*#__PURE__*/ htmlElementFactory(\"select\");\n/**\n * Creates OpNode HTML element <source>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/source}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <source>\n */\nexport const source = /*#__PURE__*/ elementFactory(\"source\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <span>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/span}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <span>\n */\nexport const span = /*#__PURE__*/ htmlElementFactory(\"span\");\n/**\n * Creates OpNode HTML element <strong>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/strong}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <strong>\n */\nexport const strong = /*#__PURE__*/ htmlElementFactory(\"strong\");\n/**\n * Creates OpNode HTML element <style>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <style>\n */\nexport const style = /*#__PURE__*/ htmlElementFactory(\"style\");\n/**\n * Creates OpNode HTML element <sub>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/sub}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <sub>\n */\nexport const sub = /*#__PURE__*/ htmlElementFactory(\"sub\");\n/**\n * Creates OpNode HTML element <sup>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/sup}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <sup>\n */\nexport const sup = /*#__PURE__*/ htmlElementFactory(\"sup\");\n/**\n * Creates OpNode HTML element <table>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/table}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <table>\n */\nexport const table = /*#__PURE__*/ htmlElementFactory(\"table\");\n/**\n * Creates OpNode HTML element <tbody>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/tbody}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <tbody>\n */\nexport const tbody = /*#__PURE__*/ htmlElementFactory(\"tbody\");\n/**\n * Creates OpNode HTML element <td>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <td>\n */\nexport const td = /*#__PURE__*/ htmlElementFactory(\"td\");\n/**\n * Creates OpNode HTML element <template>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/template}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <template>\n */\nexport const template = /*#__PURE__*/ htmlElementFactory(\"template\");\n/**\n * Creates OpNode HTML element <tfoot>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/tfoot}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <tfoot>\n */\nexport const tfoot = /*#__PURE__*/ htmlElementFactory(\"tfoot\");\n/**\n * Creates OpNode HTML element <th>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/th}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <th>\n */\nexport const th = /*#__PURE__*/ htmlElementFactory(\"th\");\n/**\n * Creates OpNode HTML element <thead>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/thead}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <thead>\n */\nexport const thead = /*#__PURE__*/ htmlElementFactory(\"thead\");\n/**\n * Creates OpNode HTML element <time>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/time}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <time>\n */\nexport const time = /*#__PURE__*/ htmlElementFactory(\"time\");\n/**\n * Creates OpNode HTML element <title>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/title}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <title>\n */\nexport const title = /*#__PURE__*/ htmlElementFactory(\"title\");\n/**\n * Creates OpNode HTML element <tr>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/tr}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <tr>\n */\nexport const tr = /*#__PURE__*/ htmlElementFactory(\"tr\");\n/**\n * Creates OpNode HTML element <track>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <track>\n */\nexport const track = /*#__PURE__*/ elementFactory(\"track\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <u>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/u}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <u>\n */\nexport const u = /*#__PURE__*/ htmlElementFactory(\"u\");\n/**\n * Creates OpNode HTML element <ul>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <ul>\n */\nexport const ul = /*#__PURE__*/ htmlElementFactory(\"ul\");\n/**\n * Creates OpNode HTML element <wbr>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/wbr}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <wbr>\n */\nexport const wbr = /*#__PURE__*/ elementFactory(\"wbr\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <textarea>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/textarea}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <textarea>\n */\nexport const textarea = /*#__PURE__*/ elementFactory(\"textarea\", 2 /* Element */ | 2048 /* NewlineEatingElement */);\n/**\n * Creates OpNode HTML element <input>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <input>\n */\nexport const input = /*#__PURE__*/ elementFactory(\"input\", 2 /* Element */ | 4096 /* VoidElement */);\n/**\n * Creates OpNode HTML element <audio>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/audio}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <audio>\n */\nexport const audio = /*#__PURE__*/ htmlElementFactory(\"audio\");\n/**\n * Creates OpNode HTML element <video>.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video}\n *\n * @param className Class name.\n * @param attrs Attributes.\n * @param children Children nodes.\n * @returns OpNode HTML element <video>\n */\nexport const video = /*#__PURE__*/ htmlElementFactory(\"video\");\n//# sourceMappingURL=index.js.map","export var Store;\r\n(function (Store) {\r\n    function create(args) {\r\n        const { effectsHandler, initialState, initialEphemeral, forceRender, update } = args;\r\n        let state = initialState;\r\n        let ephemeral = initialEphemeral;\r\n        function handleMsg(msg) {\r\n            const [nextState, nextEphemeral, effect] = update(state, ephemeral, msg);\r\n            if (state !== nextState) {\r\n                forceRender();\r\n                state = nextState;\r\n            }\r\n            effectsHandler.value(effect);\r\n            ephemeral = nextEphemeral;\r\n        }\r\n        return {\r\n            send: handleMsg,\r\n            getState: () => state,\r\n        };\r\n    }\r\n    Store.create = create;\r\n})(Store || (Store = {}));\r\n","export var Decode;\r\n(function (Decode) {\r\n    function ok(value) {\r\n        return { isOk: true, value };\r\n    }\r\n    Decode.ok = ok;\r\n    function err() {\r\n        return { isOk: false, value: null };\r\n    }\r\n    Decode.err = err;\r\n    function bool(val) {\r\n        return typeof val === \"boolean\" ? ok(val) : err();\r\n    }\r\n    Decode.bool = bool;\r\n    function int(val) {\r\n        return typeof val === \"number\" && Number.isInteger(val) ? ok(val) : err();\r\n    }\r\n    Decode.int = int;\r\n    function number(val) {\r\n        return typeof val === \"number\" ? ok(val) : err();\r\n    }\r\n    Decode.number = number;\r\n    function string(val) {\r\n        return typeof val === \"string\" ? ok(val) : err();\r\n    }\r\n    Decode.string = string;\r\n    function nullable(decoder) {\r\n        return val => nullable_(decoder, val);\r\n    }\r\n    Decode.nullable = nullable;\r\n    function nullable_(decoder, val) {\r\n        return val === null ? ok(null) : decoder(val);\r\n    }\r\n    function maybe(decoder) {\r\n        return val => maybe_(decoder, val);\r\n    }\r\n    Decode.maybe = maybe;\r\n    function maybe_(decoder, val) {\r\n        return val === undefined ? ok(undefined) : decoder(val);\r\n    }\r\n    function array(decode) {\r\n        return val => array_(decode, val);\r\n    }\r\n    Decode.array = array;\r\n    function array_(decode, val) {\r\n        if (typeof val !== \"object\" || !Array.isArray(val))\r\n            return err();\r\n        const arr = [];\r\n        for (let i = 0; i < val.length; i++) {\r\n            const res = decode(val[i]);\r\n            if (!res.isOk)\r\n                return err();\r\n            arr.push(res.value);\r\n        }\r\n        return ok(arr);\r\n    }\r\n    function object(decoders) {\r\n        return val => object_(decoders, val);\r\n    }\r\n    Decode.object = object;\r\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\r\n    function object_(decoders, val) {\r\n        if (typeof val !== \"object\")\r\n            return err();\r\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\r\n        const resObj = {};\r\n        for (const propName in decoders) {\r\n            if (!decoders.hasOwnProperty(propName))\r\n                continue;\r\n            const prop = decoders[propName](val[propName]);\r\n            if (!prop.isOk)\r\n                return err();\r\n            resObj[propName] = prop.value;\r\n        }\r\n        return ok(resObj);\r\n    }\r\n    function dictionary(decoder) {\r\n        return val => dictionary_(decoder, val);\r\n    }\r\n    Decode.dictionary = dictionary;\r\n    function dictionary_(decoder, val_) {\r\n        if (typeof val_ !== \"object\")\r\n            return err();\r\n        const val = val_;\r\n        const keys = Object.keys(val);\r\n        const res = {};\r\n        for (let i = 0; i < keys.length; i++) {\r\n            const key = keys[i];\r\n            const value = decoder(val[key]);\r\n            if (!value.isOk)\r\n                return err();\r\n            res[key] = value.value;\r\n        }\r\n        return ok(res);\r\n    }\r\n    function tuple2(decoder1, decoder2) {\r\n        return val => tuple2_(decoder1, decoder2, val);\r\n    }\r\n    Decode.tuple2 = tuple2;\r\n    function tuple2_(decoder1, decoder2, val) {\r\n        if (typeof val !== \"object\" || !Array.isArray(val) || val.length < 2)\r\n            return err();\r\n        const first = decoder1(val[0]);\r\n        if (!first.isOk)\r\n            return err();\r\n        const second = decoder2(val[1]);\r\n        if (!second.isOk)\r\n            return err();\r\n        const tup = [first.value, second.value];\r\n        return ok(tup);\r\n    }\r\n    function tuple3_(decoder1, decoder2, decoder3, val) {\r\n        if (typeof val !== \"object\" || !Array.isArray(val) || val.length < 3)\r\n            return err();\r\n        const first = decoder1(val[0]);\r\n        if (!first.isOk)\r\n            return err();\r\n        const second = decoder2(val[1]);\r\n        if (!second.isOk)\r\n            return err();\r\n        const third = decoder3(val[2]);\r\n        if (!third.isOk)\r\n            return err();\r\n        const tup = [first.value, second.value, third.value];\r\n        return ok(tup);\r\n    }\r\n    function tuple3(decoder1, decoder2, decoder3) {\r\n        return val => tuple3_(decoder1, decoder2, decoder3, val);\r\n    }\r\n    Decode.tuple3 = tuple3;\r\n    function oneOf(decoders) {\r\n        return val => oneOf_(decoders, val);\r\n    }\r\n    Decode.oneOf = oneOf;\r\n    function oneOf_(decoders, val) {\r\n        for (let i = 0; i < decoders.length; i++) {\r\n            const res = decoders[i](val);\r\n            if (res.isOk)\r\n                return res;\r\n        }\r\n        return err();\r\n    }\r\n    function map(decoder, transform) {\r\n        return val => map_(decoder, transform, val);\r\n    }\r\n    Decode.map = map;\r\n    function map_(decoder, transform, val) {\r\n        const res = decoder(val);\r\n        return res.isOk ? ok(transform(res.value)) : err();\r\n    }\r\n    function filter(decoder, predicate) {\r\n        return val => filter_(decoder, predicate, val);\r\n    }\r\n    Decode.filter = filter;\r\n    function filter_(decoder, predicate, val) {\r\n        const res = decoder(val);\r\n        if (!res.isOk)\r\n            return res;\r\n        if (predicate(res.value))\r\n            return res;\r\n        return err();\r\n    }\r\n    function extend(decoder, transform) {\r\n        return val => extend_(decoder, transform, val);\r\n    }\r\n    Decode.extend = extend;\r\n    function extend_(decoder, transform, val) {\r\n        const baseRes = decoder(val);\r\n        return baseRes.isOk ? transform(baseRes.value) : err();\r\n    }\r\n    // Laziness is required for circularly defined data\r\n    function lazy(lazyDecoder) {\r\n        return val => lazyDecoder()(val);\r\n    }\r\n    Decode.lazy = lazy;\r\n    function createJsonDecoder(decoder) {\r\n        return json => decodeJson(decoder, json);\r\n    }\r\n    Decode.createJsonDecoder = createJsonDecoder;\r\n    function decodeJson(decoder, json) {\r\n        try {\r\n            return decoder(JSON.parse(json));\r\n        }\r\n        catch (ex) {\r\n            console.error(ex);\r\n            return err();\r\n        }\r\n    }\r\n    function decodeValue(decoder, value) {\r\n        return decoder(value);\r\n    }\r\n    Decode.decodeValue = decodeValue;\r\n})(Decode || (Decode = {}));\r\n","export var Maybe;\r\n(function (Maybe) {\r\n    function of(val) {\r\n        if (val == null)\r\n            return [];\r\n        return [val];\r\n    }\r\n    Maybe.of = of;\r\n    function withDefault(val, def) {\r\n        if (val.length === 0)\r\n            return def;\r\n        return val[0];\r\n    }\r\n    Maybe.withDefault = withDefault;\r\n    function withDefaultf(val, def) {\r\n        if (val.length === 0)\r\n            return def();\r\n        return val[0];\r\n    }\r\n    Maybe.withDefaultf = withDefaultf;\r\n    function map(val, f) {\r\n        if (val.length === 0)\r\n            return [];\r\n        return [f(val[0])];\r\n    }\r\n    Maybe.map = map;\r\n    function map2(val1, val2, f) {\r\n        if (val1.length === 0 || val2.length === 0)\r\n            return [];\r\n        return [f(val1[0], val2[0])];\r\n    }\r\n    Maybe.map2 = map2;\r\n    function map3(val1, val2, val3, f) {\r\n        if (val1.length === 0 || val2.length === 0 || val3.length === 0)\r\n            return [];\r\n        return [f(val1[0], val2[0], val3[0])];\r\n    }\r\n    Maybe.map3 = map3;\r\n    function andThen(val, f) {\r\n        if (val.length === 0)\r\n            return [];\r\n        return f(val[0]);\r\n    }\r\n    Maybe.andThen = andThen;\r\n})(Maybe || (Maybe = {}));\r\n","export var Result;\r\n(function (Result) {\r\n    function isOk(res) {\r\n        return res[0];\r\n    }\r\n    Result.isOk = isOk;\r\n    function isErr(res) {\r\n        return !res[0];\r\n    }\r\n    Result.isErr = isErr;\r\n    function ok(val) {\r\n        return [true, val];\r\n    }\r\n    Result.ok = ok;\r\n    function err(val) {\r\n        return [false, val];\r\n    }\r\n    Result.err = err;\r\n    function map(res, f) {\r\n        if (isOk(res)) {\r\n            return [true, f(res[1])];\r\n        }\r\n        else {\r\n            return [false, res[1]];\r\n        }\r\n    }\r\n    Result.map = map;\r\n    function mapErr(res, f) {\r\n        if (isOk(res)) {\r\n            return [true, res[1]];\r\n        }\r\n        else {\r\n            return [false, f(res[1])];\r\n        }\r\n    }\r\n    Result.mapErr = mapErr;\r\n    function andThen(res, f) {\r\n        if (isOk(res)) {\r\n            return f(res[1]);\r\n        }\r\n        else {\r\n            return [false, res[1]];\r\n        }\r\n    }\r\n    Result.andThen = andThen;\r\n})(Result || (Result = {}));\r\n","export class Vec2 {\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    eq(other) {\r\n        return Vec2.eq(this, other);\r\n    }\r\n}\r\n(function (Vec2) {\r\n    function eq(l, r) {\r\n        return l.x === r.x && l.y === r.y;\r\n    }\r\n    Vec2.eq = eq;\r\n    function lerp(pct, begin, end) {\r\n        return new Vec2(begin.x + (end.x - begin.x) * pct, begin.y + (end.y - begin.y) * pct);\r\n    }\r\n    Vec2.lerp = lerp;\r\n    function distance(l, r) {\r\n        const x = r.x - l.x;\r\n        const y = r.y - l.y;\r\n        return Math.sqrt(x * x + y * y);\r\n    }\r\n    Vec2.distance = distance;\r\n})(Vec2 || (Vec2 = {}));\r\n","export class Vec3 {\r\n    constructor(x, y, z) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    eq(other) {\r\n        return Vec3.eq(this, other);\r\n    }\r\n}\r\n(function (Vec3) {\r\n    function eq(l, r) {\r\n        return l.x === r.x && l.y === r.y && l.y === r.y;\r\n    }\r\n    Vec3.eq = eq;\r\n    function lerp(pct, begin, end) {\r\n        return new Vec3(begin.x + (end.x - begin.x) * pct, begin.y + (end.y - begin.y) * pct, begin.z + (end.z - begin.z) * pct);\r\n    }\r\n    Vec3.lerp = lerp;\r\n})(Vec3 || (Vec3 = {}));\r\n","export class Vec4 {\r\n    constructor(x, y, z, w) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        this.w = w;\r\n    }\r\n    eq(other) {\r\n        return Vec4.eq(this, other);\r\n    }\r\n}\r\n(function (Vec4) {\r\n    function fromRgba(rgb, alpha) {\r\n        return new Vec4(rgb.r * alpha, rgb.g * alpha, rgb.b * alpha, alpha);\r\n    }\r\n    Vec4.fromRgba = fromRgba;\r\n    function eq(l, r) {\r\n        return l.x === r.x && l.y === r.y && l.z === r.z && l.w === r.w;\r\n    }\r\n    Vec4.eq = eq;\r\n})(Vec4 || (Vec4 = {}));\r\n","export const FrameStream = {\r\n    make: (fn) => {\r\n        let shouldStop = false;\r\n        window[\"painterStop\"] = () => (shouldStop = true);\r\n        let requestId = requestAnimationFrame(function callback() {\r\n            if (shouldStop)\r\n                return;\r\n            try {\r\n                fn(performance.now());\r\n            }\r\n            catch (e) {\r\n                console.error(e);\r\n            }\r\n            requestId = requestAnimationFrame(callback);\r\n        });\r\n        return () => cancelAnimationFrame(requestId);\r\n    },\r\n};\r\n","export class PerfTracker {\r\n    constructor(args) {\r\n        this.maxSamples = args.maxSamples;\r\n        this.onSamples = args.onSamples;\r\n        this.samples = new Array(args.maxSamples);\r\n        this.nextIdx = 0;\r\n        this.startTimeMs = null;\r\n    }\r\n    start() {\r\n        if (this.startTimeMs !== null) {\r\n            console.error(\"Performance tracker should not already be in use\");\r\n        }\r\n        this.startTimeMs = performance.now();\r\n    }\r\n    end() {\r\n        if (this.startTimeMs === null) {\r\n            console.error(\"Performance tracker should be started\");\r\n        }\r\n        const endMs = performance.now();\r\n        /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\r\n        const startMs = this.startTimeMs;\r\n        this.startTimeMs = null;\r\n        this.samples[this.nextIdx++] = { startMs, endMs };\r\n        if (this.nextIdx === this.maxSamples) {\r\n            this.onSamples(this.samples);\r\n            this.samples = new Array(this.maxSamples);\r\n            this.nextIdx = 0;\r\n        }\r\n    }\r\n}\r\n","export { Store } from \"./store\";\r\nexport { Decode } from \"./decode\";\r\nexport * from \"./tuples\";\r\nexport * from \"./maybe\";\r\nexport * from \"./result\";\r\nexport * from \"./vec2\";\r\nexport * from \"./vec3\";\r\nexport * from \"./vec4\";\r\nexport * from \"./frameStream\";\r\nexport * from \"./perfTracker\";\r\nexport class Lazy {\r\n    constructor(__fn) {\r\n        this.__fn = __fn;\r\n        this.__value = null;\r\n    }\r\n    get value() {\r\n        if (this.__value === null) {\r\n            this.__value = this.__fn();\r\n        }\r\n        return this.__value;\r\n    }\r\n}\r\nexport class SetOnce {\r\n    constructor() {\r\n        this.__value = null;\r\n    }\r\n    set(value) {\r\n        if (this.__value !== null)\r\n            throw \"Attempted to re-set a SetOnce\";\r\n        this.__value = value;\r\n    }\r\n    get value() {\r\n        if (this.__value === null)\r\n            throw \"Attempted to get the value of a SetOnce before it was set\";\r\n        return this.__value;\r\n    }\r\n}\r\nexport function orDefault(value, def) {\r\n    return value !== undefined ? value : def;\r\n}\r\nexport function range(start, end) {\r\n    const length = end - start + 1;\r\n    const arr = new Array(length);\r\n    for (let i = 0; i < length; i++) {\r\n        arr[i] = start + i;\r\n    }\r\n    return arr;\r\n}\r\nexport function distance(x0, y0, x1, y1) {\r\n    const x = x1 - x0;\r\n    const y = y1 - y0;\r\n    return Math.sqrt(x * x + y * y);\r\n}\r\nexport function lerp(pct, start, end) {\r\n    return start + (end - start) * pct;\r\n}\r\nexport function smoothstep(x) {\r\n    return x * x * (3 - x + x);\r\n}\r\nexport function clamp(min, max, n) {\r\n    return n < min ? min : n > max ? max : n;\r\n}\r\nexport function delay(ms) {\r\n    return new Promise(res => {\r\n        setTimeout(res, ms);\r\n    });\r\n}\r\nexport function arrUpdate(array, index, value) {\r\n    const newArr = array.slice();\r\n    newArr.splice(index, 1, value);\r\n    return newArr;\r\n}\r\nexport function arrInsert(array, index, value) {\r\n    const newArr = array.slice();\r\n    newArr.splice(index, 0, value);\r\n    return newArr;\r\n}\r\nexport function arrRemove(array, index) {\r\n    const newArr = array.slice();\r\n    newArr.splice(index, 1);\r\n    return newArr;\r\n}\r\nexport var ColorMode;\r\n(function (ColorMode) {\r\n    ColorMode[ColorMode[\"Hsv\"] = 0] = \"Hsv\";\r\n    ColorMode[ColorMode[\"Hsluv\"] = 1] = \"Hsluv\";\r\n})(ColorMode || (ColorMode = {}));\r\nexport function colorModeToString(type) {\r\n    switch (type) {\r\n        case ColorMode.Hsv:\r\n            return \"Hsv\";\r\n        case ColorMode.Hsluv:\r\n            return \"Hsluv\";\r\n    }\r\n}\r\n","export * from \"./glsl\";\r\nexport function createProgram(gl, vSrc, fSrc) {\r\n    const vShader = compileShader(gl, vSrc, WebGLRenderingContext.VERTEX_SHADER);\r\n    const fShader = compileShader(gl, fSrc, WebGLRenderingContext.FRAGMENT_SHADER);\r\n    if (vShader === null || fShader === null) {\r\n        return null;\r\n    }\r\n    const program = gl.createProgram();\r\n    if (program === null) {\r\n        console.error(\"Failed to create program\");\r\n        return null;\r\n    }\r\n    gl.attachShader(program, vShader);\r\n    gl.attachShader(program, fShader);\r\n    const linkedProgram = linkProgram(gl, program);\r\n    gl.deleteShader(vShader);\r\n    gl.deleteShader(fShader);\r\n    return linkedProgram;\r\n}\r\nfunction compileShader(gl, src, shaderType) {\r\n    const shader = gl.createShader(shaderType);\r\n    if (shader === null) {\r\n        console.error(\"Failed to create shader.\");\r\n        return null;\r\n    }\r\n    gl.shaderSource(shader, src);\r\n    gl.compileShader(shader);\r\n    if (gl.getShaderParameter(shader, WebGLRenderingContext.COMPILE_STATUS))\r\n        return shader;\r\n    console.group(\"Failed to compile shader\");\r\n    console.error(\"shader info log: \", gl.getShaderInfoLog(shader));\r\n    const prettySrc = withNumberedLines(src);\r\n    console.log(prettySrc);\r\n    console.groupEnd();\r\n    gl.deleteShader(shader);\r\n    return null;\r\n}\r\nfunction linkProgram(gl, program) {\r\n    gl.linkProgram(program);\r\n    if (program !== null || gl.getProgramParameter(program, WebGLRenderingContext.LINK_STATUS))\r\n        return program;\r\n    console.group(\"Failed to link program\");\r\n    console.error(\"error: \", gl.getError());\r\n    console.log(\"validate status: \", gl.getProgramParameter(program, WebGLRenderingContext.VALIDATE_STATUS));\r\n    console.log(\"program info log: \", gl.getProgramInfoLog(program));\r\n    console.groupEnd();\r\n    gl.deleteProgram(program);\r\n    return null;\r\n}\r\nfunction withNumberedLines(src) {\r\n    const lines = src.split(\"\\n\");\r\n    const lineNumberLength = lines.length.toString().length;\r\n    return lines\r\n        .map((line, index) => padStart(index.toString(10), lineNumberLength, \"0\") + \"| \" + line)\r\n        .join(\"\\n\");\r\n}\r\nfunction padStart(text, length, fillChar) {\r\n    const padCount = length - text.length;\r\n    if (padCount <= 0)\r\n        return text;\r\n    const pad = [];\r\n    for (let i = 0; i < padCount; i++)\r\n        pad.push(fillChar);\r\n    pad.push(text);\r\n    return pad.join(\"\");\r\n}\r\nexport var UniformType;\r\n(function (UniformType) {\r\n    UniformType[UniformType[\"I1\"] = 0] = \"I1\";\r\n    UniformType[UniformType[\"F1\"] = 1] = \"F1\";\r\n    UniformType[UniformType[\"F2\"] = 2] = \"F2\";\r\n    UniformType[UniformType[\"F3\"] = 3] = \"F3\";\r\n    UniformType[UniformType[\"F4\"] = 4] = \"F4\";\r\n})(UniformType || (UniformType = {}));\r\nexport class Uniform {\r\n    constructor(location, type) {\r\n        this.location = location;\r\n        this.type = type;\r\n    }\r\n}\r\nexport function getUniformLocation(gl, program, uniforms) {\r\n    const result = {};\r\n    const notFound = [];\r\n    for (const propName in uniforms) {\r\n        if (!uniforms.hasOwnProperty(propName)) {\r\n            continue;\r\n        }\r\n        const textureLoc = gl.getUniformLocation(program, propName);\r\n        if (textureLoc === null) {\r\n            notFound.push(propName);\r\n        }\r\n        else {\r\n            result[propName] = new Uniform(textureLoc, uniforms[propName]);\r\n        }\r\n    }\r\n    if (notFound.length === 0) {\r\n        return result;\r\n    }\r\n    let msg = \"Failed to find location for uniforms\";\r\n    for (let i = 0; i < notFound.length; i++) {\r\n        msg += \"\\n - \" + notFound[i];\r\n    }\r\n    console.error(msg);\r\n    return null;\r\n}\r\nexport function updateUniforms(gl, uniforms, args) {\r\n    for (const propName in uniforms) {\r\n        if (!args.hasOwnProperty(propName)) {\r\n            continue;\r\n        }\r\n        const uniform = uniforms[propName];\r\n        switch (uniform.type) {\r\n            case UniformType.I1: {\r\n                const arg = args[propName];\r\n                gl.uniform1i(uniform.location, arg);\r\n                break;\r\n            }\r\n            case UniformType.F1: {\r\n                const arg = args[propName];\r\n                gl.uniform1f(uniform.location, arg);\r\n                break;\r\n            }\r\n            case UniformType.F2: {\r\n                const arg = args[propName];\r\n                gl.uniform2f(uniform.location, arg.x, arg.y);\r\n                break;\r\n            }\r\n            case UniformType.F3: {\r\n                const arg = args[propName];\r\n                gl.uniform3f(uniform.location, arg.x, arg.y, arg.z);\r\n                break;\r\n            }\r\n            case UniformType.F4: {\r\n                const arg = args[propName];\r\n                gl.uniform4f(uniform.location, arg.x, arg.y, arg.z, arg.w);\r\n                break;\r\n            }\r\n            default:\r\n                const never = uniform.type;\r\n                throw { \"unexpected type\": uniform };\r\n        }\r\n    }\r\n}\r\n// Not using anything but float current, but this will allow us to easily add other types later\r\nexport var AttribType;\r\n(function (AttribType) {\r\n    AttribType[AttribType[\"Float\"] = 0] = \"Float\";\r\n})(AttribType || (AttribType = {}));\r\nclass AttribInternal {\r\n    constructor(attrib) {\r\n        this.name = attrib.name;\r\n        this.size = attrib.size;\r\n        switch (attrib.type) {\r\n            case AttribType.Float:\r\n                this.glType = WebGLRenderingContext.FLOAT;\r\n                this.bytes = attrib.size * 4;\r\n                break;\r\n            default:\r\n                const never = attrib.type;\r\n                throw { \"Unexpected type on attribute\": attrib };\r\n        }\r\n    }\r\n}\r\nexport class AttributesInfo {\r\n    constructor(attributes) {\r\n        {\r\n            let attributes_ = new Array(attributes.length);\r\n            for (let i = 0; i < attributes.length; i++) {\r\n                const attrib = attributes[i];\r\n                attributes_[i] = new AttribInternal(attrib);\r\n            }\r\n            this.attributes = attributes_;\r\n        }\r\n        {\r\n            let totalSize = 0;\r\n            for (let i = 0; i < this.attributes.length; i++) {\r\n                totalSize += this.attributes[i].size;\r\n            }\r\n            this.size = totalSize;\r\n            this.stride = totalSize * 4;\r\n        }\r\n    }\r\n    bindAttribLocations(gl, program) {\r\n        const { attributes } = this;\r\n        for (let i = 0; i < attributes.length; i++) {\r\n            gl.bindAttribLocation(program, i, attributes[i].name);\r\n        }\r\n    }\r\n    vertexAttrib(gl) {\r\n        const { attributes } = this;\r\n        let sizeOffset = 0;\r\n        for (let i = 0; i < attributes.length; i++) {\r\n            const attrib = attributes[i];\r\n            gl.vertexAttribPointer(i, attrib.size, attrib.glType, false, this.stride, sizeOffset);\r\n            sizeOffset += attrib.bytes;\r\n        }\r\n        for (let i = 0; i < attributes.length; i++) {\r\n            gl.enableVertexAttribArray(i);\r\n        }\r\n    }\r\n    getDrawCount(offset) {\r\n        return offset / this.size;\r\n    }\r\n}\r\nexport var Blend;\r\n(function (Blend) {\r\n    let Mode;\r\n    (function (Mode) {\r\n        Mode[Mode[\"Normal\"] = 0] = \"Normal\";\r\n        Mode[Mode[\"Erase\"] = 1] = \"Erase\";\r\n    })(Mode = Blend.Mode || (Blend.Mode = {}));\r\n    Blend.factorsNormal = {\r\n        sfact: WebGLRenderingContext.ONE,\r\n        dfact: WebGLRenderingContext.ONE_MINUS_SRC_ALPHA,\r\n    };\r\n    Blend.factorsErase = {\r\n        sfact: WebGLRenderingContext.ZERO,\r\n        dfact: WebGLRenderingContext.ONE_MINUS_SRC_ALPHA,\r\n    };\r\n    function getFactors(mode) {\r\n        switch (mode) {\r\n            case Mode.Normal:\r\n                return Blend.factorsNormal;\r\n            case Mode.Erase:\r\n                return Blend.factorsErase;\r\n        }\r\n    }\r\n    Blend.getFactors = getFactors;\r\n})(Blend || (Blend = {}));\r\n","export const DEFINE_TAU = `#ifndef TAU\r\n    #define TAU 6.283185307179586\r\n#endif`;\r\nexport const DEFINE_from_linear = `\r\nfloat from_linear(float c) {\r\n    return c <= 0.0031308 \r\n        ? c * 12.92\r\n        : pow(c * 1.055, 1.0 / 2.4) - 0.055;\r\n}\r\n\r\nvec3 from_linear(vec3 color) {\r\n    return vec3(from_linear(color.x), from_linear(color.y), from_linear(color.z));\r\n}\r\n`;\r\nexport const DEFINE_to_linear = `\r\nfloat to_linear(float c) {\r\n    return c > 0.04045\r\n        ? pow((c + 0.055) / (1.0 + 0.055), 2.4)\r\n        : c / 12.92;\r\n}\r\n\r\nvec3 to_linear(vec3 color) {\r\n    return vec3(to_linear(color.x), to_linear(color.y), to_linear(color.z));\r\n}\r\n`;\r\n// credit: http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl - Sam Hocevar\r\nexport const DEFINE_hsvToRgb = `\r\nvec3 hsvToRgb(in vec3 c) {\r\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}`;\r\n// credit: https://www.shadertoy.com/view/MsS3Wc - Iigo Quiles\r\n// export const DEFINE_hsv2rgb = `vec3 hsv2rgb(in vec3 c) {\r\n//     vec3 rgb = clamp(abs(mod(c.x * 6.0 + vec3(0.0, 4.0, 2.0), 6.0) - 3.0) - 1.0, 0.0, 1.0);\r\n//     rgb = rgb * rgb * (3.0 - 2.0 * rgb);\r\n//     return c.z * mix(vec3(1.0), rgb, c.y);\r\n// }`\r\n/*\r\n    credit: https://github.com/williammalo/hsluv-glsl\r\n*/\r\nexport const DEFINE_hsluv_etc = `\r\nvec3 hsluv_intersectLineLine(vec3 line1x, vec3 line1y, vec3 line2x, vec3 line2y) {\r\n    return (line1y - line2y) / (line2x - line1x);\r\n}\r\n\r\nvec3 hsluv_distanceFromPole(vec3 pointx,vec3 pointy) {\r\n    return sqrt(pointx*pointx + pointy*pointy);\r\n}\r\n\r\nvec3 hsluv_lengthOfRayUntilIntersect(float theta, vec3 x, vec3 y) {\r\n    vec3 len = y / (sin(theta) - x * cos(theta));\r\n    if (len.r < 0.0) {len.r=1000.0;}\r\n    if (len.g < 0.0) {len.g=1000.0;}\r\n    if (len.b < 0.0) {len.b=1000.0;}\r\n    return len;\r\n}\r\n\r\nfloat hsluv_maxSafeChromaForL(float L){\r\n    mat3 m2 = mat3(\r\n         3.2409699419045214  ,-0.96924363628087983 , 0.055630079696993609,\r\n        -1.5373831775700935  , 1.8759675015077207  ,-0.20397695888897657 ,\r\n        -0.49861076029300328 , 0.041555057407175613, 1.0569715142428786  \r\n    );\r\n    float sub0 = L + 16.0;\r\n    float sub1 = sub0 * sub0 * sub0 * .000000641;\r\n    float sub2 = sub1 > 0.0088564516790356308 ? sub1 : L / 903.2962962962963;\r\n\r\n    vec3 top1   = (284517.0 * m2[0] - 94839.0  * m2[2]) * sub2;\r\n    vec3 bottom = (632260.0 * m2[2] - 126452.0 * m2[1]) * sub2;\r\n    vec3 top2   = (838422.0 * m2[2] + 769860.0 * m2[1] + 731718.0 * m2[0]) * L * sub2;\r\n\r\n    vec3 bounds0x = top1 / bottom;\r\n    vec3 bounds0y = top2 / bottom;\r\n\r\n    vec3 bounds1x =              top1 / (bottom+126452.0);\r\n    vec3 bounds1y = (top2-769860.0*L) / (bottom+126452.0);\r\n\r\n    vec3 xs0 = hsluv_intersectLineLine(bounds0x, bounds0y, -1.0/bounds0x, vec3(0.0) );\r\n    vec3 xs1 = hsluv_intersectLineLine(bounds1x, bounds1y, -1.0/bounds1x, vec3(0.0) );\r\n\r\n    vec3 lengths0 = hsluv_distanceFromPole( xs0, bounds0y + xs0 * bounds0x );\r\n    vec3 lengths1 = hsluv_distanceFromPole( xs1, bounds1y + xs1 * bounds1x );\r\n\r\n    return  min(lengths0.r,\r\n            min(lengths1.r,\r\n            min(lengths0.g,\r\n            min(lengths1.g,\r\n            min(lengths0.b,\r\n                lengths1.b)))));\r\n}\r\n\r\nfloat hsluv_maxChromaForLH(float L, float H) {\r\n\r\n    float hrad = radians(H);\r\n\r\n    mat3 m2 = mat3(\r\n         3.2409699419045214  ,-0.96924363628087983 , 0.055630079696993609,\r\n        -1.5373831775700935  , 1.8759675015077207  ,-0.20397695888897657 ,\r\n        -0.49861076029300328 , 0.041555057407175613, 1.0569715142428786  \r\n    );\r\n    float sub1 = pow(L + 16.0, 3.0) / 1560896.0;\r\n    float sub2 = sub1 > 0.0088564516790356308 ? sub1 : L / 903.2962962962963;\r\n\r\n    vec3 top1   = (284517.0 * m2[0] - 94839.0  * m2[2]) * sub2;\r\n    vec3 bottom = (632260.0 * m2[2] - 126452.0 * m2[1]) * sub2;\r\n    vec3 top2   = (838422.0 * m2[2] + 769860.0 * m2[1] + 731718.0 * m2[0]) * L * sub2;\r\n\r\n    vec3 bound0x = top1 / bottom;\r\n    vec3 bound0y = top2 / bottom;\r\n\r\n    vec3 bound1x =              top1 / (bottom+126452.0);\r\n    vec3 bound1y = (top2-769860.0*L) / (bottom+126452.0);\r\n\r\n    vec3 lengths0 = hsluv_lengthOfRayUntilIntersect(hrad, bound0x, bound0y );\r\n    vec3 lengths1 = hsluv_lengthOfRayUntilIntersect(hrad, bound1x, bound1y );\r\n\r\n    return  min(lengths0.r,\r\n            min(lengths1.r,\r\n            min(lengths0.g,\r\n            min(lengths1.g,\r\n            min(lengths0.b,\r\n                lengths1.b)))));\r\n}\r\n\r\nfloat hsluv_fromLinear(float c) {\r\n    return c <= 0.0031308 ? 12.92 * c : 1.055 * pow(c, 1.0 / 2.4) - 0.055;\r\n}\r\nvec3 hsluv_fromLinear(vec3 c) {\r\n    return vec3( hsluv_fromLinear(c.r), hsluv_fromLinear(c.g), hsluv_fromLinear(c.b) );\r\n}\r\n\r\nfloat hsluv_toLinear(float c) {\r\n    return c > 0.04045 ? pow((c + 0.055) / (1.0 + 0.055), 2.4) : c / 12.92;\r\n}\r\n\r\nvec3 hsluv_toLinear(vec3 c) {\r\n    return vec3( hsluv_toLinear(c.r), hsluv_toLinear(c.g), hsluv_toLinear(c.b) );\r\n}\r\n\r\nfloat hsluv_yToL(float Y){\r\n    return Y <= 0.0088564516790356308 ? Y * 903.2962962962963 : 116.0 * pow(Y, 1.0 / 3.0) - 16.0;\r\n}\r\n\r\nfloat hsluv_lToY(float L) {\r\n    return L <= 8.0 ? L / 903.2962962962963 : pow((L + 16.0) / 116.0, 3.0);\r\n}\r\n\r\nvec3 xyzToRgb(vec3 tuple) {\r\n    const mat3 m = mat3( \r\n        3.2409699419045214  ,-1.5373831775700935 ,-0.49861076029300328 ,\r\n       -0.96924363628087983 , 1.8759675015077207 , 0.041555057407175613,\r\n        0.055630079696993609,-0.20397695888897657, 1.0569715142428786  );\r\n    \r\n    return hsluv_fromLinear(tuple*m);\r\n}\r\n\r\nvec3 rgbToXyz(vec3 tuple) {\r\n    const mat3 m = mat3(\r\n        0.41239079926595948 , 0.35758433938387796, 0.18048078840183429 ,\r\n        0.21263900587151036 , 0.71516867876775593, 0.072192315360733715,\r\n        0.019330818715591851, 0.11919477979462599, 0.95053215224966058 \r\n    );\r\n    return hsluv_toLinear(tuple) * m;\r\n}\r\n\r\nvec3 xyzToLuv(vec3 tuple){\r\n    float X = tuple.x;\r\n    float Y = tuple.y;\r\n    float Z = tuple.z;\r\n\r\n    float L = hsluv_yToL(Y);\r\n    \r\n    float div = 1./dot(tuple,vec3(1,15,3)); \r\n\r\n    return vec3(\r\n        1.,\r\n        (52. * (X*div) - 2.57179),\r\n        (117.* (Y*div) - 6.08816)\r\n    ) * L;\r\n}\r\n\r\n\r\nvec3 luvToXyz(vec3 tuple) {\r\n    float L = tuple.x;\r\n\r\n    float U = tuple.y / (13.0 * L) + 0.19783000664283681;\r\n    float V = tuple.z / (13.0 * L) + 0.468319994938791;\r\n\r\n    float Y = hsluv_lToY(L);\r\n    float X = 2.25 * U * Y / V;\r\n    float Z = (3./V - 5.)*Y - (X/3.);\r\n\r\n    return vec3(X, Y, Z);\r\n}\r\n\r\nvec3 luvToLch(vec3 tuple) {\r\n    float L = tuple.x;\r\n    float U = tuple.y;\r\n    float V = tuple.z;\r\n\r\n    float C = length(tuple.yz);\r\n    float H = degrees(atan(V,U));\r\n    if (H < 0.0) {\r\n        H = 360.0 + H;\r\n    }\r\n    \r\n    return vec3(L, C, H);\r\n}\r\n\r\nvec3 lchToLuv(vec3 tuple) {\r\n    float hrad = radians(tuple.b);\r\n    return vec3(\r\n        tuple.r,\r\n        cos(hrad) * tuple.g,\r\n        sin(hrad) * tuple.g\r\n    );\r\n}\r\n\r\nvec3 hsluvToLch(vec3 tuple) {\r\n    tuple.g *= hsluv_maxChromaForLH(tuple.b, tuple.r) * .01;\r\n    return tuple.bgr;\r\n}\r\n\r\nvec3 lchToHsluv(vec3 tuple) {\r\n    tuple.g /= hsluv_maxChromaForLH(tuple.r, tuple.b) * .01;\r\n    return tuple.bgr;\r\n}\r\n\r\nvec3 hpluvToLch(vec3 tuple) {\r\n    tuple.g *= hsluv_maxSafeChromaForL(tuple.b) * .01;\r\n    return tuple.bgr;\r\n}\r\n\r\nvec3 lchToHpluv(vec3 tuple) {\r\n    tuple.g /= hsluv_maxSafeChromaForL(tuple.r) * .01;\r\n    return tuple.bgr;\r\n}\r\n\r\nvec3 lchToRgb(vec3 tuple) {\r\n    return xyzToRgb(luvToXyz(lchToLuv(tuple)));\r\n}\r\n\r\nvec3 rgbToLch(vec3 tuple) {\r\n    return luvToLch(xyzToLuv(rgbToXyz(tuple)));\r\n}\r\n\r\nvec3 hsluvToRgb(vec3 tuple) {\r\n    return lchToRgb(hsluvToLch(tuple));\r\n}\r\n\r\nvec3 rgbToHsluv(vec3 tuple) {\r\n    return lchToHsluv(rgbToLch(tuple));\r\n}\r\n\r\nvec3 hpluvToRgb(vec3 tuple) {\r\n    return lchToRgb(hpluvToLch(tuple));\r\n}\r\n\r\nvec3 rgbToHpluv(vec3 tuple) {\r\n    return lchToHpluv(rgbToLch(tuple));\r\n}\r\n\r\nvec3 luvToRgb(vec3 tuple){\r\n    return xyzToRgb(luvToXyz(tuple));\r\n}\r\n`;\r\n","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","var defineProperty = require(\"./defineProperty\");\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread;","'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nclass Rgb {\r\n    constructor(r, g, b) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n    }\r\n    static fromCss(css) {\r\n        css = css.replace(/[ \\t]/, \"\");\r\n        if (css.startsWith(\"rgb(\"))\r\n            return parseRgbCss(css.substr(4, css.length - 5));\r\n        if (css.startsWith(\"#\")) {\r\n            return parseHexCss(css.substr(1));\r\n        }\r\n        return parseHexCss(css);\r\n    }\r\n    is(other) {\r\n        return this.r === other.r && this.g === other.g && this.b === other.b;\r\n    }\r\n    toRgb() {\r\n        return this;\r\n    }\r\n    with({ r, g, b }) {\r\n        return new Rgb(r !== undefined ? r : this.r, g !== undefined ? g : this.g, b !== undefined ? b : this.b);\r\n    }\r\n    toStyle() {\r\n        return `rgb(${floatToByte(this.r)},${floatToByte(this.g)},${floatToByte(this.b)})`;\r\n    }\r\n    toLinear() {\r\n        return new RgbLinear(toLinear(this.r), toLinear(this.g), toLinear(this.b));\r\n    }\r\n    toString() {\r\n        return \"Rgb(\" + this.r + \", \" + this.g + \", \" + this.b + \")\";\r\n    }\r\n}\r\nclass RgbLinear {\r\n    constructor(r, g, b) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n    }\r\n    is(other) {\r\n        return this.r === other.r && this.g === other.g && this.b === other.b;\r\n    }\r\n    with({ r, g, b, }) {\r\n        return new RgbLinear(r !== undefined ? r : this.r, g !== undefined ? g : this.g, b !== undefined ? b : this.b);\r\n    }\r\n    mix(pct, other) {\r\n        return new RgbLinear(lerp(pct, this.r, other.r), lerp(pct, this.g, other.g), lerp(pct, this.b, other.b));\r\n    }\r\n    lighten(pct) {\r\n        return this.mix(pct, RgbLinear.White);\r\n    }\r\n    darken(pct) {\r\n        return this.mix(pct, RgbLinear.Black);\r\n    }\r\n    fromLinear() {\r\n        return new Rgb(fromLinear(this.r), fromLinear(this.g), fromLinear(this.b));\r\n    }\r\n    toString() {\r\n        return \"LinearRgb(\" + this.r + \", \" + this.g + \", \" + this.b + \")\";\r\n    }\r\n}\r\nRgbLinear.White = new RgbLinear(1, 1, 1);\r\nRgbLinear.Black = new RgbLinear(0, 0, 0);\r\nfunction toLinear(c) {\r\n    return c > 0.04045 ? Math.pow(((c + 0.055) / 1.055), 2.4) : c / 12.92;\r\n}\r\nfunction fromLinear(c) {\r\n    return c <= 0.0031308 ? c * 12.92 : Math.pow(c * 1.055, 1.0 / 2.4) - 0.055;\r\n}\r\nfunction floatToByte(x) {\r\n    return (x * 255.9999999) | 0;\r\n}\r\nfunction validateRgb(r, g, b) {\r\n    if (isNaN(r) || !isFinite(r))\r\n        return null;\r\n    if (isNaN(g) || !isFinite(g))\r\n        return null;\r\n    if (isNaN(b) || !isFinite(b))\r\n        return null;\r\n    return new Rgb(r, g, b);\r\n}\r\nfunction parseRgbCss(css) {\r\n    const vals = css.split(\",\");\r\n    if (vals.length !== 3)\r\n        return null;\r\n    const r = Number.parseFloat(vals[0]) / 255;\r\n    const g = Number.parseFloat(vals[1]) / 255;\r\n    const b = Number.parseFloat(vals[2]) / 255;\r\n    return validateRgb(r, g, b);\r\n}\r\nfunction parseHexCss(css) {\r\n    if (css.length === 3) {\r\n        const r = parseHex(css[0]) / 15;\r\n        const g = parseHex(css[1]) / 15;\r\n        const b = parseHex(css[2]) / 15;\r\n        return validateRgb(r, g, b);\r\n    }\r\n    if (css.length === 6) {\r\n        const r = parseHexPair(css[0], css[1]);\r\n        const g = parseHexPair(css[2], css[3]);\r\n        const b = parseHexPair(css[4], css[5]);\r\n        return validateRgb(r, g, b);\r\n    }\r\n    return null;\r\n}\r\nfunction parseHexPair(l, r) {\r\n    return (parseHex(l) * 16 + parseHex(r)) / 255;\r\n}\r\nfunction parseHex(hex) {\r\n    const lcHex = hex.toLowerCase();\r\n    switch (lcHex) {\r\n        case \"0\":\r\n            return 0;\r\n        case \"1\":\r\n            return 1;\r\n        case \"2\":\r\n            return 2;\r\n        case \"3\":\r\n            return 3;\r\n        case \"4\":\r\n            return 4;\r\n        case \"5\":\r\n            return 5;\r\n        case \"6\":\r\n            return 6;\r\n        case \"7\":\r\n            return 7;\r\n        case \"8\":\r\n            return 8;\r\n        case \"9\":\r\n            return 9;\r\n        case \"a\":\r\n            return 10;\r\n        case \"b\":\r\n            return 11;\r\n        case \"c\":\r\n            return 12;\r\n        case \"d\":\r\n            return 13;\r\n        case \"e\":\r\n            return 14;\r\n        case \"f\":\r\n            return 15;\r\n        default:\r\n            return NaN;\r\n    }\r\n}\r\nfunction lerp(pct, from, to) {\r\n    return from + pct * to;\r\n}\r\n\r\nclass Hsv {\r\n    constructor(h, s, v) {\r\n        this.h = h;\r\n        this.s = s;\r\n        this.v = v;\r\n        this.__cachedRgb = null;\r\n    }\r\n    is(other) {\r\n        return this.h === other.h && this.s === other.s && this.v === other.v;\r\n    }\r\n    toRgb() {\r\n        if (this.__cachedRgb === null) {\r\n            this.__cachedRgb = hsvToRgb(this);\r\n        }\r\n        return this.__cachedRgb;\r\n    }\r\n    toStyle() {\r\n        return this.toRgb().toStyle();\r\n    }\r\n    with({ h, s, v }) {\r\n        return new Hsv(h !== undefined ? h : this.h, s !== undefined ? s : this.s, v !== undefined ? v : this.v);\r\n    }\r\n    toString() {\r\n        return \"Hsv(\" + this.h + \", \" + this.s + \", \" + this.v + \")\";\r\n    }\r\n}\r\nfunction rgbToHsv({ r, g, b }) {\r\n    const maxValue = Math.max(r, g, b);\r\n    const minValue = Math.min(r, g, b);\r\n    const d = maxValue - minValue;\r\n    const s = maxValue === 0 ? 0 : d / maxValue;\r\n    let h;\r\n    switch (maxValue) {\r\n        case minValue:\r\n            h = 0;\r\n            break;\r\n        case r:\r\n            h = (g - b) / d + (g < b ? 6.0 : 0.0);\r\n            break;\r\n        case g:\r\n            h = (b - r) / d + 2.0;\r\n            break;\r\n        default:\r\n            h = (r - g) / d + 4.0;\r\n            break;\r\n    }\r\n    return new Hsv(h / 6, s, maxValue);\r\n}\r\nfunction hsvToRgb({ h, s, v }) {\r\n    const i = (h * 6) | 0;\r\n    const f = h * 6 - i;\r\n    const p = v * (1 - s);\r\n    const q = v * (1 - f * s);\r\n    const t = v * (1 - (1 - f) * s);\r\n    let r;\r\n    let g;\r\n    let b;\r\n    switch (i % 6) {\r\n        case 0:\r\n            r = v;\r\n            g = t;\r\n            b = p;\r\n            break;\r\n        case 1:\r\n            r = q;\r\n            g = v;\r\n            b = p;\r\n            break;\r\n        case 2:\r\n            r = p;\r\n            g = v;\r\n            b = t;\r\n            break;\r\n        case 3:\r\n            r = p;\r\n            g = q;\r\n            b = v;\r\n            break;\r\n        case 4:\r\n            r = t;\r\n            g = p;\r\n            b = v;\r\n            break;\r\n        default:\r\n            r = v;\r\n            g = p;\r\n            b = q;\r\n            break;\r\n    }\r\n    return new Rgb(r, g, b);\r\n}\r\n\r\n/* Hsluv vs Hsl:\r\n    http://www.hsluv.org/comparison/\r\n\r\n    Implementation based on:\r\n   https://github.com/dvdplm/rust-hsluv/blob/master/src/lib.rs\r\n   https://github.com/hsluv/hsluv-csharp/blob/master/Hsluv/Hsluv.cs\r\n\r\n   TODO: Consider having all the transformation functions taking a mutable vector as input and modifying it, rather than creating a new one.\r\n\r\n   the pure transformation functions can be implemented on top of these efficient impure functions\r\n\r\n   it would be a loss in performance for one-step transformations like rgb -> rgbLinear\r\n   but it would be a performance gain for multi-step transformations such as rgb -> hsluv\r\n*/\r\nclass Vec2 {\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\nclass Vec3 {\r\n    constructor(x, y, z) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n}\r\nclass Luv {\r\n    constructor(l, u, v) {\r\n        this.l = l;\r\n        this.u = u;\r\n        this.v = v;\r\n    }\r\n}\r\nclass Hsluv {\r\n    constructor(h, s, l) {\r\n        this.h = h;\r\n        this.s = s;\r\n        this.l = l;\r\n        this.__cachedRgb = null;\r\n    }\r\n    is(other) {\r\n        return this.h === other.h && this.s === other.s && this.l === other.l;\r\n    }\r\n    with({ h, s, l }) {\r\n        return new Hsluv(h !== undefined ? h : this.h, s !== undefined ? s : this.s, l !== undefined ? l : this.l);\r\n    }\r\n    toRgb() {\r\n        if (this.__cachedRgb === null) {\r\n            this.__cachedRgb = hsluvToRgb(this);\r\n        }\r\n        return this.__cachedRgb;\r\n    }\r\n    toStyle() {\r\n        const style = this.toRgb().toStyle();\r\n        return style;\r\n    }\r\n    toString() {\r\n        return \"Hsluv(\" + this.h + \", \" + this.s + \", \" + this.l + \")\";\r\n    }\r\n}\r\nclass Hpluv {\r\n    constructor(h, p, l) {\r\n        this.h = h;\r\n        this.p = p;\r\n        this.l = l;\r\n        this.__cachedRgb = null;\r\n    }\r\n    is(other) {\r\n        return this.h === other.h && this.p === other.p && this.l === other.l;\r\n    }\r\n    with({ h, p, l }) {\r\n        return new Hpluv(h !== undefined ? h : this.h, p !== undefined ? p : this.p, l !== undefined ? l : this.l);\r\n    }\r\n    toRgb() {\r\n        if (this.__cachedRgb === null) {\r\n            this.__cachedRgb = hpluvToRgb(this);\r\n        }\r\n        return this.__cachedRgb;\r\n    }\r\n    toStyle() {\r\n        return this.toRgb().toStyle();\r\n    }\r\n    toString() {\r\n        return \"Hsv(\" + this.h + \", \" + this.p + \", \" + this.l + \")\";\r\n    }\r\n}\r\nclass Lch {\r\n    constructor(l, c, h) {\r\n        this.l = l;\r\n        this.c = c;\r\n        this.h = h;\r\n    }\r\n}\r\nclass Xyz {\r\n    constructor(x, y, z) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n}\r\n/*\r\n    m =\r\n        [ 3.240969941904521, -1.537383177570093, -0.498610760293\r\n        , -0.96924363628087, 1.87596750150772, 0.041555057407175\r\n        , 0.055630079696993, -0.20397695888897, 1.056971514242878\r\n        ]\r\n\r\n    mInv =\r\n        [ 0.41239079926595, 0.35758433938387, 0.18048078840183\r\n        , 0.21263900587151, 0.71516867876775, 0.072192315360733\r\n        , 0.019330818715591, 0.11919477979462, 0.95053215224966\r\n        ]\r\n*/\r\nconst m = [\r\n    new Vec3(3.240969941904521, -1.537383177570093, -0.498610760293),\r\n    new Vec3(-0.96924363628087, 1.87596750150772, 0.041555057407175),\r\n    new Vec3(0.055630079696993, -0.20397695888897, 1.056971514242878),\r\n];\r\nconst mInv = [\r\n    new Vec3(0.41239079926595, 0.35758433938387, 0.18048078840183),\r\n    new Vec3(0.21263900587151, 0.71516867876775, 0.072192315360733),\r\n    new Vec3(0.019330818715591, 0.11919477979462, 0.95053215224966),\r\n];\r\nconst refY = 1.0;\r\nconst refU = 0.19783000664283;\r\nconst refV = 0.46831999493879;\r\nconst kappa = 903.2962962;\r\nconst epsilon = 0.0088564516;\r\nfunction degreesToRadians(deg) {\r\n    return (deg * Math.PI) / 180.0;\r\n}\r\nfunction radiansToDegrees(rad) {\r\n    return (rad * 180.0) / Math.PI;\r\n}\r\nfunction lengthOfRayUntilIntersect(theta, vec) {\r\n    const length = vec.y / (Math.sin(theta) - vec.x * Math.cos(theta));\r\n    if (length < 0.0) {\r\n        return -0.0001;\r\n    }\r\n    else {\r\n        return length;\r\n    }\r\n}\r\nfunction getBounds(l) {\r\n    const sub1 = Math.pow((l + 16), 3) / 1560896;\r\n    const sub2 = sub1 > epsilon ? sub1 : l / kappa;\r\n    const bounds = new Array(3 * 2);\r\n    // TODO: unwrap loop\r\n    // can I also inline the matrix's values?\r\n    for (let c = 0; c < 3; c++) {\r\n        const m1 = m[c].x;\r\n        const m2 = m[c].y;\r\n        const m3 = m[c].z;\r\n        for (let t = 0; t < 2; t++) {\r\n            const top1 = (284517 * m1 - 94839 * m3) * sub2;\r\n            const top2 = (838422 * m3 + 769860 * m2 + 731718 * m1) * l * sub2 - 769860 * t * l;\r\n            const bottom = (632260 * m3 - 126452 * m2) * sub2 + 126452 * t;\r\n            bounds[c * 2 + t] = new Vec2(top1 / bottom, top2 / bottom);\r\n        }\r\n    }\r\n    return bounds;\r\n}\r\nfunction distance(x, y) {\r\n    return Math.sqrt(x * x + y * y);\r\n}\r\nfunction intersectLineLine(vec1, vec2) {\r\n    return (vec1.y - vec2.y) / (vec2.x - vec1.x);\r\n}\r\nfunction maxSafeChromaForL(l) {\r\n    const bounds = getBounds(l);\r\n    let min = Number.MAX_VALUE;\r\n    for (let i = 0; i < 2; ++i) {\r\n        const line = bounds[i];\r\n        // TODO: inline\r\n        const x = intersectLineLine(line, new Vec2(-1 / line.x, 0));\r\n        const length = distance(x, line.y + x * line.x);\r\n        if (length < min)\r\n            min = length;\r\n    }\r\n    return min;\r\n}\r\nfunction maxChromaForLH(l, h) {\r\n    const hrad = (h / 360.0) * Math.PI * 2.0;\r\n    const bounds = getBounds(l);\r\n    let min = Number.MAX_VALUE;\r\n    for (let i = 0; i < bounds.length; i++) {\r\n        // TODO: inline\r\n        const length = lengthOfRayUntilIntersect(hrad, bounds[i]);\r\n        if (length >= 0 && length < min)\r\n            min = length;\r\n    }\r\n    return min;\r\n}\r\nfunction funF(t) {\r\n    if (t > epsilon) {\r\n        return 116 * Math.pow((t / refY), (1 / 3)) - 16;\r\n    }\r\n    else {\r\n        return (t / refY) * kappa;\r\n    }\r\n}\r\nfunction funFInv(t) {\r\n    if (t > 8.0) {\r\n        return Math.pow((refY * ((t + 16.0) / 116.0)), 3.0);\r\n    }\r\n    else {\r\n        return (refY * t) / kappa;\r\n    }\r\n}\r\nfunction fromLinear$1(c) {\r\n    if (c <= 0.0031308) {\r\n        return 12.92 * c;\r\n    }\r\n    else {\r\n        return 1.055 * Math.pow(c, (1.0 / 2.4)) - 0.055;\r\n    }\r\n}\r\nfunction luvToLch({ l, u, v }) {\r\n    const c = distance(u, v);\r\n    if (c < 0.00000001) {\r\n        return new Lch(l, c, 0);\r\n    }\r\n    const h = radiansToDegrees(Math.atan2(v, u));\r\n    if (h < 0.0) {\r\n        return new Lch(l, c, h + 360);\r\n    }\r\n    else {\r\n        return new Lch(l, c, h);\r\n    }\r\n}\r\nfunction lchToLuv({ l, c, h }) {\r\n    const hrad = degreesToRadians(h);\r\n    const u = Math.cos(hrad) * c;\r\n    const v = Math.sin(hrad) * c;\r\n    return new Luv(l, u, v);\r\n}\r\nfunction mat3map(fn, mat) {\r\n    return [fn(mat[0]), fn(mat[1]), fn(mat[2])];\r\n}\r\nfunction rgbToXyz(rgb) {\r\n    const lrgb = rgb.toLinear();\r\n    // todo: unwrap map\r\n    const xyz = mat3map(vec => lrgb.r * vec.x + lrgb.g * vec.y + lrgb.b * vec.z, mInv);\r\n    return new Xyz(xyz[0], xyz[1], xyz[2]);\r\n}\r\nfunction xyzToRgb(xyz) {\r\n    // todo: unwrap map\r\n    const rgb = mat3map(vec => fromLinear$1(xyz.x * vec.x + xyz.y * vec.y + xyz.z * vec.z), m);\r\n    return new Rgb(rgb[0], rgb[1], rgb[2]);\r\n}\r\nfunction lchToHsluv({ l, c, h }) {\r\n    if (l > 99.9999999) {\r\n        return new Hsluv(h, 0, 100);\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Hsluv(h, 0, 0);\r\n    }\r\n    const mx = maxChromaForLH(l, h);\r\n    const s = (c / mx) * 100;\r\n    return new Hsluv(h, s, l);\r\n}\r\nfunction hsluvToLch({ h, s, l }) {\r\n    if (l > 99.9999999) {\r\n        return new Lch(100, 0.0, h);\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Lch(0, 0, h);\r\n    }\r\n    const mx = maxChromaForLH(l, h);\r\n    const c = (mx / 100) * s;\r\n    return new Lch(l, c, h);\r\n}\r\nfunction lchToHpluv({ l, c, h }) {\r\n    if (l > 99.9999999) {\r\n        return new Hpluv(h, 0, 100);\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Hpluv(h, 0, 0);\r\n    }\r\n    const mx = maxSafeChromaForL(l);\r\n    const p = (c / mx) * 100;\r\n    return new Hpluv(h, p, l);\r\n}\r\nfunction hpluvToLch({ h, p, l }) {\r\n    if (l > 99.9999999) {\r\n        return new Lch(100, 0, h);\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Lch(0, 0, h);\r\n    }\r\n    const mx = maxSafeChromaForL(l);\r\n    const c = (mx / 100) * p;\r\n    return new Lch(l, c, h);\r\n}\r\nfunction luvToRgb(luv) {\r\n    return xyzToRgb(luvToXyz(luv));\r\n}\r\nfunction rgbToLch(rgb) {\r\n    return luvToLch(xyzToLuv(rgbToXyz(rgb)));\r\n}\r\nfunction lchToRgb(lch) {\r\n    return xyzToRgb(luvToXyz(lchToLuv(lch)));\r\n}\r\nfunction rgbToHsluv(rgb) {\r\n    return lchToHsluv(rgbToLch(rgb));\r\n}\r\nfunction hsluvToRgb(hsluv) {\r\n    return lchToRgb(hsluvToLch(hsluv));\r\n}\r\nfunction rgbToHpluv(rgb) {\r\n    return lchToHpluv(rgbToLch(rgb));\r\n}\r\nfunction hpluvToRgb(hpluv) {\r\n    return lchToRgb(hpluvToLch(hpluv));\r\n}\r\nfunction xyzToLuv({ x, y, z }) {\r\n    if (x === 0 && y === 0 && z === 0) {\r\n        return new Luv(0, 0, 0);\r\n    }\r\n    const l = funF(y);\r\n    if (l === 0) {\r\n        return new Luv(0, 0, 0);\r\n    }\r\n    const u = 13 * l * ((4 * x) / (x + 15 * y + 3 * z) - refU);\r\n    const v = 13 * l * ((9 * y) / (x + 15 * y + 3 * z) - refV);\r\n    return new Luv(l, u, v);\r\n}\r\nfunction luvToXyz({ l, u, v }) {\r\n    if (l === 0) {\r\n        return new Xyz(0, 0, 0);\r\n    }\r\n    const initU = u / (13 * l) + refU;\r\n    const initV = v / (13 * l) + refV;\r\n    const y = funFInv(l) * refY;\r\n    const x = 0 - (9 * y * initU) / ((initU - 4) * initV - initU * initV);\r\n    const z = (9 * y - 15 * initV * y - initV * x) / (3 * initV);\r\n    return new Xyz(x, y, z);\r\n}\r\nfunction toGray({ r, g, b }) {\r\n    const gray = Math.sqrt(0.299 * r * r + 0.587 * g * g + 0.114 * b * b);\r\n    return new Rgb(gray, gray, gray);\r\n}\r\n\r\nexports.Rgb = Rgb;\r\nexports.RgbLinear = RgbLinear;\r\nexports.Hsv = Hsv;\r\nexports.rgbToHsv = rgbToHsv;\r\nexports.hsvToRgb = hsvToRgb;\r\nexports.Luv = Luv;\r\nexports.Hsluv = Hsluv;\r\nexports.Hpluv = Hpluv;\r\nexports.Lch = Lch;\r\nexports.Xyz = Xyz;\r\nexports.luvToLch = luvToLch;\r\nexports.lchToLuv = lchToLuv;\r\nexports.rgbToXyz = rgbToXyz;\r\nexports.xyzToRgb = xyzToRgb;\r\nexports.lchToHsluv = lchToHsluv;\r\nexports.hsluvToLch = hsluvToLch;\r\nexports.lchToHpluv = lchToHpluv;\r\nexports.hpluvToLch = hpluvToLch;\r\nexports.luvToRgb = luvToRgb;\r\nexports.rgbToLch = rgbToLch;\r\nexports.lchToRgb = lchToRgb;\r\nexports.rgbToHsluv = rgbToHsluv;\r\nexports.hsluvToRgb = hsluvToRgb;\r\nexports.rgbToHpluv = rgbToHpluv;\r\nexports.hpluvToRgb = hpluvToRgb;\r\nexports.xyzToLuv = xyzToLuv;\r\nexports.luvToXyz = luvToXyz;\r\nexports.toGray = toGray;\r\n//# sourceMappingURL=index.js.map\r\n","/**\n * Shortcut for an `undefined` value.\n */\nexport const _ = void 0;\n//# sourceMappingURL=shortcuts.js.map","/**\n * Shortcuts for DOM methods and properties are used to reduce megamorphic callsites in the codebase.\n *\n * In many synthetic microbenchmarks it is most likely will be slower, unless synthetic benchmark is implemented with\n * many different html/svg elements. But it is definitely should make it faster in complex real applications.\n *\n * Since Chrome 74, issue with native accessors is finally fixed: https://bugs.chromium.org/p/v8/issues/detail?id=8820\n */\n/**\n * `Object.getOwnPropertyDescriptor(o, p)`\n *\n * @param o Object.\n * @param p Property name.\n * @returns Property Descriptor.\n */\nconst getDescriptor = (o, p) => Object.getOwnPropertyDescriptor(o, p);\nconst nodeProto = process.env.IVI_TARGET === \"ssr\" ? void 0 : Node.prototype;\nconst elementProto = process.env.IVI_TARGET === \"ssr\" ? void 0 : Element.prototype;\n/**\n * Shortcut for a `Document`.\n */\nexport const doc = (process.env.IVI_TARGET === \"ssr\" ? void 0 : document);\n/**\n * Shortcut for an `Object.prototype.hasOwnProperty`.\n */\nexport const objectHasOwnProperty = Object.prototype.hasOwnProperty;\n/**\n * Shortcut for a `Node.prototype.insertBefore`.\n */\nexport const nodeInsertBefore = process.env.IVI_TARGET === \"ssr\" ? void 0 : nodeProto.insertBefore;\n/**\n * Shortcut for a `Node.prototype.removeChild`.\n */\nexport const nodeRemoveChild = process.env.IVI_TARGET === \"ssr\" ? void 0 : nodeProto.removeChild;\n/**\n * Shortcut for a `Node.prototype.replaceChild`.\n */\nexport const nodeReplaceChild = process.env.IVI_TARGET === \"ssr\" ? void 0 : nodeProto.replaceChild;\n/**\n * Shortcut for a `Node.prototype.cloneNode`.\n */\nexport const nodeCloneNode = process.env.IVI_TARGET === \"ssr\" ? void 0 : nodeProto.cloneNode;\n/**\n * Shortcut for an `Element.prototype.setAttribute`.\n */\nexport const elementSetAttribute = process.env.IVI_TARGET === \"ssr\" ? void 0 : elementProto.setAttribute;\n/**\n * Shortcut for an `Element.prototype.setAttributeNS`.\n */\nexport const elementSetAttributeNS = process.env.IVI_TARGET === \"ssr\" ? void 0 : elementProto.setAttributeNS;\n/**\n * Shortcut for an `Element.prototype.removeAttribute`.\n */\nexport const elementRemoveAttribute = process.env.IVI_TARGET === \"ssr\" ? void 0 : elementProto.removeAttribute;\n/**\n * Shortcut for a `Node.textContent = value`.\n */\nexport const nodeSetTextContent = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    getDescriptor(nodeProto, \"textContent\").set);\n/**\n * Shortcut for an `Element.className = value`.\n */\nexport const elementSetClassName = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    getDescriptor(elementProto, \"className\").set);\n/**\n * Shortcut for a `HTMLElement.style`.\n */\nexport const htmlElementGetStyle = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    getDescriptor(HTMLElement.prototype, \"style\").get);\n/**\n * Shortcut for a `SVGElement.style`.\n */\nexport const svgElementGetStyle = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    getDescriptor(SVGElement.prototype, \"style\").get);\n//# sourceMappingURL=shortcuts.js.map","import { _ } from \"ivi\";\r\nimport { div, p } from \"ivi-html\";\r\nimport * as styles from \"./labeled.scss\";\r\nexport function Labeled({ label, value, children }) {\r\n    return div(styles.container, _, [\r\n        div(styles.textContainer, _, [p(styles.label, _, label), p(styles.label, _, value || \"\")]),\r\n        div(styles.content, _, children),\r\n    ]);\r\n}\r\n","import { box, component, Ref, onMouseDown, Events, invalidate, useEffect, findDOMNode, _, } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./slider.scss\";\r\nfunction clamp(x, min, max) {\r\n    return x < min ? min : x > max ? max : x;\r\n}\r\nfunction noOp() { }\r\nexport const Slider = component(c => {\r\n    let containerRef = box(null);\r\n    let isDown = false;\r\n    let handler = noOp;\r\n    function signal(ev) {\r\n        const bounds = findDOMNode(containerRef).getBoundingClientRect();\r\n        const Rem = 16;\r\n        const dotWidth = Rem * 0.75;\r\n        const width = bounds.width - dotWidth;\r\n        const localX = clamp(ev.clientX - bounds.left - dotWidth / 2, 0, width);\r\n        handler(localX / width);\r\n    }\r\n    function onDown(ev) {\r\n        signal(ev);\r\n        isDown = true;\r\n        invalidate(c);\r\n    }\r\n    function onUp() {\r\n        isDown = false;\r\n        invalidate(c);\r\n    }\r\n    function onMove(ev) {\r\n        if (isDown) {\r\n            signal(ev);\r\n        }\r\n    }\r\n    const listenToMouse = useEffect(c, () => {\r\n        document.body.addEventListener(\"mouseup\", onUp, { passive: true });\r\n        document.body.addEventListener(\"mousemove\", onMove, {\r\n            passive: true,\r\n        });\r\n        return () => {\r\n            document.body.removeEventListener(\"mouseup\", onUp);\r\n            document.body.removeEventListener(\"mousemove\", onMove);\r\n        };\r\n    });\r\n    return props => {\r\n        handler = props.onChange;\r\n        listenToMouse();\r\n        const color = props.color !== undefined ? props.color.toStyle() : undefined;\r\n        const percentage = Math.max(0, Math.min(1, props.percentage));\r\n        //\r\n        return Events(onMouseDown(onDown), Ref(containerRef, div(styles.container, _, [\r\n            div(_, _, [\r\n                div(percentage === 0 ? styles.emptyButton : styles.button, {\r\n                    style: {\r\n                        left: \"calc(\" + percentage + \" * calc(100% - 0.75rem))\",\r\n                        \"background-color\": color,\r\n                    },\r\n                }),\r\n                div(styles.filledLineClass, {\r\n                    style: {\r\n                        width: percentage * 100 + \"%\",\r\n                        \"background-color\": color,\r\n                    },\r\n                }),\r\n                div(styles.baseLine),\r\n            ]),\r\n        ])));\r\n    };\r\n});\r\n","import { Vec2 } from \"../util\";\r\nexport var MsgType;\r\n(function (MsgType) {\r\n    MsgType[MsgType[\"SetZoomMsg\"] = 0] = \"SetZoomMsg\";\r\n    MsgType[MsgType[\"SetOffsetMsg\"] = 1] = \"SetOffsetMsg\";\r\n    MsgType[MsgType[\"SetRotationMsg\"] = 2] = \"SetRotationMsg\";\r\n})(MsgType || (MsgType = {}));\r\nclass SetZoomMsg {\r\n    constructor(zoomPct) {\r\n        this.zoomPct = zoomPct;\r\n        this.type = MsgType.SetZoomMsg;\r\n    }\r\n}\r\nclass SetOffsetMsg {\r\n    constructor(offsetPx) {\r\n        this.offsetPx = offsetPx;\r\n        this.type = MsgType.SetOffsetMsg;\r\n    }\r\n}\r\nclass SetRotationMsg {\r\n    constructor(rotationRad) {\r\n        this.rotationRad = rotationRad;\r\n        this.type = MsgType.SetRotationMsg;\r\n    }\r\n}\r\nexport function init() {\r\n    return {\r\n        zoomPct: 1,\r\n        offsetPx: new Vec2(0, 0),\r\n        rotationRad: 0,\r\n    };\r\n}\r\nexport function update(state, msg) {\r\n    switch (msg.type) {\r\n        case MsgType.SetZoomMsg:\r\n            return { ...state, zoomPct: msg.zoomPct };\r\n        case MsgType.SetOffsetMsg:\r\n            return { ...state, offsetPx: msg.offsetPx };\r\n        case MsgType.SetRotationMsg:\r\n            return { ...state, rotationRad: msg.rotationRad };\r\n        default:\r\n            const never = msg;\r\n            throw { \"unexpected msg\": msg };\r\n    }\r\n}\r\nexport function createSender(sendMessage) {\r\n    return {\r\n        setRotation: pct => sendMessage(new SetRotationMsg(pct)),\r\n        setOffset: xyPx => sendMessage(new SetOffsetMsg(xyPx)),\r\n        setZoom: pct => sendMessage(new SetZoomMsg(pct)),\r\n    };\r\n}\r\nexport function zoomToolUpdate(camera, dragState, input) {\r\n    const xd = input.x - dragState.prevPoint.x;\r\n    const zoomPct = camera.zoomPct + xd / 150;\r\n    return new SetZoomMsg(zoomPct);\r\n}\r\nexport function rotateToolUpdate(_camera, dragState, input) {\r\n    const rotationRad = Math.atan2(input.y - dragState.clickPoint.y, input.x - dragState.clickPoint.x);\r\n    return new SetRotationMsg(rotationRad);\r\n}\r\nexport function moveToolUpdate(camera, dragState, input) {\r\n    const xd = input.x - dragState.prevPoint.x;\r\n    const yd = input.y - dragState.prevPoint.y;\r\n    const offset = new Vec2(camera.offsetPx.x + xd, camera.offsetPx.y + yd);\r\n    return new SetOffsetMsg(offset);\r\n}\r\n","import * as Brush from \"./brush\";\r\nimport * as Eraser from \"./eraser\";\r\nimport * as Camera from \"./camera\";\r\nimport { Blend } from \"../webgl\";\r\nexport var ToolMsgType;\r\n(function (ToolMsgType) {\r\n    ToolMsgType[ToolMsgType[\"SetToolMsg\"] = 0] = \"SetToolMsg\";\r\n    ToolMsgType[ToolMsgType[\"BrushMsg\"] = 1] = \"BrushMsg\";\r\n    ToolMsgType[ToolMsgType[\"EraserMsg\"] = 2] = \"EraserMsg\";\r\n    ToolMsgType[ToolMsgType[\"CameraMsg\"] = 3] = \"CameraMsg\";\r\n})(ToolMsgType || (ToolMsgType = {}));\r\nclass SetToolMsg {\r\n    constructor(subType) {\r\n        this.subType = subType;\r\n        this.type = ToolMsgType.SetToolMsg;\r\n    }\r\n}\r\nclass BrushMsg {\r\n    constructor(msg) {\r\n        this.msg = msg;\r\n        this.type = ToolMsgType.BrushMsg;\r\n    }\r\n}\r\nclass EraserMsg {\r\n    constructor(msg) {\r\n        this.msg = msg;\r\n        this.type = ToolMsgType.EraserMsg;\r\n    }\r\n}\r\nclass CameraMsg {\r\n    constructor(msg) {\r\n        this.msg = msg;\r\n        this.type = ToolMsgType.CameraMsg;\r\n    }\r\n}\r\nexport function createSender(sendMessage) {\r\n    return {\r\n        brush: Brush.createBrushSender(msg => sendMessage(new BrushMsg(msg))),\r\n        eraser: Eraser.createBrushSender(msg => sendMessage(new EraserMsg(msg))),\r\n        camera: Camera.createSender(msg => sendMessage(new CameraMsg(msg))),\r\n        setTool: type => sendMessage(new SetToolMsg(type)),\r\n    };\r\n}\r\nexport var ToolType;\r\n(function (ToolType) {\r\n    ToolType[ToolType[\"Brush\"] = 0] = \"Brush\";\r\n    ToolType[ToolType[\"Eraser\"] = 1] = \"Eraser\";\r\n    ToolType[ToolType[\"Move\"] = 2] = \"Move\";\r\n    ToolType[ToolType[\"Zoom\"] = 3] = \"Zoom\";\r\n    ToolType[ToolType[\"Rotate\"] = 4] = \"Rotate\";\r\n})(ToolType || (ToolType = {}));\r\nclass BrushState {\r\n    constructor(state) {\r\n        this.state = state;\r\n        this.type = ToolType.Brush;\r\n    }\r\n}\r\nclass EraserState {\r\n    constructor(state) {\r\n        this.state = state;\r\n        this.type = ToolType.Eraser;\r\n    }\r\n}\r\nclass MoveState {\r\n    constructor(state) {\r\n        this.state = state;\r\n        this.type = ToolType.Move;\r\n    }\r\n}\r\nclass ZoomState {\r\n    constructor(state) {\r\n        this.state = state;\r\n        this.type = ToolType.Zoom;\r\n    }\r\n}\r\nclass RotateState {\r\n    constructor(state) {\r\n        this.state = state;\r\n        this.type = ToolType.Rotate;\r\n    }\r\n}\r\nexport var EphemeralStateType;\r\n(function (EphemeralStateType) {\r\n    EphemeralStateType[EphemeralStateType[\"BrushState\"] = 0] = \"BrushState\";\r\n    EphemeralStateType[EphemeralStateType[\"EraserState\"] = 1] = \"EraserState\";\r\n    EphemeralStateType[EphemeralStateType[\"MoveState\"] = 2] = \"MoveState\";\r\n    EphemeralStateType[EphemeralStateType[\"ZoomState\"] = 3] = \"ZoomState\";\r\n    EphemeralStateType[EphemeralStateType[\"RotateState\"] = 4] = \"RotateState\";\r\n})(EphemeralStateType || (EphemeralStateType = {}));\r\nexport function init() {\r\n    return {\r\n        brush: Brush.init(),\r\n        eraser: Eraser.init(),\r\n        camera: Camera.init(),\r\n        current: ToolType.Brush,\r\n    };\r\n}\r\nexport function initEphemeral() {\r\n    return brushToolInit();\r\n}\r\nfunction brushToolInit() {\r\n    return new BrushState(Brush.initTempState());\r\n}\r\nfunction eraserToolInit() {\r\n    return new EraserState(Eraser.initTempState());\r\n}\r\nfunction moveToolInit() {\r\n    return new MoveState(null);\r\n}\r\nfunction zoomToolInit() {\r\n    return new ZoomState(null);\r\n}\r\nfunction rotateToolInit() {\r\n    return new RotateState(null);\r\n}\r\nexport function update(tool, msg) {\r\n    switch (msg.type) {\r\n        case ToolMsgType.SetToolMsg:\r\n            switch (msg.subType) {\r\n                case ToolType.Brush:\r\n                    return { ...tool, current: ToolType.Brush };\r\n                case ToolType.Eraser:\r\n                    return { ...tool, current: ToolType.Eraser };\r\n                case ToolType.Move:\r\n                    return { ...tool, current: ToolType.Move };\r\n                case ToolType.Zoom:\r\n                    return { ...tool, current: ToolType.Zoom };\r\n                case ToolType.Rotate:\r\n                    return { ...tool, current: ToolType.Rotate };\r\n                default:\r\n                    throw { \"unexpected tool type: \": msg.type };\r\n            }\r\n        case ToolMsgType.BrushMsg:\r\n            return { ...tool, brush: Brush.update(tool.brush, msg.msg) };\r\n        case ToolMsgType.EraserMsg:\r\n            return { ...tool, eraser: Eraser.update(tool.eraser, msg.msg) };\r\n        case ToolMsgType.CameraMsg:\r\n            return { ...tool, camera: Camera.update(tool.camera, msg.msg) };\r\n        default:\r\n            const never = msg;\r\n            throw { \"unexpected msg\": msg };\r\n    }\r\n}\r\nfunction syncEphemeral(tool, ephemeral) {\r\n    if (ephemeral.type === tool.current) {\r\n        return ephemeral;\r\n    }\r\n    switch (tool.current) {\r\n        case ToolType.Brush:\r\n            return brushToolInit();\r\n        case ToolType.Eraser:\r\n            return eraserToolInit();\r\n        case ToolType.Move:\r\n            return moveToolInit();\r\n        case ToolType.Rotate:\r\n            return rotateToolInit();\r\n        case ToolType.Zoom:\r\n            return zoomToolInit();\r\n        default:\r\n            const never = tool.current;\r\n            throw { \"Unknown tool type: \": tool.current };\r\n    }\r\n}\r\nexport function onClick(tool, ephemeral_, pointer) {\r\n    const ephemeral = syncEphemeral(tool, ephemeral_);\r\n    switch (ephemeral.type) {\r\n        case ToolType.Brush: {\r\n            const [value, brushPoint] = Brush.onClick(tool.camera, tool.brush, pointer);\r\n            return [tool, new BrushState(value), [brushPoint]];\r\n        }\r\n        case ToolType.Eraser: {\r\n            const [value, brushPoint] = Eraser.onClick(tool.camera, tool.eraser, pointer);\r\n            return [tool, new EraserState(value), [brushPoint]];\r\n        }\r\n        case ToolType.Move: {\r\n            if (ephemeral.state !== null)\r\n                return [tool, ephemeral, []];\r\n            const dragState = { clickPoint: pointer, prevPoint: pointer };\r\n            const cameraMsg = Camera.moveToolUpdate(tool.camera, dragState, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            return [{ ...tool, camera }, new MoveState(dragState), []];\r\n        }\r\n        case ToolType.Zoom: {\r\n            if (ephemeral.state !== null)\r\n                return [tool, ephemeral, []];\r\n            const dragState = { clickPoint: pointer, prevPoint: pointer };\r\n            const cameraMsg = Camera.zoomToolUpdate(tool.camera, dragState, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            return [{ ...tool, camera }, new ZoomState(dragState), []];\r\n        }\r\n        case ToolType.Rotate: {\r\n            if (ephemeral.state !== null)\r\n                return [tool, ephemeral, []];\r\n            const dragState = { clickPoint: pointer, prevPoint: pointer };\r\n            const cameraMsg = Camera.rotateToolUpdate(tool.camera, dragState, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            return [{ ...tool, camera }, new RotateState(dragState), []];\r\n        }\r\n    }\r\n}\r\nexport function onDrag(tool, ephemeral_, pointers) {\r\n    const ephemeral = syncEphemeral(tool, ephemeral_);\r\n    switch (ephemeral.type) {\r\n        case ToolType.Brush: {\r\n            const [value, brushPoints] = Brush.onDrag(tool.camera, tool.brush, ephemeral.state, pointers);\r\n            return [tool, new BrushState(value), brushPoints];\r\n        }\r\n        case ToolType.Eraser: {\r\n            const [value, brushPoints] = Eraser.onDrag(tool.camera, tool.eraser, ephemeral.state, pointers);\r\n            return [tool, new EraserState(value), brushPoints];\r\n        }\r\n        case ToolType.Move: {\r\n            if (ephemeral.state === null) {\r\n                return [tool, ephemeral, []];\r\n            }\r\n            const pointer = pointers[pointers.length - 1];\r\n            const cameraMsg = Camera.moveToolUpdate(tool.camera, ephemeral.state, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            const dragState = {\r\n                clickPoint: ephemeral.state.clickPoint,\r\n                prevPoint: pointer,\r\n            };\r\n            return [{ ...tool, camera }, new MoveState(dragState), []];\r\n        }\r\n        case ToolType.Zoom: {\r\n            if (ephemeral.state === null) {\r\n                return [tool, ephemeral, []];\r\n            }\r\n            const pointer = pointers[pointers.length - 1];\r\n            const cameraMsg = Camera.zoomToolUpdate(tool.camera, ephemeral.state, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            const dragState = {\r\n                clickPoint: ephemeral.state.clickPoint,\r\n                prevPoint: pointer,\r\n            };\r\n            return [{ ...tool, camera }, new ZoomState(dragState), []];\r\n        }\r\n        case ToolType.Rotate: {\r\n            if (ephemeral.state === null) {\r\n                return [tool, ephemeral, []];\r\n            }\r\n            const pointer = pointers[pointers.length - 1];\r\n            const cameraMsg = Camera.rotateToolUpdate(tool.camera, ephemeral.state, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            const dragState = {\r\n                clickPoint: ephemeral.state.clickPoint,\r\n                prevPoint: pointer,\r\n            };\r\n            return [{ ...tool, camera }, new RotateState(dragState), []];\r\n        }\r\n    }\r\n    const never = ephemeral;\r\n    throw { \"expected state\": ephemeral };\r\n}\r\nexport function onRelease(tool, ephemeral_, pointer) {\r\n    const ephemeral = syncEphemeral(tool, ephemeral_);\r\n    switch (ephemeral.type) {\r\n        case ToolType.Brush: {\r\n            const [value, brushPoints] = Brush.onRelease(tool.camera, tool.brush, ephemeral.state, pointer);\r\n            return [tool, new BrushState(value), brushPoints];\r\n        }\r\n        case ToolType.Eraser: {\r\n            const [value, brushPoints] = Eraser.onRelease(tool.camera, tool.eraser, ephemeral.state, pointer);\r\n            return [tool, new EraserState(value), brushPoints];\r\n        }\r\n        case ToolType.Move: {\r\n            if (ephemeral.state === null)\r\n                return [tool, ephemeral, []];\r\n            const cameraMsg = Camera.moveToolUpdate(tool.camera, ephemeral.state, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            return [{ ...tool, camera }, new MoveState(null), []];\r\n        }\r\n        case ToolType.Zoom: {\r\n            if (ephemeral.state === null)\r\n                return [tool, ephemeral, []];\r\n            const cameraMsg = Camera.zoomToolUpdate(tool.camera, ephemeral.state, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            return [{ ...tool, camera }, new ZoomState(null), []];\r\n        }\r\n        case ToolType.Rotate: {\r\n            if (ephemeral.state === null)\r\n                return [tool, ephemeral, []];\r\n            const cameraMsg = Camera.rotateToolUpdate(tool.camera, ephemeral.state, pointer);\r\n            const camera = Camera.update(tool.camera, cameraMsg);\r\n            return [{ ...tool, camera }, new RotateState(null), []];\r\n        }\r\n        default:\r\n            const never = ephemeral;\r\n            throw { \"expected state\": ephemeral };\r\n    }\r\n}\r\nexport function onFrame(tool, ephemeral_, currentTime) {\r\n    const ephemeral = syncEphemeral(tool, ephemeral_);\r\n    switch (ephemeral.type) {\r\n        case ToolType.Brush: {\r\n            const [value, brushPoints] = Brush.onFrame(tool.brush, ephemeral.state, currentTime);\r\n            if (value === ephemeral.state && brushPoints.length === 0) {\r\n                return [ephemeral, brushPoints];\r\n            }\r\n            else {\r\n                return [new BrushState(value), brushPoints];\r\n            }\r\n        }\r\n        case ToolType.Eraser: {\r\n            const [value, brushPoints] = Eraser.onFrame(tool.eraser, ephemeral.state, currentTime);\r\n            if (value === ephemeral.state && brushPoints.length === 0) {\r\n                return [ephemeral, brushPoints];\r\n            }\r\n            else {\r\n                return [new EraserState(value), brushPoints];\r\n            }\r\n        }\r\n        default:\r\n            return [ephemeral, []];\r\n    }\r\n}\r\nexport function getBlendMode(tool) {\r\n    switch (tool.current) {\r\n        case ToolType.Brush:\r\n            return Blend.Mode.Normal;\r\n        case ToolType.Eraser:\r\n            return Blend.Mode.Erase;\r\n        default:\r\n            console.warn(\"Getting BlendMode for type \" +\r\n                tool.current +\r\n                \", which is neithre a Brush or Eraser\");\r\n            return Blend.Mode.Normal;\r\n    }\r\n}\r\nexport function getSoftness(tool) {\r\n    switch (tool.current) {\r\n        case ToolType.Brush:\r\n            return tool.brush.softness;\r\n        case ToolType.Eraser:\r\n            return tool.eraser.softness;\r\n        default:\r\n            console.warn(\"Getting Softness for type \" + tool.current + \", which is neithre a Brush or Eraser\");\r\n            return 0;\r\n    }\r\n}\r\n","/**\n * createOpType creates {@link OpType} instances.\n *\n * @param f See {@link NodeFlags} for details.\n * @param d Operation type descriptor.\n * @returns {@link OpType} instance.\n */\nexport const createOpType = (f, d) => ({ f, d });\n/**\n * OpType for Events nodes.\n */\nexport const EVENTS = createOpType(16 /* Events */, null);\n/**\n * OpType for Context state nodes.\n */\nexport const SET_CONTEXT_STATE = createOpType(32 /* Context */ | 8192 /* SetContextState */, null);\n/**\n * OpType for TrackByKey nodes.\n */\nexport const TRACK_BY_KEY = createOpType(8 /* TrackByKey */, null);\n/**\n * createValueOp creates a {@link ValueOp} instance.\n *\n * @typeparam T Operation data type.\n * @param t Operation type.\n * @param v Operation value.\n * @returns {@link ValueOp} instance.\n */\nexport const createValueOp = (t, v) => ({ t, v });\n/**\n * createContainerOp creates a {@link ContainerOp} instance.\n *\n * @typeparam T Operation data type.\n * @param t Operation type.\n * @param v Operation value.\n * @param c Operation children.\n * @returns {@link ContainerOp} instance.\n */\nexport const createContainerOp = (t, v, c) => ({ t, v, c });\n/**\n * createDOMElementOp creates a {@link DOMElementOp} instance.\n *\n * @typeparam T Operation data type.\n * @param t Operation type.\n * @param v Operation value.\n * @param c Operation children.\n * @param n Class name.\n * @returns {@link DOMElementOp} instance.\n */\nexport const createDOMElementOp = (t, v, c, n) => ({ t, v, c, n });\n/**\n * Operation factory for event handlers.\n *\n * @example\n *\n *     render(\n *       Events(onClick(() => { console.log(\"clicked\"); }),\n *         ChildComponent(),\n *       ),\n *       DOMContainer,\n *     );\n *\n * @param v Event handlers.\n * @param c Children operation nodes.\n * @returns Events handler operation.\n */\nexport const Events = (v, c) => createContainerOp(EVENTS, v, c);\n/**\n * Operation factory for set context state operation.\n *\n * @param v Context state.\n * @param c Children operation nodes.\n * @returns Set context state operation.\n */\nexport const SetContextState = (v, c) => createContainerOp(SET_CONTEXT_STATE, v, c);\n/**\n * key creates a {@link Key} instance.\n *\n * @typeparam K Key type.\n * @typeparam V Value type.\n * @param k Key.\n * @param v Value.\n * @returns {@link Key} instance.\n */\nexport const key = (k, v) => ({ k, v });\n/**\n * Operation factory for track by key nodes.\n *\n * @example\n *\n *     const items = [1, 2, 3];\n *     render(\n *       TrackByKey(items.map((item) => key(item, div(_, _, item))),\n *       DOMContainer,\n *     );\n *\n * @typeparam K Key type.\n * @param items Keyed operations.\n * @returns Track by key operation.\n */\nexport const TrackByKey = process.env.NODE_ENV !== \"production\" ?\n    (items) => {\n        const keys = new Set();\n        for (let i = 0; i < items.length; i++) {\n            const { k } = items[i];\n            if (keys.has(k)) {\n                throw new Error(`Invalid key, found duplicated key: ${k}`);\n            }\n            keys.add(k);\n        }\n        return createValueOp(TRACK_BY_KEY, items);\n    } :\n    /* istanbul ignore next */ (items) => createValueOp(TRACK_BY_KEY, items);\n//# sourceMappingURL=operations.js.map","const ERROR_HANDLERS = [];\nlet error = false;\n/**\n * addErrorHandler adds an error handler for errors catched by functions decorated with `catchError()`.\n *\n * @param handler error handler.\n */\nexport function addErrorHandler(handler) {\n    ERROR_HANDLERS.push(handler);\n}\nexport function catchError(fn) {\n    return function () {\n        if (!error) {\n            try {\n                return fn.apply(void 0, arguments);\n            }\n            catch (e) {\n                error = true;\n                ERROR_HANDLERS.forEach((h) => { h(e); });\n                throw e;\n            }\n        }\n    };\n}\n//# sourceMappingURL=error.js.map","/**\n * append pushes item to an array and automatically creates a new array when it doesn't exist.\n *\n * @typeparam T Item type.\n * @param array Array.\n * @param item Item to append.\n * @returns Array.\n */\nexport const append = (array, item) => array === null ? [item] : (array.push(item), array);\n/**\n * unorderedArrayDeleteByIndex deletes item from an array with O(1) complexity.\n *\n * It swaps item at `index` position with the last item and removes the last one.\n *\n * @typeparam T Item type.\n * @param array Array.\n * @param index Index of an item to delete.\n */\nexport function unorderedArrayDeleteByIndex(array, index) {\n    const length = array.length - 1;\n    const last = array.pop();\n    if (index !== length) {\n        array[index] = last;\n    }\n}\n/**\n * unorderedArrayDelete deletes item from an array with O(1) complexity.\n *\n * It swaps item at `index` position with the last item and deletes the last one.\n *\n * @typeparam T Item type.\n * @param array Array.\n * @param item Item to delete.\n */\nexport function unorderedArrayDelete(array, item) {\n    const index = array.indexOf(item);\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        if (index === -1) {\n            throw new Error(`Failed to delete an item from an array, item doesn't exist in the array`);\n        }\n    }\n    unorderedArrayDeleteByIndex(array, index);\n}\n//# sourceMappingURL=array.js.map","import { unorderedArrayDeleteByIndex } from \"./array\";\n/**\n * runRepeatableTasks runs repeatable tasks.\n *\n * @param tasks Repeatable tasks.\n */\nexport function runRepeatableTasks(tasks) {\n    for (let i = 0; i < tasks.length; ++i) {\n        if (tasks[i]() === true) {\n            unorderedArrayDeleteByIndex(tasks, i--);\n        }\n    }\n}\n//# sourceMappingURL=repeatable_task_list.js.map","import { NOOP, catchError, runRepeatableTasks, box, TASK_TOKEN } from \"../core\";\nimport { printWarn } from \"../debug/print\";\nimport { doc } from \"../dom/shortcuts\";\nimport { ROOTS, findRoot, dirtyCheck } from \"../vdom/root\";\n/**\n * Execute tasks from the `TaskList`.\n *\n * @param t - Task list\n */\nfunction run(t) {\n    while (t.v.length > 0) {\n        const tasks = t.v;\n        t.v = [];\n        for (let i = 0; i < tasks.length; ++i) {\n            tasks[i](TASK_TOKEN);\n        }\n    }\n}\nlet _flags = 0;\nlet _debugFlags = 0;\nlet _frameStartTime = 0;\nlet _clock = 1;\nconst _resolvedPromise = Promise.resolve();\nconst _microtasks = box([]);\nconst _mutationEffects = box([]);\nconst _layoutEffects = box([]);\nconst _beforeMutations = [];\nconst _afterMutations = [];\n/**\n * withSchedulerTick wraps `inner` function into a scheduler context execution.\n *\n * @typeparam T Arguments.\n * @param inner Inner function.\n * @returns function that will be executed in a scheduler context.\n */\nexport const withSchedulerTick = (inner) => (catchError(function () {\n    _flags |= 1 /* Running */;\n    inner.apply(void 0, arguments);\n    run(_microtasks);\n    _flags &= ~(1 /* Running */ | 2 /* TickPending */);\n    ++_clock;\n}));\nconst runMicrotasks = withSchedulerTick(NOOP);\n/**\n * clock returns monotonically increasing clock value.\n *\n * @returns current clock value.\n */\nexport const clock = () => _clock;\n/**\n * scheduleMicrotask adds task to the microtask queue.\n *\n * @param task Microtask.\n */\nexport function scheduleMicrotask(task) {\n    _microtasks.v.push(task);\n    if ((_flags & (1 /* Running */ | 2 /* TickPending */)) === 0) {\n        _flags |= 2 /* TickPending */;\n        _resolvedPromise.then(runMicrotasks);\n    }\n}\n/**\n * beforeMutations adds a hook that will be executed before DOM mutations.\n *\n * @param fn Hook function.\n */\nexport function beforeMutations(fn) {\n    _beforeMutations.push(fn);\n}\n/**\n * afterMutations adds a hook that will be executed after DOM mutations.\n *\n * @param fn Hook function.\n */\nexport function afterMutations(fn) {\n    _afterMutations.push(fn);\n}\n/**\n * frameStartTime returns current frame start time.\n *\n * @returns current frame start time.\n */\nexport const frameStartTime = () => _frameStartTime;\n/**\n * withNextFrame wraps `inner` function into a scheduler frame update context.\n *\n * @param inner Inner function.\n * @returns function that will be executed in a frame update context.\n */\nexport const withNextFrame = (inner) => (withSchedulerTick((time) => {\n    _flags |= 16 /* UpdatingFrame */;\n    inner(time);\n    if ((_flags & 4 /* NextFramePending */) !== 0) {\n        if (time !== void 0) {\n            _frameStartTime = time;\n        }\n        runRepeatableTasks(_beforeMutations);\n        if ((_flags & 32 /* DirtyCheckPending */) !== 0) {\n            dirtyCheck();\n        }\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== \"production\") {\n            _debugFlags |= 1 /* DirtyCheckingFinished */;\n        }\n        run(_mutationEffects);\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== \"production\") {\n            _debugFlags |= 2 /* MutationsFinished */;\n        }\n        runRepeatableTasks(_afterMutations);\n        run(_layoutEffects);\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== \"production\") {\n            _debugFlags |= 4 /* LayoutFinished */;\n        }\n    }\n    _flags &= ~(16 /* UpdatingFrame */ |\n        4 /* NextFramePending */ |\n        8 /* NextSyncFramePending */ |\n        32 /* DirtyCheckPending */);\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        _debugFlags &= ~(1 /* DirtyCheckingFinished */ |\n            2 /* MutationsFinished */ |\n            4 /* LayoutFinished */);\n    }\n}));\n/**\n * Frame tasks scheduler event handler.\n *\n * @param t Current time.\n */\nconst _handleNextFrame = withNextFrame(NOOP);\nconst _handleNextFrameSync = () => { _handleNextFrame(); };\n/**\n * requestNextFrame requests an update for next frame.\n *\n * @param flags See {@link UpdateFlags} for details.\n */\nexport function requestNextFrame(flags) {\n    if ((flags !== void 0) &&\n        ((flags & 1 /* RequestSyncUpdate */) !== 0) &&\n        ((_flags & 8 /* NextSyncFramePending */) === 0)) {\n        _flags |= 4 /* NextFramePending */ | 8 /* NextSyncFramePending */;\n        if ((_flags & 16 /* UpdatingFrame */) === 0) {\n            scheduleMicrotask(_handleNextFrameSync);\n        }\n    }\n    else if ((_flags & 4 /* NextFramePending */) === 0) {\n        _flags |= 4 /* NextFramePending */;\n        if ((_flags & 16 /* UpdatingFrame */) === 0) {\n            requestAnimationFrame(_handleNextFrame);\n        }\n    }\n}\n/**\n * Adds a write DOM task to the queue.\n *\n * @param fn Write DOM task.\n * @param flags See {@link UpdateFlags} for details.\n */\nexport function scheduleMutationEffect(fn, flags) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        if (_flags & 16 /* UpdatingFrame */) {\n            if (_debugFlags & 2 /* MutationsFinished */) {\n                printWarn(\"Mutation effect is scheduled after mutations were finished\");\n            }\n        }\n    }\n    _mutationEffects.v.push(fn);\n    requestNextFrame(flags);\n}\n/**\n * Adds a DOM layout task to the queue.\n *\n * @param fn Read DOM task\n * @param flags See {@link UpdateFlags} for details.\n */\nexport function scheduleLayoutEffect(fn, flags) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        if (_flags & 16 /* UpdatingFrame */) {\n            if (_debugFlags & 2 /* MutationsFinished */) {\n                printWarn(\"Layout effect is scheduled after layout were finished\");\n            }\n        }\n    }\n    _layoutEffects.v.push(fn);\n    requestNextFrame(flags);\n}\n/**\n * Request dirty checking.\n *\n * @param flags See {@link UpdateFlags} for details.\n */\nexport function requestDirtyCheck(flags) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        if (_flags & 16 /* UpdatingFrame */) {\n            if (_debugFlags & 2 /* MutationsFinished */) {\n                printWarn(\"Dirty checking is scheduled after dirty checking were finished\");\n            }\n        }\n    }\n    _flags |= 32 /* DirtyCheckPending */;\n    requestNextFrame(flags);\n}\n/**\n * Invalidate component.\n *\n * @param c Component instance.\n * @param flags See {@link UpdateFlags} for details.\n */\nexport function invalidate(c, flags) {\n    c.f |= 1024 /* Dirty */;\n    requestDirtyCheck(flags);\n}\n/**\n * dirty requests a dirty checking and returns current monotonic clock value.\n *\n * @param flags See {@link UpdateFlags} for details.\n * @returns current monotonic clock value.\n */\nexport const dirty = (flags) => (requestDirtyCheck(flags), _clock);\n/**\n * Render operation into the container.\n *\n * @param next Operation to render.\n * @param container DOM Node that will contain rendered operation.\n * @param flags See {@link UpdateFlags} for details.\n */\nexport function render(next, container, flags) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        /**\n         * Rendering into the <body> element is disabled to make it possible to fix iOS quirk with click events.\n         */\n        if (container === doc.body) {\n            throw new Error(\"Rendering into the <body> element aren't allowed\");\n        }\n        if (!doc.body.contains(container)) {\n            throw new Error(\"Container element should be attached to the document\");\n        }\n    }\n    const root = findRoot((v) => v.container === container);\n    if (root) {\n        root.next = next;\n    }\n    else {\n        ROOTS.push({ container, state: null, next });\n    }\n    requestDirtyCheck(flags);\n}\n//# sourceMappingURL=index.js.map","import { createOpType, createContainerOp } from \"./operations\";\n/**\n * Current context.\n */\nlet n = null;\n/**\n * Used for detecting invalid `ContextDescriptor()` invocations in DEBUG mode.\n */\nlet contextEnabled = false;\n/**\n * Enable checking for invalid `context()` invocations in DEBUG mode.\n */\nexport function enableContext() {\n    contextEnabled = true;\n}\n/**\n * Disable checking for invalid `context()` invocations in DEBUG mode.\n */\nexport function disableContext() {\n    contextEnabled = false;\n}\n/**\n * Reset current context.\n */\nexport function resetContext() {\n    n = null;\n}\n/**\n * pushContext creates a new context state and pushes it to the context stack.\n *\n * @param d Context descriptor.\n * @param v Context value.\n * @returns New {@link ContextState}.\n */\nexport function pushContext(d, v) {\n    return n = { n, d, v };\n}\n/**\n * getContext retrieves current context.\n *\n * @returns current context.\n */\nexport function getContext() {\n    return n;\n}\n/**\n * setContext assigns current context.\n *\n * Should be executed before going deeper into context node.\n *\n * @param c Current context.\n */\nexport function setContext(c) {\n    return n = c;\n}\n/**\n * contextValue creates a context descriptor.\n *\n * @example\n *\n *     const { set: StoreContext, get: getStore } = contextValue<Store>();\n *     const Component = component((c) => {\n *       const getValue = useSelect(c, () => getStore().value);\n *       return () => getValue();\n *     });\n *     render(\n *       StoreContext(store,\n *         Component(),\n *       ),\n *       container,\n *     );\n *\n * @returns {@link ContextDescriptor}\n */\nexport function contextValue() {\n    let type;\n    const d = {\n        get: () => {\n            /* istanbul ignore else */\n            if (process.env.NODE_ENV !== \"production\") {\n                if (!contextEnabled) {\n                    throw Error(\"Invalid context invocation\");\n                }\n            }\n            let next = n;\n            while (next !== null) {\n                if (next.d === d) {\n                    return next.v;\n                }\n                next = next.n;\n            }\n            /* istanbul ignore else */\n            if (process.env.NODE_ENV !== \"production\") {\n                throw Error(\"Unable to find context value\");\n            }\n        },\n        set: (v, c) => createContainerOp(type, v, c),\n    };\n    type = createOpType(32 /* Context */, d);\n    return d;\n}\n//# sourceMappingURL=context.js.map","import { Events, onClick } from \"ivi\";\r\nimport { button } from \"ivi-html\";\r\nimport * as styles from \"./buttons.scss\";\r\nexport function PrimaryButton({ onClick: handler, title, content }) {\r\n    return Events(onClick(handler), button(styles.primary, { title }, content));\r\n}\r\nexport function DefaultButton({ onClick: handler, title, content }) {\r\n    return Events(onClick(handler), button(styles.ddefault, { title }, content));\r\n}\r\nfunction noOp() { }\r\nexport function SinkableButton(props) {\r\n    const className = props.isDown ? styles.sinkableSunk : styles.sinkableUnsunk;\r\n    const handler = props.isDown ? props.onDownClick || noOp : props.onClick;\r\n    return Events(onClick(handler), button(className, { title: props.title }, props.children));\r\n}\r\n","import { lerp } from \"../util\";\r\nexport const noDelay = {\r\n    duration: 0,\r\n};\r\nfunction easing(x) {\r\n    return x ** 0.92;\r\n}\r\nexport function delay(duration) {\r\n    console.assert(duration >= 0, \"Delay can't be negative\");\r\n    return { duration };\r\n}\r\nfunction inputLerp(pct, start, end) {\r\n    return {\r\n        pressure: lerp(pct, start.pressure, end.pressure),\r\n        x: lerp(pct, start.x, end.x),\r\n        y: lerp(pct, start.y, end.y),\r\n    };\r\n}\r\nexport function init(currentTime, start) {\r\n    return { startTime: currentTime, start, end: start };\r\n}\r\nexport function updateWithInput(config, state, currentTime, end) {\r\n    if (config.duration === 0) {\r\n        return [{ startTime: currentTime, start: end, end }, end];\r\n    }\r\n    const deltaTime = currentTime - state.startTime;\r\n    const pct = easing(Math.min(deltaTime / config.duration, 1));\r\n    const output = inputLerp(pct, state.start, end);\r\n    return [{ startTime: currentTime, start: output, end }, output];\r\n}\r\nexport function update(config, state, currentTime) {\r\n    const deltaTime = currentTime - state.startTime;\r\n    if (deltaTime >= config.duration) {\r\n        return [state, state.end];\r\n    }\r\n    const pct = easing(Math.min(deltaTime / config.duration, 1));\r\n    const output = inputLerp(pct, state.start, state.end);\r\n    return [state, output];\r\n}\r\n","import { _ } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./surface.scss\";\r\nexport const surfaceLook = styles.surfaceLook;\r\nexport function Surface(children) {\r\n    return div(styles.surface, _, children);\r\n}\r\n","import { _ } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./eraser.scss\";\r\nimport * as Interp from \"./interpolation\";\r\nimport * as BrushDelay from \"./brushDelay\";\r\nimport * as Color from \"color\";\r\nimport { Vec2, clamp } from \"../util\";\r\nimport { Surface } from \"../views/surface\";\r\nimport { Labeled } from \"../views/labeled\";\r\nimport { Slider } from \"../views/slider\";\r\nimport { InlineLabeled } from \"../views/inlineLabeled\";\r\nimport { Switch } from \"../views/switch\";\r\nexport var MsgType;\r\n(function (MsgType) {\r\n    MsgType[MsgType[\"SetDiameterMsg\"] = 0] = \"SetDiameterMsg\";\r\n    MsgType[MsgType[\"SetSoftnessMsg\"] = 1] = \"SetSoftnessMsg\";\r\n    MsgType[MsgType[\"SetOpacityMsg\"] = 2] = \"SetOpacityMsg\";\r\n    MsgType[MsgType[\"SetSpacingMsg\"] = 3] = \"SetSpacingMsg\";\r\n    MsgType[MsgType[\"SetPressureAffectsOpacityMsg\"] = 4] = \"SetPressureAffectsOpacityMsg\";\r\n    MsgType[MsgType[\"SetPressureAffectsSizeMsg\"] = 5] = \"SetPressureAffectsSizeMsg\";\r\n    MsgType[MsgType[\"SetDelayMsg\"] = 6] = \"SetDelayMsg\";\r\n})(MsgType || (MsgType = {}));\r\nclass SetDiameterMsg {\r\n    constructor(diameterPx) {\r\n        this.diameterPx = diameterPx;\r\n        this.type = MsgType.SetDiameterMsg;\r\n    }\r\n}\r\nclass SetSoftnessMsg {\r\n    constructor(softnessPct) {\r\n        this.softnessPct = softnessPct;\r\n        this.type = MsgType.SetSoftnessMsg;\r\n    }\r\n}\r\nclass SetOpacityMsg {\r\n    constructor(opacityPct) {\r\n        this.opacityPct = opacityPct;\r\n        this.type = MsgType.SetOpacityMsg;\r\n    }\r\n}\r\nclass SetSpacingMsg {\r\n    constructor(spacingPct) {\r\n        this.spacingPct = spacingPct;\r\n        this.type = MsgType.SetSpacingMsg;\r\n    }\r\n}\r\nclass SetPressureAffectsOpacityMsg {\r\n    constructor(pressureAffectsOpacity) {\r\n        this.pressureAffectsOpacity = pressureAffectsOpacity;\r\n        this.type = MsgType.SetPressureAffectsOpacityMsg;\r\n    }\r\n}\r\nclass SetPressureAffectsSizeMsg {\r\n    constructor(pressureAffectsSize) {\r\n        this.pressureAffectsSize = pressureAffectsSize;\r\n        this.type = MsgType.SetPressureAffectsSizeMsg;\r\n    }\r\n}\r\nclass SetDelayMsg {\r\n    constructor(delayMs) {\r\n        this.delayMs = delayMs;\r\n        this.type = MsgType.SetDelayMsg;\r\n    }\r\n}\r\nexport function createBrushSender(sendMessage) {\r\n    return {\r\n        setDelay: ms => sendMessage(new SetDelayMsg(ms)),\r\n        setDiameter: px => sendMessage(new SetDiameterMsg(px)),\r\n        setSoftness: pct => sendMessage(new SetSoftnessMsg(pct)),\r\n        setOpacity: pct => sendMessage(new SetOpacityMsg(pct)),\r\n        setSpacing: px => sendMessage(new SetSpacingMsg(px)),\r\n        setPressureAffectsOpacity: x => sendMessage(new SetPressureAffectsOpacityMsg(x)),\r\n        setPressureAffectsSize: x => sendMessage(new SetPressureAffectsSizeMsg(x)),\r\n    };\r\n}\r\nexport function initTempState() {\r\n    return null;\r\n}\r\nexport function init() {\r\n    return {\r\n        diameterPx: 15,\r\n        softness: 0.3,\r\n        flowPct: 0.3,\r\n        spacingPct: 0.05,\r\n        pressureAffectsOpacity: false,\r\n        pressureAffectsSize: true,\r\n        delay: BrushDelay.delay(5),\r\n    };\r\n}\r\nexport function update(state, msg) {\r\n    switch (msg.type) {\r\n        case MsgType.SetDiameterMsg:\r\n            return { ...state, diameterPx: clamp(0.1, 500, msg.diameterPx) };\r\n        case MsgType.SetSoftnessMsg:\r\n            return { ...state, softness: clamp(0, 1, msg.softnessPct) };\r\n        case MsgType.SetOpacityMsg:\r\n            return { ...state, flowPct: clamp(0.01, 1, msg.opacityPct) };\r\n        case MsgType.SetSpacingMsg:\r\n            return { ...state, spacingPct: clamp(0.01, 1, msg.spacingPct) };\r\n        case MsgType.SetPressureAffectsOpacityMsg:\r\n            return { ...state, pressureAffectsOpacity: msg.pressureAffectsOpacity };\r\n        case MsgType.SetPressureAffectsSizeMsg:\r\n            return { ...state, pressureAffectsSize: msg.pressureAffectsSize };\r\n        case MsgType.SetDelayMsg:\r\n            return { ...state, delay: BrushDelay.delay(clamp(0, 500, msg.delayMs)) };\r\n        default:\r\n            const never = msg;\r\n            throw { \"unexpected message\": msg };\r\n    }\r\n}\r\nexport function onClick(camera, state, input) {\r\n    const brushInput = pointerToBrushInput(camera, input);\r\n    const interpState = Interp.init(createInputPoint(state, brushInput));\r\n    const delayState = BrushDelay.init(input.time, brushInput);\r\n    return [{ interpState, delayState }, createBrushPoint(state, brushInput)];\r\n}\r\nexport function onDrag(camera, state, tempState, inputs) {\r\n    if (tempState === null) {\r\n        const res = onClick(camera, state, inputs[0]);\r\n        return [res[0], [res[1]]];\r\n    }\r\n    else {\r\n        let interpState = tempState.interpState;\r\n        let brushPoints = [];\r\n        let delayState = tempState.delayState;\r\n        for (let i = 0; i < inputs.length; i++) {\r\n            const input = inputs[i];\r\n            let brushDelayInput = pointerToBrushInput(camera, input);\r\n            const updateResult = BrushDelay.updateWithInput(state.delay, delayState, input.time, brushDelayInput);\r\n            const interpReslt = Interp.interpolate(state, interpState, createInputPoint(state, updateResult[1]));\r\n            delayState = updateResult[0];\r\n            interpState = interpReslt[0];\r\n            brushPoints = brushPoints.concat(interpReslt[1]);\r\n        }\r\n        return [{ delayState, interpState }, brushPoints];\r\n    }\r\n}\r\nexport function onFrame(state, tempState, currentTime) {\r\n    if (tempState === null || state.delay.duration < 0) {\r\n        return [null, []];\r\n    }\r\n    const [delayState, newBrushInput] = BrushDelay.update(state.delay, tempState.delayState, currentTime);\r\n    const [interpState, brushPoints] = Interp.interpolate(state, tempState.interpState, createInputPoint(state, newBrushInput));\r\n    return [{ delayState, interpState }, brushPoints];\r\n}\r\nexport function onRelease(camera, state, tempState, input) {\r\n    if (tempState === null) {\r\n        return [null, []];\r\n    }\r\n    return [null, []];\r\n}\r\nfunction pointerToBrushInput(_camera, input) {\r\n    // TODO: offset, zoom, and stuff\r\n    return { x: input.x, y: input.y, pressure: input.pressure };\r\n}\r\nfunction createBrushPoint(state, input) {\r\n    return {\r\n        alpha: state.flowPct * input.pressure,\r\n        color: Color.RgbLinear.Black,\r\n        position: new Vec2(input.x, input.y),\r\n        rotation: 0,\r\n        scaledDiameter: state.diameterPx * input.pressure,\r\n    };\r\n}\r\nfunction createInputPoint(state, input) {\r\n    return {\r\n        alpha: state.flowPct * input.pressure,\r\n        color: Color.RgbLinear.Black,\r\n        position: new Vec2(input.x, input.y),\r\n        pressure: input.pressure,\r\n        rotation: 0,\r\n    };\r\n}\r\n/*\r\n *\r\n * Views\r\n *\r\n */\r\nexport function Details(props) {\r\n    const sender = props.messageSender;\r\n    const brush = props.tool;\r\n    return Surface(div(styles.detailsContainer, _, [\r\n        Labeled({\r\n            label: \"Size\",\r\n            value: brush.diameterPx.toFixed(1) + \"px\",\r\n            children: Slider({\r\n                percentage: brush.diameterPx / 500,\r\n                onChange: pct => sender.setDiameter(pct * 500),\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Softness\",\r\n            value: brush.softness.toFixed(2),\r\n            children: Slider({\r\n                percentage: brush.softness,\r\n                onChange: sender.setSoftness,\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Flow\",\r\n            value: brush.flowPct.toFixed(2),\r\n            children: Slider({\r\n                percentage: brush.flowPct,\r\n                onChange: sender.setOpacity,\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Spacing\",\r\n            value: brush.spacingPct.toFixed(2) + \"%\",\r\n            children: Slider({\r\n                percentage: brush.spacingPct,\r\n                onChange: sender.setSpacing,\r\n            }),\r\n        }),\r\n        InlineLabeled({\r\n            label: \"Pressure-Opacity\",\r\n            children: Switch({\r\n                checked: brush.pressureAffectsOpacity,\r\n                onCheck: sender.setPressureAffectsOpacity,\r\n            }),\r\n        }),\r\n        InlineLabeled({\r\n            label: \"Pressure-Size\",\r\n            children: Switch({\r\n                checked: brush.pressureAffectsSize,\r\n                onCheck: sender.setPressureAffectsSize,\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Delay\",\r\n            value: brush.delay.duration.toFixed(0) + \"ms\",\r\n            children: Slider({\r\n                percentage: brush.delay.duration / 500,\r\n                onChange: pct => sender.setDelay(pct * 500),\r\n            }),\r\n        }),\r\n    ]));\r\n}\r\n","import { Stack } from \"./stack\";\r\nexport class ZipperList {\r\n    constructor(__left, focus, __right) {\r\n        this.__left = __left;\r\n        this.focus = focus;\r\n        this.__right = __right;\r\n    }\r\n    static singleton(value) {\r\n        return new ZipperList(Stack.empty(), value, Stack.empty());\r\n    }\r\n    static fromArray(arr) {\r\n        if (arr.length === 0) {\r\n            return null;\r\n        }\r\n        return ZipperList.unsafeFromArray(arr);\r\n    }\r\n    static unsafeFromArray(arr) {\r\n        let right = Stack.empty();\r\n        for (let i = arr.length - 1; i > 0; i--) {\r\n            right = right.cons(arr[i]);\r\n        }\r\n        return new ZipperList(Stack.empty(), arr[0], right);\r\n    }\r\n    getLeft() {\r\n        return this.__left.reverse().toArray();\r\n    }\r\n    getRight() {\r\n        return this.__right.toArray();\r\n    }\r\n    hasLeft() {\r\n        return this.__left.isNonEmpty();\r\n    }\r\n    hasRight() {\r\n        return this.__right.isNonEmpty();\r\n    }\r\n    focusLeft() {\r\n        if (this.__left.isNonEmpty()) {\r\n            return new ZipperList(this.__left.tail, this.__left.head, this.__right.cons(this.focus));\r\n        }\r\n        else {\r\n            return this;\r\n        }\r\n    }\r\n    focusRight() {\r\n        if (this.__right.isNonEmpty()) {\r\n            return new ZipperList(this.__left.cons(this.focus), this.__right.head, this.__right.tail);\r\n        }\r\n        else {\r\n            return this;\r\n        }\r\n    }\r\n    focusf(f) {\r\n        if (f(this.focus))\r\n            return this;\r\n        let attempt = this;\r\n        // try left\r\n        while (attempt.hasLeft()) {\r\n            attempt = attempt.focusLeft();\r\n            if (f(attempt.focus))\r\n                return attempt;\r\n        }\r\n        attempt = this;\r\n        // try right\r\n        while (attempt.hasRight()) {\r\n            attempt = attempt.focusRight();\r\n            if (f(attempt.focus))\r\n                return attempt;\r\n        }\r\n        return this;\r\n    }\r\n    toArray() {\r\n        const arr = [];\r\n        let stack = this.__left.reverse();\r\n        while (stack.isNonEmpty()) {\r\n            arr.push(stack.head);\r\n            stack = stack.tail;\r\n        }\r\n        arr.push(this.focus);\r\n        stack = this.__right;\r\n        while (stack.isNonEmpty()) {\r\n            arr.push(stack.head);\r\n            stack = stack.tail;\r\n        }\r\n        return arr;\r\n    }\r\n}\r\n","import { component, Events, onClick, useEffect, onBlur, Ref, box, invalidate, onMouseDown, findDOMNode, _, } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./menu.scss\";\r\nfunction noOp() { }\r\nfunction Menu_(c) {\r\n    const containerRef = box(null);\r\n    let isExpanded = false;\r\n    let selectHandler = noOp;\r\n    function onGlobalClick(ev) {\r\n        const containerNode = findDOMNode(containerRef);\r\n        let target = ev.target;\r\n        while (target.parentElement !== null) {\r\n            if (target === containerNode) {\r\n                return;\r\n            }\r\n            target = target.parentElement;\r\n        }\r\n        closeMenu();\r\n    }\r\n    function openMenu() {\r\n        isExpanded = true;\r\n        invalidate(c);\r\n    }\r\n    function closeMenu() {\r\n        isExpanded = false;\r\n        invalidate(c);\r\n    }\r\n    function closeAndCallback(val) {\r\n        selectHandler(val);\r\n        closeMenu();\r\n    }\r\n    const listenToMouse = useEffect(c, isExpanded => {\r\n        if (!isExpanded) {\r\n            return;\r\n        }\r\n        document.body.addEventListener(\"mousedown\", onGlobalClick, {\r\n            passive: true,\r\n        });\r\n        return () => {\r\n            document.body.removeEventListener(\"mousedown\", onGlobalClick);\r\n        };\r\n    });\r\n    return (props) => {\r\n        listenToMouse(isExpanded);\r\n        selectHandler = props.onSelect;\r\n        const containerNode = findDOMNode(containerRef);\r\n        return Events(onBlur(closeMenu), Ref(containerRef, div(styles.container, _, [\r\n            Events(onMouseDown(isExpanded ? closeMenu : openMenu), div(isExpanded ? styles.selectedDisplayExpanded : styles.selectedDisplay, _, props.show(props.choices.focus))),\r\n            !isExpanded\r\n                ? null\r\n                : div(styles.selectableOptions, {\r\n                    style: {\r\n                        \"margin-top\": containerNode === null\r\n                            ? _\r\n                            : \"calc(-0.5rem - \" +\r\n                                containerNode.getBoundingClientRect().height +\r\n                                \"px)\",\r\n                    },\r\n                }, \r\n                // nesting fragments inside fragments seems to cause trouble\r\n                [\r\n                    div(_, _, props.choices\r\n                        .getLeft()\r\n                        .map(val => Events(onClick(() => closeAndCallback(val)), div(styles.optionDefault, _, props.show(val))))),\r\n                    Events(onClick(closeMenu), div(styles.optionSelected, _, props.show(props.choices.focus))),\r\n                    div(_, _, props.choices\r\n                        .getRight()\r\n                        .map(val => Events(onClick(() => closeAndCallback(val)), div(styles.optionDefault, _, props.show(val))))),\r\n                ]),\r\n        ])));\r\n    };\r\n}\r\nexport const Menu = component(Menu_);\r\n","import { component, Events, onMouseDown, useEffect, Ref, box, invalidate, findDOMNode, _, useMutationEffect, scheduleMicrotask, } from \"ivi\";\r\nimport { div, canvas } from \"ivi-html\";\r\nimport * as styles from \"./colorWheel.scss\";\r\nimport * as Color from \"color\";\r\nimport { DEFINE_TAU, createProgram, DEFINE_hsluv_etc, DEFINE_hsvToRgb } from \"../webgl\";\r\nimport { ColorMode } from \"../util\";\r\nvar PointerState;\r\n(function (PointerState) {\r\n    PointerState[PointerState[\"Default\"] = 0] = \"Default\";\r\n    PointerState[PointerState[\"DownOnInner\"] = 1] = \"DownOnInner\";\r\n    PointerState[PointerState[\"DownOnOuter\"] = 2] = \"DownOnOuter\";\r\n})(PointerState || (PointerState = {}));\r\nconst MARGIN = (1 - 0.55) / 2;\r\nfunction noOp() { }\r\nexport const ColorWheel = component(c => {\r\n    const containerRef = box(null);\r\n    const canvasRef = box(null);\r\n    let glState = null;\r\n    let pointerState = PointerState.Default;\r\n    let color = new Color.Hsluv(0, 0, 0);\r\n    let colorMode = ColorMode.Hsluv;\r\n    let colorHandler = noOp;\r\n    function signalOuter(ev) {\r\n        // get xy delta from the center of the ring\r\n        const bounds = findDOMNode(containerRef).getBoundingClientRect();\r\n        const x = ev.clientX - bounds.left - bounds.width * 0.5;\r\n        const y = ev.clientY - bounds.top - bounds.height * 0.5;\r\n        // calculate radians of the delta\r\n        const rad = Math.atan2(y, x);\r\n        // get hue from radians (keep in mind the ring is turned 50%)\r\n        const hue = rad / (Math.PI * 2) + 0.5;\r\n        switch (colorMode) {\r\n            case ColorMode.Hsv: {\r\n                const hsv = Color.rgbToHsv(color.toRgb());\r\n                colorHandler(Color.rgbToHsluv(hsv.with({ h: hue }).toRgb()));\r\n                break;\r\n            }\r\n            case ColorMode.Hsluv: {\r\n                colorHandler(color.with({ h: hue * 360 }));\r\n                break;\r\n            }\r\n        }\r\n        invalidate(c);\r\n    }\r\n    function signalInner(ev) {\r\n        const bounds = findDOMNode(containerRef).getBoundingClientRect();\r\n        const marginX = bounds.width * MARGIN;\r\n        const marginY = bounds.height * MARGIN;\r\n        const width = bounds.width - marginX * 2;\r\n        const height = bounds.height - marginY * 2;\r\n        const x = clamp(ev.clientX - bounds.left - marginX, 0, width);\r\n        const y = clamp(ev.clientY - bounds.top - marginY, 0, height);\r\n        const pctX = x / width;\r\n        const pctY = 1 - y / height;\r\n        switch (colorMode) {\r\n            case ColorMode.Hsv: {\r\n                const hue = Color.rgbToHsv(color.toRgb()).h;\r\n                colorHandler(Color.rgbToHsluv(Color.hsvToRgb(new Color.Hsv(hue, pctX, pctY))));\r\n                break;\r\n            }\r\n            case ColorMode.Hsluv: {\r\n                const hue = color.h;\r\n                colorHandler(new Color.Hsluv(hue, pctX * 100, pctY * 100));\r\n                break;\r\n            }\r\n        }\r\n        invalidate(c);\r\n    }\r\n    const initializeCanvas = useMutationEffect(c, () => {\r\n        const canvas = findDOMNode(canvasRef);\r\n        if (canvas == null) {\r\n            throw { \"canvas ref not fonud\": canvasRef };\r\n        }\r\n        glState = new GlState(canvas);\r\n        scheduleMicrotask(() => invalidate(c));\r\n        return () => {\r\n            if (glState) {\r\n                glState.dispose();\r\n            }\r\n        };\r\n    });\r\n    const renderCanvas = useMutationEffect(c, args => {\r\n        if (!glState) {\r\n            return;\r\n        }\r\n        glState.render(args.colorMode, args.color);\r\n    }, (a, b) => a.color.is(b.color) && a.colorMode === b.colorMode);\r\n    const listenToMouse = useEffect(c, () => {\r\n        function onUp(_ev) {\r\n            pointerState = PointerState.Default;\r\n        }\r\n        function onMove(ev) {\r\n            switch (pointerState) {\r\n                case PointerState.Default:\r\n                    break;\r\n                case PointerState.DownOnInner:\r\n                    signalInner(ev);\r\n                    break;\r\n                case PointerState.DownOnOuter:\r\n                    signalOuter(ev);\r\n                    break;\r\n            }\r\n        }\r\n        document.body.addEventListener(\"mouseup\", onUp);\r\n        document.body.addEventListener(\"mousemove\", onMove, { passive: true });\r\n        return () => {\r\n            document.body.removeEventListener(\"mouseup\", onUp);\r\n            document.body.removeEventListener(\"mousemove\", onMove);\r\n        };\r\n    });\r\n    function onDown(ev) {\r\n        const bounds = findDOMNode(containerRef).getBoundingClientRect();\r\n        const x = clamp(ev.clientX - bounds.left, 0, bounds.width);\r\n        const y = clamp(ev.clientY - bounds.top, 0, bounds.height);\r\n        const marginX = bounds.width * MARGIN;\r\n        const marginY = bounds.height * MARGIN;\r\n        const isInner = isInclusive(x, marginX, bounds.width - marginX) &&\r\n            isInclusive(y, marginY, bounds.height - marginY);\r\n        if (isInner) {\r\n            pointerState = PointerState.DownOnInner;\r\n            signalInner(ev);\r\n        }\r\n        else {\r\n            pointerState = PointerState.DownOnOuter;\r\n            signalOuter(ev);\r\n        }\r\n    }\r\n    return props => {\r\n        listenToMouse();\r\n        initializeCanvas();\r\n        renderCanvas({ colorMode: props.colorType, color: props.color });\r\n        color = props.color;\r\n        colorMode = props.colorType;\r\n        colorHandler = props.onChange;\r\n        const canvasNode = findDOMNode(canvasRef);\r\n        const thumbData = glState === null\r\n            ? null\r\n            : canvasNode === null\r\n                ? null\r\n                : glState.getThumbPositions(props.colorType, props.color, canvasNode.getBoundingClientRect());\r\n        return Events(onMouseDown(onDown), Ref(containerRef, div(styles.container, _, div(_, _, [\r\n            Ref(canvasRef, canvas(_, { width: 160, height: 160 })),\r\n            div(styles.cicleThumb, thumbData === null\r\n                ? _\r\n                : {\r\n                    style: {\r\n                        left: thumbData.circleThumbX + \"px\",\r\n                        top: thumbData.circleThumbY + \"px\",\r\n                        \"background-color\": props.color.toStyle(),\r\n                        \"border-color\": props.color.l > 50 ? \"black\" : \"white\",\r\n                        transform: \"rotate(\" + thumbData.angle + \"deg)\",\r\n                    },\r\n                }),\r\n            div(styles.areaThumb, thumbData === null\r\n                ? _\r\n                : {\r\n                    style: {\r\n                        left: thumbData.areaThumbX + \"px\",\r\n                        top: thumbData.areaThumbY + \"px\",\r\n                        \"background-color\": props.color.toStyle(),\r\n                        \"border-color\": props.color.l > 50 ? \"black\" : \"white\",\r\n                    },\r\n                }),\r\n        ]))));\r\n    };\r\n});\r\nfunction clamp(x, min, max) {\r\n    return x < min ? min : x > max ? max : x;\r\n}\r\nfunction isInclusive(n, min, max) {\r\n    return n >= min && n <= max;\r\n}\r\nclass GlState {\r\n    constructor(canvas) {\r\n        const gl = canvas.getContext(\"webgl\");\r\n        if (gl === null) {\r\n            throw \"Failed to init webgl\";\r\n        }\r\n        gl.blendFunc(WebGLRenderingContext.ONE, WebGLRenderingContext.ONE_MINUS_SRC_ALPHA);\r\n        gl.enable(WebGLRenderingContext.BLEND);\r\n        gl.disable(WebGLRenderingContext.DEPTH_TEST);\r\n        this.gl = gl;\r\n        this.ringRenderer = new RingRenderer(gl);\r\n        this.satValRenderer = new SatValRenderer(gl);\r\n    }\r\n    render(colorMode, color) {\r\n        this.gl.clearColor(0, 0, 0, 0);\r\n        this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT);\r\n        this.ringRenderer.render(colorMode, color);\r\n        this.satValRenderer.render(colorMode, color);\r\n    }\r\n    getThumbPositions(colorType, color, canvasRect) {\r\n        let angle;\r\n        let xPct;\r\n        let yPct;\r\n        if (colorType === ColorMode.Hsluv) {\r\n            angle = (color.h + 180) % 360;\r\n            xPct = color.s / 100;\r\n            yPct = color.l / 100;\r\n        }\r\n        else {\r\n            const hsv = Color.rgbToHsv(color.toRgb());\r\n            angle = (hsv.h * 360 + 180) % 360;\r\n            xPct = hsv.s;\r\n            yPct = hsv.v;\r\n        }\r\n        let circleThumbX = 0;\r\n        let circleThumbY = 0;\r\n        if (canvasRect !== null) {\r\n            const radius = 80;\r\n            const cx = canvasRect.left + radius;\r\n            const cy = canvasRect.top + radius;\r\n            const theta = (angle * Math.PI) / 180;\r\n            const dx = (radius - 8) * Math.cos(theta);\r\n            const dy = (radius - 8) * Math.sin(theta);\r\n            circleThumbX = cx + dx;\r\n            circleThumbY = cy + dy;\r\n        }\r\n        let areaThumbX = 0;\r\n        let areaThumbY = 0;\r\n        if (canvasRect !== null) {\r\n            const offset = canvasRect.width * 0.225;\r\n            const width = canvasRect.width * 0.55;\r\n            areaThumbX = canvasRect.left + offset + width * xPct;\r\n            areaThumbY = canvasRect.top + offset + width * (1 - yPct);\r\n        }\r\n        return {\r\n            angle,\r\n            circleThumbX,\r\n            circleThumbY,\r\n            areaThumbX,\r\n            areaThumbY,\r\n        };\r\n    }\r\n    dispose() {\r\n        this.ringRenderer.dispose();\r\n        this.satValRenderer.dispose();\r\n    }\r\n}\r\nconst RING_VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec2 a_position;\r\n\r\nvarying vec2 v_position;\r\n\r\nvoid main() {\r\n    gl_Position = vec4(a_position, 0.0, 1.0);\r\n\r\n    v_position = a_position;\r\n}\r\n`;\r\nfunction makeRingFragSrc(DEFINE_toRgb) {\r\n    return `\r\n    precision highp float;\r\n    \r\n    ${DEFINE_TAU}\r\n\r\n    ${DEFINE_toRgb}\r\n    \r\n    #define INNER_RAD1 0.83\r\n    #define INNER_RAD2 0.85\r\n    #define OUTER_RAD1 0.98\r\n    #define OUTER_RAD2 1.00\r\n    \r\n    varying vec2 v_position;\r\n    \r\n    uniform vec3 u_color;\r\n    \r\n    void main() {\r\n        vec2 pos = v_position * vec2(1.0, -1.0);\r\n        float dist = sqrt(dot(pos, pos));\r\n    \r\n        float a = smoothstep(INNER_RAD1, INNER_RAD2, dist) - smoothstep(OUTER_RAD1, OUTER_RAD2, dist);\r\n    \r\n        float radians = atan(pos.y, pos.x);\r\n        float hue = (radians / TAU) + 0.5;\r\n    \r\n        vec3 hsluv = vec3(hue, 1.0, a);\r\n    \r\n        gl_FragColor = vec4(toRgb(u_color, hsluv) * a, a);\r\n    }\r\n    `;\r\n}\r\nconst RING_FRAG_SRC_HSV = makeRingFragSrc(`\r\n${DEFINE_hsvToRgb}\r\n\r\nvec3 toRgb(vec3 color, vec3 xyz) {\r\n    return hsvToRgb(xyz * vec3(1.0, color.y, color.z));\r\n}\r\n`);\r\nconst RING_FRAG_SRC_HSLUV = makeRingFragSrc(`\r\n${DEFINE_hsluv_etc}\r\n\r\nvec3 toRgb(vec3 color, vec3 xyz) {\r\n    return hsluvToRgb(xyz * vec3(360.0, color.y, color.z));\r\n}\r\n`);\r\nclass RingRenderer {\r\n    constructor(gl) {\r\n        this.gl = gl;\r\n        this.program = null;\r\n        this.colorLocation = null;\r\n        this.prevColorType = null;\r\n        this.buffer = gl.createBuffer();\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, new Float32Array([1.0, 1.0, -1.0, 1.0, 1.0, -1.0, -1.0, -1.0]), WebGLRenderingContext.STATIC_DRAW);\r\n    }\r\n    render(colorType, color) {\r\n        if (!this.program || this.prevColorType !== colorType) {\r\n            if (this.program) {\r\n                this.gl.deleteProgram(this.program);\r\n            }\r\n            switch (colorType) {\r\n                case ColorMode.Hsv:\r\n                    this.program = createProgram(this.gl, RING_VERT_SRC, RING_FRAG_SRC_HSV);\r\n                    break;\r\n                case ColorMode.Hsluv:\r\n                    this.program = createProgram(this.gl, RING_VERT_SRC, RING_FRAG_SRC_HSLUV);\r\n                    break;\r\n            }\r\n            this.gl.bindAttribLocation(this.program, 0, \"a_position\");\r\n            this.colorLocation = this.gl.getUniformLocation(this.program, \"u_color\");\r\n            this.prevColorType = colorType;\r\n        }\r\n        this.gl.useProgram(this.program);\r\n        this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        this.gl.vertexAttribPointer(0, 2, WebGLRenderingContext.FLOAT, false, 0, 0);\r\n        this.gl.enableVertexAttribArray(0);\r\n        switch (colorType) {\r\n            case ColorMode.Hsv: {\r\n                const hsv = Color.rgbToHsv(Color.hsluvToRgb(color));\r\n                this.gl.uniform3f(this.colorLocation, hsv.h, hsv.s, hsv.v);\r\n                break;\r\n            }\r\n            case ColorMode.Hsluv: {\r\n                this.gl.uniform3f(this.colorLocation, color.h, color.s, color.l);\r\n                break;\r\n            }\r\n        }\r\n        this.gl.drawArrays(WebGLRenderingContext.TRIANGLE_STRIP, 0, 4);\r\n    }\r\n    dispose() {\r\n        this.gl.deleteBuffer(this.buffer);\r\n        this.gl.deleteProgram(this.program);\r\n    }\r\n}\r\nconst WI = 0.55;\r\nconst SATVAL_VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec2 a_position;\r\n\r\nvarying vec2 v_tex_position;\r\n\r\nvoid main() {\r\n    gl_Position = vec4(a_position, 0.0, 1.0);\r\n\r\n    v_tex_position = ((a_position / ${WI.toFixed(2)}) + 1.0) / 2.0;\r\n}\r\n`;\r\nfunction makeSatValFragSrc(DEFINE_toRgb) {\r\n    return `\r\n    precision highp float;\r\n\r\n    ${DEFINE_toRgb}\r\n    \r\n    varying vec2 v_tex_position;\r\n    \r\n    uniform vec3 u_color;\r\n    \r\n    void main() {\r\n        // mix saturation from left to right [0, 1]\r\n        // mix value from bottom to top: [0, 1]\r\n        float x = v_tex_position.x;\r\n        float y = v_tex_position.y;\r\n    \r\n        gl_FragColor = vec4(\r\n            toRgb(u_color.x, x, y),\r\n            1.0\r\n        );\r\n    }\r\n    `;\r\n}\r\nconst SATVAL_FRAG_SRC_HSV = makeSatValFragSrc(`\r\n${DEFINE_hsvToRgb}\r\n\r\nvec3 toRgb(float hue, float x, float y) {\r\n    return hsvToRgb(vec3(hue, x, y));\r\n}\r\n`);\r\nconst SATVAL_FRAG_SRC_HSLUV = makeSatValFragSrc(`\r\n${DEFINE_hsluv_etc}\r\n\r\nvec3 toRgb(float hue, float x, float y) {\r\n    return hsluvToRgb(vec3(hue, x * 100.0, y * 100.0));\r\n}\r\n`);\r\nclass SatValRenderer {\r\n    constructor(gl) {\r\n        this.gl = gl;\r\n        this.colorLocation = null;\r\n        this.program = null;\r\n        this.prevColorMode = null;\r\n        this.buffer = gl.createBuffer();\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, new Float32Array([\r\n            // 1\r\n            WI,\r\n            WI,\r\n            // 2\r\n            -WI,\r\n            WI,\r\n            // 3\r\n            WI,\r\n            -WI,\r\n            // 4\r\n            -WI,\r\n            WI,\r\n            // 5\r\n            WI,\r\n            -WI,\r\n            // 6\r\n            -WI,\r\n            -WI,\r\n        ]), WebGLRenderingContext.STATIC_DRAW);\r\n    }\r\n    render(colorMode, color) {\r\n        const gl = this.gl;\r\n        if (!this.program || this.prevColorMode !== colorMode) {\r\n            if (this.program) {\r\n                gl.deleteProgram(this.program);\r\n            }\r\n            switch (colorMode) {\r\n                case ColorMode.Hsv:\r\n                    this.program = createProgram(gl, SATVAL_VERT_SRC, SATVAL_FRAG_SRC_HSV);\r\n                    break;\r\n                case ColorMode.Hsluv:\r\n                    this.program = createProgram(gl, SATVAL_VERT_SRC, SATVAL_FRAG_SRC_HSLUV);\r\n                    break;\r\n                default:\r\n                    const never = colorMode;\r\n                    throw { \"unexpected color mode\": colorMode };\r\n            }\r\n            gl.bindAttribLocation(this.program, 0, \"a_position\");\r\n            this.colorLocation = gl.getUniformLocation(this.program, \"u_color\");\r\n        }\r\n        gl.useProgram(this.program);\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.vertexAttribPointer(0, 2, WebGLRenderingContext.FLOAT, false, 0, 0);\r\n        gl.enableVertexAttribArray(0);\r\n        switch (colorMode) {\r\n            case ColorMode.Hsv: {\r\n                const hsv = Color.rgbToHsv(Color.hsluvToRgb(color));\r\n                this.gl.uniform3f(this.colorLocation, hsv.h, hsv.s, hsv.v);\r\n                break;\r\n            }\r\n            case ColorMode.Hsluv: {\r\n                this.gl.uniform3f(this.colorLocation, color.h, color.s, color.l);\r\n                break;\r\n            }\r\n        }\r\n        gl.drawArrays(WebGLRenderingContext.TRIANGLES, 0, 6);\r\n        this.prevColorMode = colorMode;\r\n    }\r\n    dispose() {\r\n        const gl = this.gl;\r\n        gl.deleteBuffer(this.buffer);\r\n        gl.deleteProgram(this.program);\r\n    }\r\n}\r\n","import { Events, onClick } from \"ivi\";\r\nimport { div, span } from \"ivi-html\";\r\nimport * as styles from \"./colorDisplay.scss\";\r\nexport function ColorDisplay(props) {\r\n    return Events(onClick(props.onClick), div(styles.container, undefined, [\r\n        span(styles.secondary, {\r\n            style: { \"background-color\": props.colorSecondary.toStyle() },\r\n        }),\r\n        span(styles.primary, { style: { \"background-color\": props.color.toStyle() } }),\r\n    ]));\r\n}\r\n","import { Events, onChange, onPaste, component, _ } from \"ivi\";\r\nimport { div, input, VALUE } from \"ivi-html\";\r\nimport * as styles from \"./brush.scss\";\r\nimport * as Interp from \"./interpolation\";\r\nimport * as BrushDelay from \"./brushDelay\";\r\nimport * as Color from \"color\";\r\nimport { Vec2, ColorMode, colorModeToString, clamp } from \"../util\";\r\nimport { ZipperList } from \"../collections/zipperList\";\r\nimport { Menu } from \"../views/menu\";\r\nimport { ColorWheel } from \"../views/colorWheel\";\r\nimport { Labeled } from \"../views/labeled\";\r\nimport { Slider } from \"../views/slider\";\r\nimport { InlineLabeled } from \"../views/inlineLabeled\";\r\nimport { Switch } from \"../views/switch\";\r\nimport { ColorDisplay } from \"../views/colorDisplay\";\r\nimport { Surface } from \"../views/surface\";\r\nexport var MsgType;\r\n(function (MsgType) {\r\n    MsgType[MsgType[\"SetDiameterMsg\"] = 0] = \"SetDiameterMsg\";\r\n    MsgType[MsgType[\"SetSoftnessMsg\"] = 1] = \"SetSoftnessMsg\";\r\n    MsgType[MsgType[\"SetOpacityMsg\"] = 2] = \"SetOpacityMsg\";\r\n    MsgType[MsgType[\"SetColorMsg\"] = 3] = \"SetColorMsg\";\r\n    MsgType[MsgType[\"SetColorModeMsg\"] = 4] = \"SetColorModeMsg\";\r\n    MsgType[MsgType[\"SetSpacingMsg\"] = 5] = \"SetSpacingMsg\";\r\n    MsgType[MsgType[\"SetPressureAffectsOpacityMsg\"] = 6] = \"SetPressureAffectsOpacityMsg\";\r\n    MsgType[MsgType[\"SetPressureAffectsSizeMsg\"] = 7] = \"SetPressureAffectsSizeMsg\";\r\n    MsgType[MsgType[\"SwapColorMsg\"] = 8] = \"SwapColorMsg\";\r\n    MsgType[MsgType[\"SetDelayMsg\"] = 9] = \"SetDelayMsg\";\r\n})(MsgType || (MsgType = {}));\r\nclass SetDiameterMsg {\r\n    constructor(diameterPx) {\r\n        this.diameterPx = diameterPx;\r\n        this.type = MsgType.SetDiameterMsg;\r\n    }\r\n}\r\nclass SetSoftnessMsg {\r\n    constructor(softnessPct) {\r\n        this.softnessPct = softnessPct;\r\n        this.type = MsgType.SetSoftnessMsg;\r\n    }\r\n}\r\nclass SetOpacityMsg {\r\n    constructor(opacityPct) {\r\n        this.opacityPct = opacityPct;\r\n        this.type = MsgType.SetOpacityMsg;\r\n    }\r\n}\r\nclass SetColorMsg {\r\n    constructor(color) {\r\n        this.color = color;\r\n        this.type = MsgType.SetColorMsg;\r\n    }\r\n}\r\nclass SetColorModeMsg {\r\n    constructor(mode) {\r\n        this.mode = mode;\r\n        this.type = MsgType.SetColorModeMsg;\r\n    }\r\n}\r\nclass SetSpacingMsg {\r\n    constructor(spacingPct) {\r\n        this.spacingPct = spacingPct;\r\n        this.type = MsgType.SetSpacingMsg;\r\n    }\r\n}\r\nclass SetPressureAffectsOpacityMsg {\r\n    constructor(pressureAffectsOpacity) {\r\n        this.pressureAffectsOpacity = pressureAffectsOpacity;\r\n        this.type = MsgType.SetPressureAffectsOpacityMsg;\r\n    }\r\n}\r\nclass SetPressureAffectsSizeMsg {\r\n    constructor(pressureAffectsSize) {\r\n        this.pressureAffectsSize = pressureAffectsSize;\r\n        this.type = MsgType.SetPressureAffectsSizeMsg;\r\n    }\r\n}\r\nclass SwapColorMsg {\r\n    constructor() {\r\n        this.type = MsgType.SwapColorMsg;\r\n    }\r\n}\r\nclass SetDelayMsg {\r\n    constructor(delayMs) {\r\n        this.delayMs = delayMs;\r\n        this.type = MsgType.SetDelayMsg;\r\n    }\r\n}\r\nexport function createBrushSender(sendMessage) {\r\n    return {\r\n        setColor: color => sendMessage(new SetColorMsg(color)),\r\n        setColorMode: mode => sendMessage(new SetColorModeMsg(mode)),\r\n        setDelay: ms => sendMessage(new SetDelayMsg(ms)),\r\n        setDiameter: px => sendMessage(new SetDiameterMsg(px)),\r\n        setOpacity: pct => sendMessage(new SetOpacityMsg(pct)),\r\n        setSoftness: pct => sendMessage(new SetSoftnessMsg(pct)),\r\n        setSpacing: px => sendMessage(new SetSpacingMsg(px)),\r\n        setPressureAffectsOpacity: x => sendMessage(new SetPressureAffectsOpacityMsg(x)),\r\n        setPressureAffectsSize: x => sendMessage(new SetPressureAffectsSizeMsg(x)),\r\n        swapColorFrom: () => sendMessage(new SwapColorMsg()),\r\n    };\r\n}\r\nexport function initTempState() {\r\n    return null;\r\n}\r\nexport function init() {\r\n    return {\r\n        diameterPx: 15,\r\n        softness: 0.4,\r\n        flowPct: 0.3,\r\n        colorMode: ZipperList.unsafeFromArray([ColorMode.Hsluv, ColorMode.Hsv]),\r\n        color: new Color.Hsluv(73, 100, 16),\r\n        colorSecondary: new Color.Hsluv(0, 0, 100),\r\n        spacingPct: 0.05,\r\n        pressureAffectsOpacity: false,\r\n        pressureAffectsSize: true,\r\n        delay: BrushDelay.delay(5),\r\n    };\r\n}\r\nexport function update(state, msg) {\r\n    switch (msg.type) {\r\n        case MsgType.SetDiameterMsg:\r\n            return { ...state, diameterPx: clamp(0.1, 500, msg.diameterPx) };\r\n        case MsgType.SetSoftnessMsg:\r\n            return { ...state, softness: clamp(0, 1, msg.softnessPct) };\r\n        case MsgType.SetOpacityMsg:\r\n            return { ...state, flowPct: clamp(0.01, 1, msg.opacityPct) };\r\n        case MsgType.SetColorMsg:\r\n            return { ...state, color: msg.color };\r\n        case MsgType.SetColorModeMsg:\r\n            return { ...state, colorMode: state.colorMode.focusf(x => x === msg.mode) };\r\n        case MsgType.SetSpacingMsg:\r\n            return { ...state, spacingPct: clamp(0.01, 1, msg.spacingPct) };\r\n        case MsgType.SetPressureAffectsOpacityMsg:\r\n            return { ...state, pressureAffectsOpacity: msg.pressureAffectsOpacity };\r\n        case MsgType.SetPressureAffectsSizeMsg:\r\n            return { ...state, pressureAffectsSize: msg.pressureAffectsSize };\r\n        case MsgType.SwapColorMsg:\r\n            return {\r\n                ...state,\r\n                color: state.colorSecondary,\r\n                colorSecondary: state.color,\r\n            };\r\n        case MsgType.SetDelayMsg:\r\n            return { ...state, delay: BrushDelay.delay(clamp(0, 500, msg.delayMs)) };\r\n        default:\r\n            const never = msg;\r\n            throw { \"unexpected msg\": msg };\r\n    }\r\n}\r\nexport function onClick(camera, brush, input) {\r\n    const brushInput = pointerToBrushInput(camera, input);\r\n    const interpState = Interp.init(createInputPoint(brush, brushInput));\r\n    const delayState = BrushDelay.init(input.time, brushInput);\r\n    return [{ interpState, delayState }, createBrushPoint(brush, brushInput)];\r\n}\r\nexport function onDrag(camera, state, tempState, inputs) {\r\n    if (tempState === null) {\r\n        const res = onClick(camera, state, inputs[0]);\r\n        return [res[0], [res[1]]];\r\n    }\r\n    else {\r\n        let interpState = tempState.interpState;\r\n        let brushPoints = [];\r\n        let delayState = tempState.delayState;\r\n        for (let i = 0; i < inputs.length; i++) {\r\n            const input = inputs[i];\r\n            const brushDelayInput = pointerToBrushInput(camera, input);\r\n            const updateResult = BrushDelay.updateWithInput(state.delay, delayState, input.time, brushDelayInput);\r\n            const interpReslt = Interp.interpolate(state, interpState, createInputPoint(state, updateResult[1]));\r\n            delayState = updateResult[0];\r\n            interpState = interpReslt[0];\r\n            brushPoints = brushPoints.concat(interpReslt[1]);\r\n        }\r\n        return [{ delayState, interpState }, brushPoints];\r\n    }\r\n}\r\nexport function onFrame(brush, state, currentTime) {\r\n    if (state === null) {\r\n        return [null, []];\r\n    }\r\n    // if (brush.delay.duration <= 0) return [null, []]\r\n    const [delayState, newBrushInput] = BrushDelay.update(brush.delay, state.delayState, currentTime);\r\n    const [interpState, brushPoints] = Interp.interpolate(brush, state.interpState, createInputPoint(brush, newBrushInput));\r\n    return [{ delayState, interpState }, brushPoints];\r\n}\r\nexport function onRelease(camera, brush, state, input) {\r\n    if (state === null) {\r\n        return [null, []];\r\n    }\r\n    return [null, []];\r\n}\r\nfunction pointerToBrushInput(_camera, input) {\r\n    // TODO: offset, zoom, and stuff\r\n    return { x: input.x, y: input.y, pressure: input.pressure };\r\n}\r\nfunction createBrushPoint(brush, input) {\r\n    const alpha = brush.flowPct * input.pressure;\r\n    const color = alpha === 1\r\n        ? brush.color.toRgb().toLinear()\r\n        : brush.color\r\n            .toRgb()\r\n            .toLinear()\r\n            .mix(1 - alpha, Color.RgbLinear.Black);\r\n    const position = new Vec2(input.x, input.y);\r\n    return {\r\n        alpha,\r\n        color,\r\n        position,\r\n        rotation: 0,\r\n        scaledDiameter: brush.diameterPx * input.pressure,\r\n    };\r\n}\r\nfunction createInputPoint(brush, input) {\r\n    const alpha = brush.flowPct * input.pressure;\r\n    const color = alpha === 1\r\n        ? brush.color.toRgb().toLinear()\r\n        : brush.color\r\n            .toRgb()\r\n            .toLinear()\r\n            .mix(1 - alpha, Color.RgbLinear.Black);\r\n    const position = new Vec2(input.x, input.y);\r\n    return {\r\n        alpha,\r\n        color,\r\n        position,\r\n        pressure: input.pressure,\r\n        rotation: 0,\r\n    };\r\n}\r\nexport const Details = component(c => {\r\n    return props => {\r\n        const sender = props.messageSender;\r\n        const brush = props.tool;\r\n        function onColorText(text) {\r\n            const rgb = Color.Rgb.fromCss(text);\r\n            if (rgb === null) {\r\n                return;\r\n            }\r\n            sender.setColor(Color.rgbToHsluv(rgb));\r\n        }\r\n        return Surface(div(styles.detailsContainer, _, [\r\n            div(_, { style: { margin: \"0.5rem 0\" } }, Menu({\r\n                choices: brush.colorMode,\r\n                show: colorModeToString,\r\n                onSelect: sender.setColorMode,\r\n            })),\r\n            ColorWheel({\r\n                color: brush.color,\r\n                colorType: brush.colorMode.focus,\r\n                onChange: sender.setColor,\r\n            }),\r\n            div(_, { style: { margin: \"0.5rem 0\", width: \"100%\" } }, ColorDisplay({\r\n                color: brush.color,\r\n                colorSecondary: brush.colorSecondary,\r\n                onClick: () => sender.swapColorFrom(brush.color),\r\n            })),\r\n            div(_, { style: { margin: \"0.5rem 0\" } }, Events(onPaste(ev => onColorText(ev.target.value)), Events(onChange(ev => onColorText(ev.target.value)), input(styles.textInput, {\r\n                type: \"text\",\r\n                style: { width: \"100%\" },\r\n                value: VALUE(brush.color.toStyle()),\r\n            })))),\r\n            Labeled({\r\n                label: \"Size\",\r\n                value: brush.diameterPx.toFixed(1) + \"px\",\r\n                children: Slider({\r\n                    percentage: brush.diameterPx / 500,\r\n                    onChange: pct => sender.setDiameter(pct * 500),\r\n                }),\r\n            }),\r\n            Labeled({\r\n                label: \"Softness\",\r\n                value: brush.softness.toFixed(2),\r\n                children: Slider({\r\n                    percentage: brush.softness,\r\n                    onChange: sender.setSoftness,\r\n                }),\r\n            }),\r\n            Labeled({\r\n                label: \"Flow\",\r\n                value: brush.flowPct.toFixed(2),\r\n                children: Slider({\r\n                    percentage: brush.flowPct,\r\n                    onChange: sender.setOpacity,\r\n                }),\r\n            }),\r\n            Labeled({\r\n                label: \"Spacing\",\r\n                value: brush.spacingPct.toFixed(2) + \"%\",\r\n                children: Slider({\r\n                    percentage: brush.spacingPct,\r\n                    onChange: sender.setSpacing,\r\n                }),\r\n            }),\r\n            ColorSliders({\r\n                color: brush.color,\r\n                colorType: brush.colorMode.focus,\r\n                sender: sender,\r\n            }),\r\n            InlineLabeled({\r\n                label: \"Pressure-Opacity\",\r\n                children: Switch({\r\n                    checked: brush.pressureAffectsOpacity,\r\n                    onCheck: sender.setPressureAffectsOpacity,\r\n                }),\r\n            }),\r\n            InlineLabeled({\r\n                label: \"Pressure-Size\",\r\n                children: Switch({\r\n                    checked: brush.pressureAffectsSize,\r\n                    onCheck: sender.setPressureAffectsSize,\r\n                }),\r\n            }),\r\n            Labeled({\r\n                label: \"Delay\",\r\n                value: brush.delay.duration.toFixed(0) + \"ms\",\r\n                children: Slider({\r\n                    percentage: brush.delay.duration / 500,\r\n                    onChange: pct => sender.setDelay(pct * 500),\r\n                }),\r\n            }),\r\n        ]));\r\n    };\r\n});\r\nfunction ColorSliders({ sender, color, colorType, }) {\r\n    switch (colorType) {\r\n        case ColorMode.Hsluv:\r\n            return HsluvSliders(sender, color);\r\n        case ColorMode.Hsv:\r\n            return HsvSliders(sender, Color.rgbToHsv(color.toRgb()));\r\n    }\r\n}\r\nfunction HsluvSliders(sender, color) {\r\n    return [\r\n        Labeled({\r\n            label: \"Hue\",\r\n            value: color.h.toFixed(2),\r\n            children: Slider({\r\n                percentage: color.h / 360,\r\n                onChange: pct => sender.setColor(color.with({ h: pct * 360 })),\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Saturation\",\r\n            value: color.s.toFixed(2),\r\n            children: Slider({\r\n                percentage: color.s / 100,\r\n                onChange: pct => sender.setColor(color.with({ s: pct * 100 })),\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Luminosity\",\r\n            value: color.l.toFixed(2),\r\n            children: Slider({\r\n                percentage: color.l / 100,\r\n                onChange: pct => sender.setColor(color.with({ l: pct * 100 })),\r\n            }),\r\n        }),\r\n    ];\r\n}\r\nfunction HsvSliders(sender, color) {\r\n    return [\r\n        Labeled({\r\n            label: \"Hue\",\r\n            value: color.h.toFixed(2),\r\n            children: Slider({\r\n                percentage: color.h,\r\n                onChange: pct => sender.setColor(Color.rgbToHsluv(color.with({ h: pct }).toRgb())),\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Saturation\",\r\n            value: color.s.toFixed(2),\r\n            children: Slider({\r\n                percentage: color.s,\r\n                onChange: pct => sender.setColor(Color.rgbToHsluv(color.with({ s: pct }).toRgb())),\r\n            }),\r\n        }),\r\n        Labeled({\r\n            label: \"Value\",\r\n            value: color.v.toFixed(2),\r\n            children: Slider({\r\n                percentage: color.v,\r\n                onChange: pct => sender.setColor(Color.rgbToHsluv(color.with({ v: pct }).toRgb())),\r\n            }),\r\n        }),\r\n    ];\r\n}\r\n","export var Generators;\r\n(function (Generators) {\r\n    function always(val) {\r\n        return rng => [val, rng];\r\n    }\r\n    Generators.always = always;\r\n    function bool(rng) {\r\n        const [pct, nextSeed] = rng.nextFloat();\r\n        return [pct < 0.5, nextSeed];\r\n    }\r\n    Generators.bool = bool;\r\n    function int(min, max) {\r\n        min = min | 0;\r\n        max = max | 0;\r\n        return rng => int_(min, max, rng);\r\n    }\r\n    Generators.int = int;\r\n    function int_(min, max, rng) {\r\n        const [pct, nextSeed] = rng.nextFloat();\r\n        const delta = max - min;\r\n        return [pct * delta + min, nextSeed];\r\n    }\r\n    function float(min, max) {\r\n        return rng => float_(min, max, rng);\r\n    }\r\n    Generators.float = float;\r\n    function float_(min, max, rng) {\r\n        const [pct, nextSeed] = rng.nextFloat();\r\n        const delta = max - min;\r\n        return [pct * delta + min, nextSeed];\r\n    }\r\n    function t2(genA, genB) {\r\n        return rng => t2_(genA, genB, rng);\r\n    }\r\n    Generators.t2 = t2;\r\n    function t2_(genA, genB, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        const [valB, rng2] = genB(rng1);\r\n        return [[valA, valB], rng2];\r\n    }\r\n    function t3(genA, genB, genC) {\r\n        return rng => t3_(genA, genB, genC, rng);\r\n    }\r\n    Generators.t3 = t3;\r\n    function t3_(genA, genB, genC, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        const [valB, rng2] = genB(rng1);\r\n        const [valC, rng3] = genC(rng2);\r\n        return [[valA, valB, valC], rng3];\r\n    }\r\n    function array(length, gen) {\r\n        return rng => array_(length, gen, rng);\r\n    }\r\n    Generators.array = array;\r\n    function array_(length, gen, rng) {\r\n        const arr = new Array(length);\r\n        for (let i = 0; i < length; i++) {\r\n            const [val, nextRng] = gen(rng);\r\n            arr[i] = val;\r\n            rng = nextRng;\r\n        }\r\n        return [arr, rng];\r\n    }\r\n    function object(gens) {\r\n        return rng => object_(gens, rng);\r\n    }\r\n    Generators.object = object;\r\n    function object_(gens, rng) {\r\n        /* eslint-disable */\r\n        const obj = {};\r\n        for (const prop in gens) {\r\n            const [val, nextRng] = gens[prop](rng);\r\n            obj[prop] = val;\r\n            rng = nextRng;\r\n        }\r\n        /* eslint-enable */\r\n        return [obj, rng];\r\n    }\r\n    function map(genA, f) {\r\n        return rng => map_(genA, f, rng);\r\n    }\r\n    Generators.map = map;\r\n    function map_(genA, f, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        return [f(valA), rng1];\r\n    }\r\n    function map2(genA, genB, f) {\r\n        return rng => map2_(genA, genB, f, rng);\r\n    }\r\n    Generators.map2 = map2;\r\n    function map2_(genA, genB, f, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        const [valB, rng2] = genB(rng1);\r\n        return [f(valA, valB), rng2];\r\n    }\r\n    function map3(genA, genB, genC, f) {\r\n        return rng => map3_(genA, genB, genC, f, rng);\r\n    }\r\n    Generators.map3 = map3;\r\n    function map3_(genA, genB, genC, f, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        const [valB, rng2] = genB(rng1);\r\n        const [valC, rng3] = genC(rng2);\r\n        return [f(valA, valB, valC), rng3];\r\n    }\r\n    function map4(genA, genB, genC, genD, f) {\r\n        return rng => map4_(genA, genB, genC, genD, f, rng);\r\n    }\r\n    Generators.map4 = map4;\r\n    function map4_(genA, genB, genC, genD, f, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        const [valB, rng2] = genB(rng1);\r\n        const [valC, rng3] = genC(rng2);\r\n        const [valD, rng4] = genD(rng3);\r\n        return [f(valA, valB, valC, valD), rng4];\r\n    }\r\n    function andThen(genA, f) {\r\n        return rng => andThen_(genA, f, rng);\r\n    }\r\n    Generators.andThen = andThen;\r\n    function andThen_(genA, f, rng0) {\r\n        const [valA, rng1] = genA(rng0);\r\n        return f(valA)(rng1);\r\n    }\r\n    function lazy(createGen) {\r\n        let cachedGen = null;\r\n        return rng => {\r\n            if (cachedGen === null) {\r\n                cachedGen = createGen();\r\n            }\r\n            return cachedGen(rng);\r\n        };\r\n    }\r\n    Generators.lazy = lazy;\r\n})(Generators || (Generators = {}));\r\n","export class Seed {\r\n    nextInt() {\r\n        return [this.asInt(), this.step()];\r\n    }\r\n    nextFloat() {\r\n        const floatResult = this.asInt() / 4294967295;\r\n        return [floatResult, this.step()];\r\n    }\r\n    next2Floats() {\r\n        const [first, state2] = this.nextFloat();\r\n        const [second, state3] = state2.nextFloat();\r\n        return [first, second, state3];\r\n    }\r\n    next3Floats() {\r\n        const [first, state2] = this.nextFloat();\r\n        const [second, state3] = state2.nextFloat();\r\n        const [third, state4] = state3.nextFloat();\r\n        return [first, second, third, state4];\r\n    }\r\n}\r\n/*\r\n * Implementation of Xorshift 128\r\n * https://en.wikipedia.org/wiki/Xorshift\r\n */\r\nexport class XorshiftSeed extends Seed {\r\n    constructor(a, b, c, d, value) {\r\n        super();\r\n        this.a = a;\r\n        this.b = b;\r\n        this.c = c;\r\n        this.d = d;\r\n        this.value = value;\r\n    }\r\n    static create(n) {\r\n        let seed = new XorshiftSeed(n, 0, 0, 0, null);\r\n        for (let i = 0; i < 32; i++) {\r\n            seed = seed.step();\r\n        }\r\n        return seed;\r\n    }\r\n    asInt() {\r\n        return this.force().asInt;\r\n    }\r\n    step() {\r\n        return this.force().next;\r\n    }\r\n    display() {\r\n        return `Xorshift 128 (${this.a}, ${this.b}, ${this.c}, ${this.d})`;\r\n    }\r\n    force() {\r\n        if (this.value === null) {\r\n            const s = this.a;\r\n            let t = this.d;\r\n            t ^= t << 11;\r\n            t ^= t >>> 8;\r\n            t ^= s;\r\n            t ^= s >>> 19;\r\n            this.value = {\r\n                asInt: t >>> 0,\r\n                next: new XorshiftSeed(t, s, this.b, this.c, null),\r\n            };\r\n        }\r\n        return this.value;\r\n    }\r\n}\r\n","export * from \"./rng\";\r\nexport { Generators } from \"./generators\";\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layersWrapper\":\"layers-view__layersWrapper--3ZfQn\",\"layersListWrapper\":\"layers-view__layersListWrapper--1Tkb_\",\"layersControlsWrapper\":\"layers-view__layersControlsWrapper--2yZCW\",\"unselectedLayerWrapper\":\"layers-view__unselectedLayerWrapper--CJqHx\",\"selectedLayerWrapper\":\"layers-view__selectedLayerWrapper--1aNDA\",\"layerLeft\":\"layers-view__layerLeft--3IVhD\",\"layerRight\":\"layers-view__layerRight--3aI8m\",\"layerName\":\"layers-view__layerName--15uDf\",\"layerOpacity\":\"layers-view__layerOpacity--3odsZ\"};","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","import { EMPTY_OBJECT, TASK_TOKEN, SELECT_TOKEN, UNMOUNT_TOKEN } from \"../core\";\nimport { clock, scheduleMutationEffect, scheduleLayoutEffect } from \"../scheduler\";\nfunction addHook(hooks, hook) {\n    if (hooks === null) {\n        return hook;\n    }\n    if (typeof hooks === \"function\") {\n        return [hooks, hook];\n    }\n    hooks.push(hook);\n    return hooks;\n}\nexport function useSelect(component, selector, areEqual) {\n    /* istanbul ignore next */\n    if (process.env.IVI_TARGET === \"ssr\") {\n        return (nextProps) => selector(nextProps, void 0);\n    }\n    let lastChecked = 0;\n    let state;\n    let props;\n    const prevSelector = component.s.s;\n    const hook = (p) => {\n        if (p === SELECT_TOKEN) {\n            if (prevSelector !== null && prevSelector(SELECT_TOKEN) === true) {\n                return true;\n            }\n            if (state !== void 0) {\n                p = selector(props, state);\n                lastChecked = clock();\n                if (state !== p) {\n                    state = p;\n                    return true;\n                }\n            }\n            return false;\n        }\n        if ((state !== void 0) &&\n            ((props !== p) &&\n                (areEqual === void 0 || areEqual(props, p) !== true))) {\n            state = void 0;\n        }\n        if (state === void 0 || lastChecked < clock()) {\n            state = selector(p, state);\n        }\n        props = p;\n        return state;\n    };\n    component.s.s = hook;\n    return hook;\n}\n/**\n * useUnmount creates an unmount hook.\n *\n * @example\n *\n *     const C = component((c) => {\n *       useUnmount(c, () => {\n *         console.log(\"unmounted\");\n *       });\n *\n *       return () => div();\n *     });\n *\n * @param component Component instance.\n * @param hook Unmount hook.\n */\nexport function useUnmount(component, hook) {\n    /* istanbul ignore else */\n    if (process.env.IVI_TARGET !== \"ssr\") {\n        component.f |= 32768 /* Unmount */;\n        const hooks = component.s;\n        hooks.u = addHook(hooks.u, hook);\n    }\n}\nfunction withEffect(scheduleTask) {\n    return (component, hook, areEqual) => {\n        let reset;\n        let props = EMPTY_OBJECT;\n        const handler = (p) => {\n            if (p === TASK_TOKEN || p === UNMOUNT_TOKEN) {\n                if (reset !== void 0) {\n                    reset();\n                }\n                if (p !== UNMOUNT_TOKEN) {\n                    reset = hook(props);\n                    if (reset !== void 0 && component !== void 0) {\n                        useUnmount(component, handler);\n                        // remove component reference to indicate that unmount hook is registered.\n                        component = void 0;\n                    }\n                }\n            }\n            else if ((props === EMPTY_OBJECT) ||\n                ((props !== p) &&\n                    (areEqual === void 0 || areEqual(props, p) !== true))) {\n                props = p;\n                scheduleTask(handler);\n            }\n        };\n        return handler;\n    };\n}\n/**\n * useEffect creates a side effect hook.\n *\n * @example\n *\n *     const Counter = component<number>((c) => {\n *       let i = 0;\n *       const timer = useEffect<number>(c, (delay) => {\n *         const tid = setInterval(() => {\n *           i++;\n *           invalidate(c);\n *         }, delay);\n *         return () => { clearInterval(tid); };\n *       });\n *\n *       return (delay) => (\n *         timer(delay),\n *\n *         div(_, _, i),\n *       );\n *     });\n *\n * @typeparam T Hook props type.\n * @param component Component instance.\n * @param hook Side effect function.\n * @param areEqual `areEqual` function.\n * @returns Side effect hook.\n */\nexport const useEffect = process.env.IVI_TARGET === \"ssr\" ?\n    /* istanbul ignore next */ (props) => { } :\n    ( /*#__PURE__*/withEffect((task) => { task(TASK_TOKEN); }));\n/**\n * useMutationEffect creates a DOM mutation effect hook.\n *\n * @typeparam T Hook props type.\n * @param stateNode Component instance.\n * @param hook DOM mutation function.\n * @param areEqual `areEqual` function.\n * @returns Side effect hook.\n */\nexport const useMutationEffect = process.env.IVI_TARGET === \"ssr\" ?\n    /* istanbul ignore next */ (props) => { } :\n    ( /*#__PURE__*/withEffect(scheduleMutationEffect));\n/**\n * useLayoutEffect creates a DOM layout effect hook.\n *\n * @typeparam T Hook props type.\n * @param component Component instance.\n * @param hook DOM layout function.\n * @param areEqual `areEqual` function.\n * @returns Side effect hook.\n */\nexport const useLayoutEffect = process.env.IVI_TARGET === \"ssr\" ?\n    /* istanbul ignore next */ (props) => { } :\n    ( /*#__PURE__*/withEffect(scheduleLayoutEffect));\n//# sourceMappingURL=hooks.js.map","/**\n * Task token.\n */\nexport const TASK_TOKEN = (process.env.NODE_ENV !== \"production\" ? Object.freeze({}) : /* istanbul ignore next */ {});\n/**\n * Select token.\n */\nexport const SELECT_TOKEN = (process.env.NODE_ENV !== \"production\" ? Object.freeze({}) : /* istanbul ignore next */ {});\n/**\n * Unmount token.\n */\nexport const UNMOUNT_TOKEN = (process.env.NODE_ENV !== \"production\" ? Object.freeze({}) : /* istanbul ignore next */ {});\n/**\n * Empty object.\n */\nexport const EMPTY_OBJECT = process.env.NODE_ENV !== \"production\" ? Object.freeze({}) : /* istanbul ignore next */ {};\n/**\n * Empty array.\n */\nexport const EMPTY_ARRAY = process.env.NODE_ENV !== \"production\" ? Object.freeze([]) : /* istanbul ignore next */ [];\n//# sourceMappingURL=token.js.map","import { _ } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./inlineLabeled.scss\";\r\nexport function InlineLabeled({ label, children }) {\r\n    return div(styles.container, _, [div(styles.label, _, label), children]);\r\n}\r\n","import { Events, onClick } from \"ivi\";\r\nimport { span } from \"ivi-html\";\r\nimport * as styles from \"./switch.scss\";\r\nexport function Switch(props) {\r\n    function handler() {\r\n        props.onCheck(!props.checked);\r\n    }\r\n    return Events(onClick(handler), span(styles.xswitch, undefined, [\r\n        span(styles.switchButtonContainer, {\r\n            style: {\r\n                transform: props.checked\r\n                    ? \"translate(0.75rem, -0.125rem)\"\r\n                    : \"translate(0, -0.125rem)\",\r\n            },\r\n        }, span(styles.switchButton +\r\n            \" \" +\r\n            (props.checked ? styles.bgColorPrimary : styles.bgColorSecondary))),\r\n        span(styles.switchBar),\r\n    ]));\r\n}\r\n","import { lerp, distance, Vec2 } from \"../util\";\r\nexport function init(prevPoint) {\r\n    return { prevPoint };\r\n}\r\nexport function interpolate(brush, state, end) {\r\n    if (state === null) {\r\n        const brushPoint = {\r\n            alpha: end.alpha,\r\n            color: end.color,\r\n            position: end.position,\r\n            rotation: end.rotation,\r\n            scaledDiameter: brush.diameterPx * end.pressure,\r\n        };\r\n        return [{ prevPoint: end }, [brushPoint]];\r\n    }\r\n    const start = state.prevPoint;\r\n    const spacingPx = brush.spacingPct * brush.diameterPx;\r\n    // const pcts =\r\n    //     brush.pressureAffectsSize && start.pressure !== end.pressure\r\n    //         ? interpolateWithPressureScaling(spacingPx, start, end)\r\n    //         : interpolateNormal(spacingPx, start, end)\r\n    const pcts = interpolateWithPressureScaling(spacingPx, start, end);\r\n    if (pcts.length === 0) {\r\n        return [state, []];\r\n    }\r\n    const pressureIsEq = start.pressure === end.pressure;\r\n    const alphaIsEq = start.alpha === end.alpha;\r\n    const colorIsEq = start.color.is(end.color);\r\n    const rotationIsEq = start.rotation === end.rotation;\r\n    const pctsLen = pcts.length;\r\n    const brushPoints = new Array(pctsLen);\r\n    for (let i = 0; i < pctsLen; i++) {\r\n        const pct = pcts[i];\r\n        const alpha = alphaIsEq ? start.alpha : lerp(pct, start.alpha, end.alpha);\r\n        const color = colorIsEq ? start.color : start.color.mix(pct, end.color);\r\n        const position = Vec2.lerp(pct, start.position, end.position);\r\n        const scaledDiameter = brush.diameterPx *\r\n            (pressureIsEq ? start.pressure : lerp(pct, start.pressure, end.pressure));\r\n        const rotation = rotationIsEq ? start.rotation : lerp(pct, start.rotation, end.rotation);\r\n        brushPoints[i] = {\r\n            alpha,\r\n            color,\r\n            position,\r\n            scaledDiameter,\r\n            rotation,\r\n        };\r\n    }\r\n    const lastBrushPoint = brushPoints[pcts.length - 1];\r\n    const prevPoint = {\r\n        alpha: lastBrushPoint.alpha,\r\n        color: lastBrushPoint.color,\r\n        position: lastBrushPoint.position,\r\n        pressure: lerp(pcts[pcts.length - 1], start.pressure, end.pressure),\r\n        rotation: lastBrushPoint.rotation,\r\n    };\r\n    return [{ prevPoint }, brushPoints];\r\n}\r\n// TODO: fix this optimization\r\nfunction interpolateNormal(spacingPx, start, end) {\r\n    const totalDist = Vec2.distance(start.position, end.position);\r\n    const count = Math.floor(totalDist / spacingPx);\r\n    const arr = new Array(count);\r\n    for (let i = 0; i < count; i++) {\r\n        arr[i] = (i * spacingPx) / totalDist;\r\n    }\r\n    return arr;\r\n}\r\n// Potential optimization?: the if condition can probably be avoided\r\nfunction interpolateWithPressureScaling(spacingPx, start, end) {\r\n    const arr = [];\r\n    const endX = end.position.x;\r\n    const endY = end.position.y;\r\n    const endPressure = end.pressure;\r\n    const endSpacing = Math.max(spacingPx * endPressure, 0.05);\r\n    let x = start.position.x;\r\n    let y = start.position.y;\r\n    let pressure = start.pressure;\r\n    const totalDist = distance(x, y, endX, endY);\r\n    let dist = totalDist;\r\n    let p = 0.5;\r\n    let prevX = x;\r\n    let prevY = y;\r\n    let prevPressure = pressure;\r\n    while (dist > endSpacing && p > 0) {\r\n        p = (spacingPx * pressure) / dist;\r\n        x += p * (endX - x);\r\n        y += p * (endY - y);\r\n        pressure += p * (endPressure - pressure);\r\n        dist = distance(x, y, endX, endY);\r\n        if (x !== prevX || y !== prevY || pressure !== prevPressure) {\r\n            arr.push(1 - dist / totalDist);\r\n            prevX = x;\r\n            prevY = y;\r\n            prevPressure = pressure;\r\n        }\r\n    }\r\n    return arr;\r\n}\r\n","export const SVG_NAMESPACE = \"http://www.w3.org/2000/svg\";\nexport const XLINK_NAMESPACE = \"http://www.w3.org/1999/xlink\";\nexport const XML_NAMESPACE = \"http://www.w3.org/XML/1998/namespace\";\n//# sourceMappingURL=namespaces.js.map","import { SELECT_TOKEN, UNMOUNT_TOKEN } from \"../core\";\nimport { doc, objectHasOwnProperty, nodeInsertBefore, nodeRemoveChild, elementSetAttribute, nodeCloneNode, nodeSetTextContent, elementRemoveAttribute, elementSetClassName, htmlElementGetStyle, svgElementGetStyle, } from \"../dom/shortcuts\";\nimport { SVG_NAMESPACE } from \"../dom/namespaces\";\nimport { createStateNode } from \"./state\";\nimport { setContext, pushContext } from \"./context\";\nlet _nextNode;\nlet _deepStateFlags;\nexport function _resetState() {\n    _nextNode = null;\n    _deepStateFlags = 0;\n}\nexport function visitNodes(opState, visitor) {\n    let i = visitor(opState);\n    if (i !== 0 /* Continue */) {\n        return (i & 1 /* StopImmediate */);\n    }\n    const { f, c } = opState;\n    if ((f & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n        for (i = 0; i < c.length; i++) {\n            if ((opState = c[i]) !== null &&\n                (visitNodes(opState, visitor) & 1 /* StopImmediate */) !== 0) {\n                return 1 /* StopImmediate */;\n            }\n        }\n    }\n    else if (c !== null) {\n        return visitNodes(c, visitor);\n    }\n    return 0 /* Continue */;\n}\nexport function getDOMNode(opState) {\n    let i = opState.f;\n    let c;\n    if ((i & (2 /* Element */ | 1 /* Text */)) === 0) {\n        opState = opState.c;\n        if ((i & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n            for (i = 0; i < opState.length; i++) {\n                if ((c = opState[i]) !== null) {\n                    return getDOMNode(c);\n                }\n            }\n            return null;\n        }\n        if (opState === null) {\n            return null;\n        }\n        return getDOMNode(opState);\n    }\n    return opState.s;\n}\nexport function _dirtyCheck(parentElement, opState, moveNode, singleChild) {\n    const flags = opState.f;\n    let state;\n    let c;\n    let i;\n    let f;\n    if ((flags & 256 /* Stateful */) !== 0) {\n        state = opState.s;\n        if (((flags & 1024 /* Dirty */) !== 0) ||\n            (state.s !== null && state.s(SELECT_TOKEN) === true)) {\n            opState.c = _update(parentElement, opState.c, state.r(opState.o.v), moveNode, singleChild);\n        }\n        else if ((flags & 65536 /* DeepStateDirtyCheck */) !== 0) {\n            _dirtyCheck(parentElement, opState.c, moveNode, singleChild);\n        }\n        else {\n            if (moveNode === true) {\n                _moveNodes(parentElement, opState);\n            }\n            else {\n                _nextNode = getDOMNode(opState);\n            }\n        }\n        opState.f = (opState.f & 64511 /* SelfFlags */) | _deepStateFlags;\n        _deepStateFlags |= (opState.f & 49152 /* DeepStateFlags */) << 2 /* DeepStateShift */;\n    }\n    else if ((flags & 65536 /* DeepStateDirtyCheck */) !== 0) {\n        // Checking for `children === null` is unnecessary, `DeepStateDirtyCheck` flag guarantees that element should\n        // have children nodes.\n        c = opState.c;\n        if ((flags & 2 /* Element */) !== 0) {\n            state = opState.s;\n            if (moveNode === true) {\n                nodeInsertBefore.call(parentElement, state, _nextNode);\n            }\n            _nextNode = null;\n            _dirtyCheck(state, c, false, true);\n            _nextNode = state;\n        }\n        else if ((flags & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n            f = 0;\n            i = c.length;\n            while (i > 0) {\n                if ((state = c[--i]) !== null) {\n                    _dirtyCheck(parentElement, state, moveNode, false);\n                    f |= _deepStateFlags;\n                    _deepStateFlags = 0;\n                }\n            }\n            _deepStateFlags = f;\n        }\n        else if ((flags & (16 /* Events */ | 4 /* Component */)) !== 0) {\n            _dirtyCheck(parentElement, c, moveNode, singleChild);\n        }\n        else { // ((f & NodeFlags.Context) !== 0)\n            state = setContext(opState.s);\n            _dirtyCheck(parentElement, c, moveNode, singleChild);\n            setContext(state);\n        }\n        opState.f = (flags & 64511 /* SelfFlags */) | _deepStateFlags;\n    }\n    else {\n        if (moveNode === true) {\n            _moveNodes(parentElement, opState);\n        }\n        else {\n            _nextNode = getDOMNode(opState);\n        }\n        _deepStateFlags = flags & (49152 /* DeepStateFlags */ << 2 /* DeepStateShift */);\n    }\n}\nfunction _moveNodes(parentElement, opState) {\n    const flags = opState.f;\n    let children;\n    let c;\n    let i;\n    if ((flags & (2 /* Element */ | 1 /* Text */)) !== 0) {\n        c = opState.s;\n        nodeInsertBefore.call(parentElement, c, _nextNode);\n        _nextNode = c;\n    }\n    else {\n        children = opState.c;\n        if ((flags & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n            i = children.length;\n            while (i > 0) {\n                if ((c = children[--i]) !== null) {\n                    _moveNodes(parentElement, c);\n                }\n            }\n        }\n        else if (children !== null) {\n            _moveNodes(parentElement, children);\n        }\n    }\n}\nfunction _unmountWalk(opState) {\n    const flags = opState.f;\n    let children;\n    let i;\n    let v;\n    if ((flags & 131072 /* DeepStateUnmount */) !== 0) {\n        if ((children = opState.c) !== null) {\n            if ((flags & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n                for (i = 0; i < children.length; i++) {\n                    if ((v = children[i]) !== null) {\n                        _unmountWalk(v);\n                    }\n                }\n            }\n            else {\n                _unmountWalk(children);\n            }\n        }\n    }\n    if ((flags & 32768 /* Unmount */) !== 0) {\n        if ((v = opState.s.u) !== null) {\n            if (typeof v === \"function\") {\n                v(UNMOUNT_TOKEN);\n            }\n            else {\n                for (i = 0; i < v.length; i++) {\n                    v[i](UNMOUNT_TOKEN);\n                }\n            }\n        }\n    }\n}\nfunction _unmountRemove(parentElement, opState, singleChild) {\n    let i = opState.f;\n    let c;\n    if ((i & (2 /* Element */ | 1 /* Text */)) !== 0) {\n        nodeRemoveChild.call(parentElement, opState.s);\n    }\n    else {\n        opState = opState.c;\n        if ((i & (8 /* TrackByKey */ | 128 /* Fragment */)) !== 0) {\n            if (singleChild === true) {\n                nodeSetTextContent.call(parentElement, \"\");\n            }\n            else {\n                for (i = 0; i < opState.length; ++i) {\n                    if ((c = opState[i]) !== null) {\n                        _unmountRemove(parentElement, c, false);\n                    }\n                }\n            }\n        }\n        else if (opState !== null) {\n            _unmountRemove(parentElement, opState, singleChild);\n        }\n    }\n}\nexport function _unmount(parentElement, opState, singleChild) {\n    _unmountRemove(parentElement, opState, singleChild);\n    _unmountWalk(opState);\n}\nfunction _mountText(parentElement, opState, op) {\n    const node = doc.createTextNode(op);\n    nodeInsertBefore.call(parentElement, node, _nextNode);\n    _nextNode = node;\n    opState.s = node;\n    opState.f = 1 /* Text */;\n}\nfunction _createElement(node, op) {\n    const { t, v, n } = op;\n    const svg = (t.f & 512 /* Svg */) !== 0;\n    if (node === void 0) {\n        const tagName = t.d;\n        node = svg ?\n            doc.createElementNS(SVG_NAMESPACE, tagName) :\n            doc.createElement(tagName);\n    }\n    if (n) {\n        _updateClassName(node, n, svg);\n    }\n    if (v !== void 0) {\n        _updateAttrs(node, void 0, v, svg);\n    }\n    return node;\n}\nfunction _mountObject(parentElement, opState, op) {\n    const opType = op.t; // polymorphic callsite\n    const flags = opType.f;\n    let prevState;\n    let value;\n    let node;\n    let i;\n    let f;\n    if ((flags & 4 /* Component */) !== 0) {\n        if ((flags & 256 /* Stateful */) !== 0) {\n            opState.s = prevState = { r: null, s: null, u: null };\n            // Reusing value variable.\n            prevState.r = value = opType.d.c(opState);\n        }\n        else {\n            value = opType.d.c;\n        }\n        opState.c = _mount(parentElement, value(op.v));\n        opState.f |= flags | _deepStateFlags;\n        _deepStateFlags |= (opState.f & 49152 /* DeepStateFlags */) << 2 /* DeepStateShift */;\n    }\n    else {\n        if ((flags & 2 /* Element */) !== 0) {\n            value = opType.d;\n            if ((flags & 64 /* ElementProto */) !== 0) {\n                node = value.n;\n                if (node === null) {\n                    value.n = node = _createElement(void 0, value.p);\n                }\n                node = nodeCloneNode.call(node, false);\n            }\n            opState.s = node = _createElement(node, op);\n            prevState = _nextNode;\n            if ((value = op.c) !== null) {\n                _nextNode = null;\n                opState.c = _mount(node, value);\n            }\n            _nextNode = node;\n            nodeInsertBefore.call(parentElement, node, prevState);\n        }\n        else if ((flags & (16 /* Events */ | 32 /* Context */)) !== 0) {\n            if ((flags & 32 /* Context */) !== 0) {\n                opState.s = prevState = ((flags & 8192 /* SetContextState */) !== 0) ?\n                    setContext(op.v) :\n                    pushContext(opType.d, op.v);\n                opState.c = _mount(parentElement, op.c);\n                setContext(prevState);\n            }\n            else {\n                opState.c = _mount(parentElement, op.c);\n            }\n        }\n        else { // ((opFlags & NodeFlags.TrackByKey) !== 0)\n            f = 0;\n            node = op.v;\n            i = node.length;\n            opState.c = value = Array(i);\n            while (i > 0) {\n                value[--i] = _mount(parentElement, node[i].v);\n                f |= _deepStateFlags;\n                _deepStateFlags = 0;\n            }\n            _deepStateFlags = f;\n        }\n        opState.f = flags | _deepStateFlags;\n    }\n}\nfunction _mountFragment(parentElement, opState, childrenOps) {\n    let i = childrenOps.length;\n    let f = 0;\n    const newChildren = Array(i);\n    while (i > 0) {\n        newChildren[--i] = _mount(parentElement, childrenOps[i]);\n        f |= _deepStateFlags;\n        _deepStateFlags = 0;\n    }\n    _deepStateFlags = f;\n    opState.c = newChildren;\n    opState.f = 128 /* Fragment */ | f;\n}\nexport function _mount(parentElement, op) {\n    if (op !== null) {\n        const opState = createStateNode(op);\n        if (typeof op === \"object\") {\n            if (op instanceof Array) {\n                _mountFragment(parentElement, opState, op);\n            }\n            else {\n                _mountObject(parentElement, opState, op);\n            }\n        }\n        else {\n            _mountText(parentElement, opState, op);\n        }\n        return opState;\n    }\n    return null;\n}\n/**\n * _update updates a stateNode with a next operation.\n *\n * @param parentElement Parent DOM Element.\n * @param opState Operation state.\n * @param nextOp Next operation.\n * @param moveNode DOM Element should be moved.\n * @param singleChild Parent DOM Element contains a single child.\n * @returns OpNode state.\n */\nexport function _update(parentElement, opState, nextOp, moveNode, singleChild) {\n    if (nextOp === null) {\n        if (opState !== null) {\n            _unmount(parentElement, opState, singleChild);\n        }\n        return null;\n    }\n    if (opState === null) {\n        return _mount(parentElement, nextOp);\n    }\n    const { f, o, s } = opState;\n    if ((f & 1 /* Text */) !== 0) {\n        if (typeof nextOp !== \"object\") {\n            // Reassign to reduce memory consumption even if nextOp is strictly equal to the prev op.\n            opState.o = nextOp;\n            if (o !== nextOp) {\n                s.nodeValue = nextOp;\n            }\n            if (moveNode === true) {\n                nodeInsertBefore.call(parentElement, s, _nextNode);\n            }\n            _nextNode = s;\n        }\n        else {\n            nodeRemoveChild.call(parentElement, s);\n            return _mount(parentElement, nextOp);\n        }\n    }\n    else {\n        // Here we don't need to reassign nextOp because op should always be an object, and strict equality will guarantee\n        // that this object is occupying the same memory region.\n        if (o === nextOp) {\n            _dirtyCheck(parentElement, opState, moveNode, singleChild);\n            return opState;\n        }\n        if (((f & 128 /* Fragment */) !== 0 ?\n            !(nextOp instanceof Array) :\n            (nextOp instanceof Array ||\n                o.t !== nextOp.t // polymorphic callsites\n            ))) {\n            _unmount(parentElement, opState, singleChild);\n            return _mount(parentElement, nextOp);\n        }\n        opState.o = nextOp;\n        const opStateChildren = opState.c;\n        let prevData;\n        let nextData;\n        let nextValue;\n        let i;\n        let deepState;\n        if ((f & 4 /* Component */) !== 0) {\n            prevData = o.v;\n            nextData = nextOp.v;\n            nextValue = nextOp.t.d;\n            if ((prevData !== nextData) &&\n                (nextValue.e === void 0 || nextValue.e(prevData, nextData) !== true)) {\n                opState.c = _update(parentElement, opStateChildren, ((f & 256 /* Stateful */) !== 0) ?\n                    s.r(nextData) :\n                    nextValue.c(nextData), moveNode, singleChild);\n                opState.f = (opState.f & 64511 /* SelfFlags */) | _deepStateFlags;\n                _deepStateFlags |= (opState.f & 49152 /* DeepStateFlags */) << 2 /* DeepStateShift */;\n            }\n            else {\n                _dirtyCheck(parentElement, opState, moveNode, singleChild);\n            }\n        }\n        else {\n            if ((f & 2 /* Element */) !== 0) {\n                i = (f & 512 /* Svg */) !== 0;\n                if (moveNode === true) {\n                    nodeInsertBefore.call(parentElement, s, _nextNode);\n                }\n                nextValue = nextOp.n;\n                if (o.n !== nextValue) {\n                    if (nextValue === void 0) {\n                        nextValue = \"\";\n                    }\n                    _updateClassName(s, nextValue, i);\n                }\n                nextValue = nextOp.v;\n                if (o.v !== nextValue) {\n                    _updateAttrs(s, o.v, nextValue, i);\n                }\n                _nextNode = null;\n                opState.c = _update(s, opStateChildren, nextOp.c, false, true);\n                _nextNode = s;\n            }\n            else if ((f & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n                if ((f & 128 /* Fragment */) !== 0) {\n                    i = nextOp.length;\n                    if (i === 0) {\n                        _unmount(parentElement, opState, singleChild);\n                    }\n                    else {\n                        deepState = 0;\n                        prevData = opStateChildren.length;\n                        if (i !== prevData) {\n                            opState.c = nextValue = Array(i);\n                            while (prevData > i) {\n                                nextData = opStateChildren[--prevData];\n                                if (nextData !== null) {\n                                    _unmount(parentElement, nextData, false);\n                                }\n                            }\n                            while (i > prevData) {\n                                nextValue[--i] = _mount(parentElement, nextOp[i]);\n                                deepState |= _deepStateFlags;\n                                _deepStateFlags = 0;\n                            }\n                        }\n                        else {\n                            nextValue = opStateChildren;\n                        }\n                        while (i > 0) {\n                            nextValue[--i] = _update(parentElement, opStateChildren[i], nextOp[i], moveNode, false);\n                            deepState |= _deepStateFlags;\n                            _deepStateFlags = 0;\n                        }\n                        _deepStateFlags = deepState;\n                    }\n                }\n                else {\n                    _updateChildrenTrackByKeys(parentElement, opState, o.v, nextOp.v, moveNode, singleChild);\n                }\n            }\n            else if ((f & 16 /* Events */) !== 0) {\n                opState.c = _update(parentElement, opStateChildren, nextOp.c, moveNode, singleChild);\n            }\n            else { // if ((flags & NodeFlags.Context) !== 0) {\n                nextData = nextOp.v;\n                if ((f & 8192 /* SetContextState */) !== 0) {\n                    opState.s = nextData;\n                }\n                else {\n                    s.v = nextData;\n                }\n                nextValue = setContext(opState.s);\n                opState.c = _update(parentElement, opStateChildren, nextOp.c, moveNode, singleChild);\n                setContext(nextValue);\n            }\n            opState.f = (f & 64511 /* SelfFlags */) | _deepStateFlags;\n        }\n    }\n    return opState;\n}\n/**\n * Update children list with track by key algorithm.\n *\n * High-level overview of the algorithm that is implemented in this function (slightly outdated, but the key ideas are\n * the same).\n *\n * This algorithm finds a minimum[1] number of DOM operations. It works in several steps:\n *\n * 1. Find common suffix and prefix.\n *\n * This optimization technique is searching for nodes with identical keys by simultaneously iterating over nodes in the\n * old children list `A` and new children list `B` from both sides:\n *\n *  A: -> [a b c d] <-\n *  B: -> [a b d] <-\n *\n * Here we can skip nodes \"a\" and \"b\" at the begininng, and node \"d\" at the end.\n *\n *  A: -> [c] <-\n *  B: -> [] <-\n *\n * Here it will check if the size of one of the list is equal to zero. When length of the old children list is zero,\n * it will insert all remaining nodes from the new list, and when length of the new children list is zero, it will\n * remove all remaining nodes from the old list.\n *\n * When algorithm can't find a solution with this simple optimization technique, it will go to the next step of the\n * algorithm. For example:\n *\n *  A: -> [a b c d e f g] <-\n *  B: -> [a c b h f e g] <-\n *\n * Nodes \"a\" and \"g\" at the edges are the same, skipping them.\n *\n *  A: -> [b c d e f] <-\n *  B: -> [c b h f e] <-\n *\n * Here we are stuck, so we need to switch to the next step.\n *\n * 2. Look for removed and inserted nodes, and simultaneously check if one of the nodes is moved.\n *\n * First we create an array `P` with the length of the new children list and assign to each position value `-1`, it has\n * a meaning of a new node that should be inserted. Later we will assign node positions in the old children list to this\n * array.\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *  P: [. . . . .] // . == -1\n *\n * Then we need to build an index `I` that maps keys with node positions of the remaining nodes from the new children\n * list.\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *  P: [. . . . .] // . == -1\n *  I: {\n *    c: 0,\n *    b: 1,\n *    h: 2,\n *    f: 3,\n *    e: 4,\n *  }\n *  last = 0\n *\n * With this index, we start to iterate over the remaining nodes from the old children list and check if we can find a\n * node with the same key in the index. If we can't find any node, it means that it should be removed, otherwise we\n * assign position of the node in the old children list to the positions array.\n *\n *  A: [b c d e f]\n *      ^\n *  B: [c b h f e]\n *  P: [. 0 . . .] // . == -1\n *  I: {\n *    c: 0,\n *    b: 1, <-\n *    h: 2,\n *    f: 3,\n *    e: 4,\n *  }\n *  last = 1\n *\n * When we assigning positions to the positions array, we also keep a position of the last seen node in the new children\n * list, if the last seen position is larger than current position of the node at the new list, then we are switching\n * `moved` flag to `true`.\n *\n *  A: [b c d e f]\n *        ^\n *  B: [c b h f e]\n *  P: [1 0 . . .] // . == -1\n *  I: {\n *    c: 0, <-\n *    b: 1,\n *    h: 2,\n *    f: 3,\n *    e: 4,\n *  }\n *  last = 1 // last > 0; moved = true\n *\n * The last position `1` is larger than current position of the node at the new list `0`, switching `moved` flag to\n * `true`.\n *\n *  A: [b c d e f]\n *          ^\n *  B: [c b h f e]\n *  P: [1 0 . . .] // . == -1\n *  I: {\n *    c: 0,\n *    b: 1,\n *    h: 2,\n *    f: 3,\n *    e: 4,\n *  }\n *  moved = true\n *\n * Node with key \"d\" doesn't exist in the index, removing node.\n *\n *  A: [b c d e f]\n *            ^\n *  B: [c b h f e]\n *  P: [1 0 . . 3] // . == -1\n *  I: {\n *    c: 0,\n *    b: 1,\n *    h: 2,\n *    f: 3,\n *    e: 4, <-\n *  }\n *  moved = true\n *\n * Assign position for `e`.\n *\n *  A: [b c d e f]\n *              ^\n *  B: [c b h f e]\n *  P: [1 0 . 4 3] // . == -1\n *  I: {\n *    c: 0,\n *    b: 1,\n *    h: 2,\n *    f: 3, <-\n *    e: 4,\n *  }\n *  moved = true\n *\n * Assign position for 'f'.\n *\n * At this point we are checking if `moved` flag is on, or if the length of the old children list minus the number of\n * removed nodes isn't equal to the length of the new children list. If any of this conditions is true, then we are\n * going to the next step.\n *\n * 3. Find minimum number of moves if `moved` flag is on, or insert new nodes if the length is changed.\n *\n * When `moved` flag is on, we need to find the\n * [longest increasing subsequence](http://en.wikipedia.org/wiki/Longest_increasing_subsequence) in the positions array,\n * and move all nodes that doesn't belong to this subsequence.\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *  P: [1 0 . 4 3] // . == -1\n *  LIS:     [1 4]\n *  moved = true\n *\n * Now we just need to simultaneously iterate over the new children list and LIS from the end and check if the current\n * position is equal to a value from LIS.\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *              ^  // new_pos == 4\n *  P: [1 0 . 4 3] // . == -1\n *  LIS:     [1 4]\n *              ^  // new_pos == 4\n *  moved = true\n *\n * Node \"e\" stays at the same place.\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *            ^    // new_pos == 3\n *  P: [1 0 . 4 3] // . == -1\n *  LIS:     [1 4]\n *            ^    // new_pos != 1\n *  moved = true\n *\n * Node \"f\" is moved, move it before the next node \"e\".\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *          ^      // new_pos == 2\n *  P: [1 0 . 4 3] // . == -1\n *          ^      // old_pos == -1\n *  LIS:     [1 4]\n *            ^\n *  moved = true\n *\n * Node \"h\" has a `-1` value in the positions array, insert new node \"h\".\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *        ^        // new_pos == 1\n *  P: [1 0 . 4 3] // . == -1\n *  LIS:     [1 4]\n *            ^    // new_pos == 1\n *  moved = true\n *\n * Node \"b\" stays at the same place.\n *\n *  A: [b c d e f]\n *  B: [c b h f e]\n *      ^          // new_pos == 0\n *  P: [1 0 . 4 3] // . == -1\n *  LIS:     [1 4]\n *          ^      // new_pos != undefined\n *  moved = true\n *\n * Node \"c\" is moved, move it before the next node \"b\".\n *\n * When moved flag is off, we don't need to find LIS, and we just iterate over the new children list and check its\n * current position in the positions array, if it is `-1`, then we insert new node.\n *\n * [1] Actually it is almost minimum number of dom ops, when node is removed and another one is inserted at the same\n * place, instead of insert and remove dom ops, we can use one replace op. It will make everything even more\n * complicated, and other use cases will be slower, so I don't think that it is worth to use replace here.\n *\n * @param parentElement Parent DOM element.\n * @param opState OpNode state for a TrackByKey operation.\n * @param a Previous operations.\n * @param b Next operations.\n * @param moveNode Children DOM nodes should be moved.\n * @param singleChild Parent DOM element contains a single node.\n * @noinline\n */\nfunction _updateChildrenTrackByKeys(parentElement, opState, a, b, moveNode, singleChild) {\n    let i = b.length;\n    let j = a.length;\n    let deepState = 0;\n    const result = Array(i);\n    if (i === 0) { // New children list is empty.\n        if (j > 0) { // Unmount nodes from the old children list.\n            _unmount(parentElement, opState, singleChild);\n        }\n    }\n    else if (j === 0) { // Old children list is empty.\n        while (i > 0) { // Mount nodes from the new children list.\n            result[--i] = _mount(parentElement, b[i].v);\n            deepState |= _deepStateFlags;\n            _deepStateFlags = 0;\n        }\n    }\n    else {\n        const opStateChildren = opState.c;\n        let aEnd = j - 1; // a.length - 1\n        let bEnd = i - 1; // b.length - 1\n        let start = 0;\n        let node = b[bEnd];\n        // Step 1\n        outer: while (true) {\n            // Update nodes with the same key at the end.\n            while (a[aEnd].k === node.k) {\n                result[bEnd] = _update(parentElement, opStateChildren[aEnd--], node.v, moveNode, false);\n                deepState |= _deepStateFlags;\n                _deepStateFlags = 0;\n                if (start > --bEnd || start > aEnd) {\n                    break outer;\n                }\n                node = b[bEnd];\n            }\n            // Update nodes with the same key at the beginning.\n            while (a[start].k === b[start].k && ++start <= aEnd && start <= bEnd) {\n                // delayed update (all updates should be performed from right-to-left).\n            }\n            break;\n        }\n        if (start > aEnd) {\n            // All nodes from `a` are updated, insert the rest from `b`.\n            while (bEnd >= start) {\n                result[bEnd] = _mount(parentElement, b[bEnd--].v);\n                deepState |= _deepStateFlags;\n                _deepStateFlags = 0;\n            }\n        }\n        else if (start > bEnd) {\n            // All nodes from `b` are updated, remove the rest from `a`.\n            i = start;\n            do {\n                if ((node = opStateChildren[i++]) !== null) {\n                    _unmount(parentElement, node, false);\n                }\n            } while (i <= aEnd);\n        }\n        else { // Step 2\n            // When `pos === 99999999`, it means that one of the nodes is in the wrong position and we should rearrange nodes\n            // with lis-based algorithm.\n            let pos = 0;\n            // Number of updated nodes after prefix/suffix phase. It is used for an optimization that removes all child nodes\n            // with `textContent=\"\"` when there are no updated nodes.\n            let updated = 0;\n            const aLength = aEnd - start + 1;\n            const bLength = bEnd - start + 1;\n            const sources = Array(bLength); // Maps positions in the new children list to positions in the old children list.\n            const keyIndex = new Map(); // Maps keys to their positions in the new children list.\n            for (i = 0; i < bLength; ++i) {\n                j = i + start;\n                sources[i] = -1; // Special value `-1` indicates that node doesn't exist in the old children list.\n                keyIndex.set(b[j].k, j);\n            }\n            for (i = start; i <= aEnd && updated < bLength; ++i) {\n                j = keyIndex.get(a[i].k);\n                if (j !== void 0) {\n                    pos = (pos < j) ? j : 99999999;\n                    ++updated;\n                    sources[j - start] = i;\n                    result[j] = opStateChildren[i];\n                    // remove updated nodes from previous array, so that we could remove the rest from the document.\n                    opStateChildren[i] = null;\n                }\n            }\n            if (aLength === a.length && updated === 0) {\n                // Zero updated nodes in step 1 and 2, remove all nodes and insert new ones.\n                _unmount(parentElement, opState, singleChild);\n                while (bEnd >= 0) {\n                    result[bEnd] = _mount(parentElement, b[bEnd--].v);\n                    deepState |= _deepStateFlags;\n                    _deepStateFlags = 0;\n                }\n            }\n            else {\n                // Step 3\n                // Remove nodes that weren't updated in the old children list.\n                for (i = start; i <= aEnd; i++) {\n                    if ((node = opStateChildren[i]) !== null) {\n                        _unmount(parentElement, node, false);\n                    }\n                }\n                i = bLength;\n                if (moveNode === true || pos !== 99999999) {\n                    while (i > 0) {\n                        pos = --i + start;\n                        node = b[pos].v;\n                        result[pos] = (sources[i] === -1) ?\n                            _mount(parentElement, node) :\n                            _update(parentElement, result[pos], node, moveNode, false);\n                        deepState |= _deepStateFlags;\n                        _deepStateFlags = 0;\n                    }\n                }\n                else {\n                    const seq = lis(sources);\n                    j = seq.length - 1;\n                    while (i > 0) {\n                        pos = --i + start;\n                        node = b[pos].v;\n                        if (sources[i] === -1) {\n                            result[pos] = _mount(parentElement, node);\n                        }\n                        else {\n                            if (j < 0 || i !== seq[j]) {\n                                moveNode = true;\n                            }\n                            else {\n                                --j;\n                            }\n                            result[pos] = _update(parentElement, result[pos], node, moveNode, false);\n                            moveNode = false;\n                        }\n                        deepState |= _deepStateFlags;\n                        _deepStateFlags = 0;\n                    }\n                }\n            }\n        }\n        // update nodes from Step 1 (prefix only)\n        while (start > 0) {\n            result[--start] = _update(parentElement, opStateChildren[start], b[start].v, moveNode, false);\n            deepState |= _deepStateFlags;\n            _deepStateFlags = 0;\n        }\n    }\n    opState.c = result;\n    _deepStateFlags = deepState;\n}\n/**\n * Slightly modified Longest Increased Subsequence algorithm, it ignores items that have -1 value, they're representing\n * new items.\n *\n * {@link http://en.wikipedia.org/wiki/Longest_increasing_subsequence}\n *\n * It is possible to use typed arrays in this function, and it will make it faster in most javascript engines, but for\n * some reason instantiating small typed arrays is slower in synthetic microbenchmarks on V8\n * {@link https://gist.github.com/localvoid/88da772d987794605f7fa4a078bce4d6} (maybe there is something wrong in this\n * benchmarks, if someone want to spend more time on optimizations, I'd recommend to double check everything).\n *\n * To solve problem with instantiation, we could just reuse arrays, but in my opinion it isn't worth to overcomplicate\n * this algorithm since it is already extremely fast and it is highly unlikely that it will be even noticeable in the\n * profiler. Usually when there is an update in the real applications, it triggers reordering of one dynamic children\n * list, that is why I prefer to keep it simple.\n *\n * @param a - Array of numbers\n * @returns Longest increasing subsequence\n * @noinline\n */\nfunction lis(a) {\n    const p = a.slice();\n    // result is instantiated as an empty array to prevent instantiation with CoW backing store.\n    const result = [];\n    let n = 0;\n    let i = 0;\n    let u;\n    let v;\n    let j;\n    result[0] = 0;\n    for (; i < a.length; ++i) {\n        const k = a[i];\n        if (k > -1) {\n            j = result[n];\n            if (a[j] < k) {\n                p[i] = j;\n                result[++n] = i;\n            }\n            else {\n                u = 0;\n                v = n;\n                while (u < v) {\n                    j = (u + v) >> 1;\n                    if (a[result[j]] < k) {\n                        u = j + 1;\n                    }\n                    else {\n                        v = j;\n                    }\n                }\n                if (k < a[result[u]]) {\n                    if (u > 0) {\n                        p[i] = result[u - 1];\n                    }\n                    result[u] = i;\n                }\n            }\n        }\n    }\n    v = result[n];\n    while (n >= 0) {\n        result[n--] = v;\n        v = p[v];\n    }\n    return result;\n}\n/**\n * Update DOM classname.\n *\n * @param element DOM Element.\n * @param className Class name.\n * @param svg SVG Element.\n */\nfunction _updateClassName(element, className, svg) {\n    /**\n     * SVGElement.className returns `SVGAnimatedString`.\n     *\n     * #quirks\n     */\n    if (svg === true) {\n        elementSetAttribute.call(element, \"class\", className);\n    }\n    else {\n        elementSetClassName.call(element, className);\n    }\n}\n/**\n * Update DOM styles.\n *\n * @param element HTML or SVG Element.\n * @param a Prev styles.\n * @param b Next styles.\n */\nfunction _updateStyle(element, a, b, svg) {\n    const style = svg === true ? svgElementGetStyle.call(element) : htmlElementGetStyle.call(element);\n    let key;\n    let bValue;\n    if (a === void 0) {\n        // a is empty, insert all styles from b.\n        for (key in b) {\n            bValue = b[key];\n            if (bValue !== void 0) {\n                style.setProperty(key, bValue);\n            }\n        }\n    }\n    else if (b === void 0) {\n        // b is empty, remove all styles from a\n        for (key in a) {\n            if (a[key] !== void 0) {\n                style.removeProperty(key);\n            }\n        }\n    }\n    else {\n        let matchCount = 0;\n        let i = 0;\n        for (key in a) {\n            const aValue = a[key];\n            bValue = (objectHasOwnProperty.call(b, key) === true) ? (matchCount++, b[key]) : void 0;\n            if (aValue !== bValue) {\n                if (bValue !== void 0) {\n                    style.setProperty(key, bValue);\n                }\n                else {\n                    style.removeProperty(key);\n                }\n            }\n        }\n        const keys = Object.keys(b);\n        for (; matchCount < keys.length && i < keys.length; ++i) {\n            key = keys[i];\n            if (objectHasOwnProperty.call(a, key) === false) {\n                bValue = b[key];\n                ++matchCount;\n                if (bValue !== void 0) {\n                    style.setProperty(key, b[key]);\n                }\n            }\n        }\n    }\n}\n/**\n * Update DOM attributes.\n *\n * @param element DOM element.\n * @param a Prev DOM attributes.\n * @param b Next DOM attributes.\n */\nfunction _updateAttrs(element, a, b, svg) {\n    let key;\n    if (a === void 0) {\n        // a is empty, insert all attributes from b.\n        for (key in b) {\n            _updateAttr(element, key, void 0, b[key], svg);\n        }\n    }\n    else if (b === void 0) {\n        // b is empty, remove all attributes from a.\n        for (key in a) {\n            _updateAttr(element, key, a[key], void 0, svg);\n        }\n    }\n    else {\n        let matchCount = 0;\n        let i = 0;\n        for (key in a) {\n            _updateAttr(element, key, a[key], (objectHasOwnProperty.call(b, key) === true) ? (matchCount++, b[key]) : void 0, svg);\n        }\n        const keys = Object.keys(b);\n        for (; matchCount < keys.length && i < keys.length; ++i) {\n            key = keys[i];\n            if (objectHasOwnProperty.call(a, key) === false) {\n                _updateAttr(element, key, void 0, b[key], svg);\n                ++matchCount;\n            }\n        }\n    }\n}\n/**\n * Update DOM attribute.\n *\n * @param element DOM Element.\n * @param key Attribute name.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction _updateAttr(element, key, prev, next, svg) {\n    if (key !== \"style\") {\n        if (typeof next === \"object\") {\n            /* istanbul ignore else */\n            if (process.env.NODE_ENV !== \"production\") {\n                if (typeof prev !== \"object\" && prev !== void 0) {\n                    throw new Error(`Invalid DOM attribute, transitioning from basic values to attribute directives isn't allowed`);\n                }\n            }\n            next.u(element, key, prev === void 0 ? void 0 : prev.v, next.v);\n        }\n        else if (typeof prev === \"object\") {\n            /* istanbul ignore else */\n            if (process.env.NODE_ENV !== \"production\") {\n                if (typeof next !== \"object\" && next !== void 0) {\n                    throw new Error(`Invalid DOM attribute, transitioning from attribute directives to basic values isn't allowed`);\n                }\n            }\n            prev.u(element, key, prev.v, void 0);\n        }\n        else if (prev !== next) {\n            if (typeof next === \"boolean\") {\n                next = next ? \"\" : void 0;\n            }\n            if (next === void 0) {\n                if (prev !== void 0 && prev !== false) {\n                    elementRemoveAttribute.call(element, key);\n                }\n            }\n            else {\n                elementSetAttribute.call(element, key, next);\n            }\n        }\n    }\n    else if (prev !== next) {\n        _updateStyle(element, prev, next, svg);\n    }\n}\n//# sourceMappingURL=reconciler.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"views-menu__container--2nhom\",\"selectedDisplay\":\"views-menu__selectedDisplay--GVpTm\",\"selectedDisplayExpanded\":\"views-menu__selectedDisplayExpanded--2rS_4\",\"selectableOptions\":\"views-menu__selectableOptions--3CT9b\",\"optionDefault\":\"views-menu__optionDefault--Ra-YW\",\"optionSelected\":\"views-menu__optionSelected--3gQmu\"};","// Very basic and efficient immutable stack\r\nexport var Stack;\r\n(function (Stack) {\r\n    class Empty {\r\n        isEmpty() {\r\n            return true;\r\n        }\r\n        isNonEmpty() {\r\n            return false;\r\n        }\r\n        cons(value) {\r\n            return new NonEmpty(value, this);\r\n        }\r\n        foldl(_, initial) {\r\n            return initial;\r\n        }\r\n        reverse() {\r\n            return this;\r\n        }\r\n        toArray() {\r\n            return [];\r\n        }\r\n        toString() {\r\n            return \"()\";\r\n        }\r\n    }\r\n    Stack.Empty = Empty;\r\n    class NonEmpty {\r\n        constructor(head, tail) {\r\n            this.head = head;\r\n            this.tail = tail;\r\n        }\r\n        static of(value) {\r\n            return new NonEmpty(value, empty());\r\n        }\r\n        isEmpty() {\r\n            return false;\r\n        }\r\n        isNonEmpty() {\r\n            return true;\r\n        }\r\n        cons(value) {\r\n            return new NonEmpty(value, this);\r\n        }\r\n        foldl(f, initial) {\r\n            let stack = this;\r\n            let state = initial;\r\n            while (stack.isNonEmpty()) {\r\n                state = f(state, stack.head);\r\n                stack = stack.tail;\r\n            }\r\n            return state;\r\n        }\r\n        reverse() {\r\n            let nonReversed = this.tail;\r\n            let reversed = NonEmpty.of(this.head);\r\n            while (nonReversed.isNonEmpty()) {\r\n                reversed = reversed.cons(nonReversed.head);\r\n                nonReversed = nonReversed.tail;\r\n            }\r\n            return reversed;\r\n        }\r\n        toArray() {\r\n            const arr = [this.head];\r\n            let stack = this.tail;\r\n            while (stack.isNonEmpty()) {\r\n                arr.push(stack.head);\r\n                stack = stack.tail;\r\n            }\r\n            return arr;\r\n        }\r\n        toString() {\r\n            let str = \"(\" + this.head;\r\n            let stack = this.tail;\r\n            while (stack.isNonEmpty()) {\r\n                str = str + \", \" + stack.head;\r\n                stack = stack.tail;\r\n            }\r\n            return str + \")\";\r\n        }\r\n    }\r\n    Stack.NonEmpty = NonEmpty;\r\n    function empty() {\r\n        return new Empty();\r\n    }\r\n    Stack.empty = empty;\r\n    function fromArray(arr) {\r\n        let stack = empty();\r\n        let i = arr.length;\r\n        while (i--) {\r\n            stack = stack.cons(arr[i]);\r\n        }\r\n        return stack;\r\n    }\r\n    Stack.fromArray = fromArray;\r\n})(Stack || (Stack = {}));\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"xswitch\":\"views-switch__xswitch--ca3kq\",\"switchButtonContainer\":\"views-switch__switchButtonContainer--26j0i\",\"switchButton\":\"views-switch__switchButton--3PW3L\",\"bgColorPrimary\":\"views-switch__bgColorPrimary--2HWWs\",\"bgColorSecondary\":\"views-switch__bgColorSecondary--TM4-n\",\"switchBar\":\"views-switch__switchBar--3G205\"};","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import { _update, _dirtyCheck, _resetState } from \"./reconciler\";\nimport { enableContext, disableContext } from \"./context\";\n/**\n * Root nodes.\n */\nexport const ROOTS = [];\n/**\n * Find root node of a container.\n *\n * @param predicate - Find predicate.\n * @returns root node or undefined when root node doesn't exist.\n */\nexport const findRoot = (predicate) => ROOTS.find(predicate);\n/**\n * Performs a dirty checking.\n */\nexport function dirtyCheck() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        enableContext();\n    }\n    for (let i = 0; i < ROOTS.length; ++i) {\n        const root = ROOTS[i];\n        const { container, state, next } = root;\n        _resetState();\n        if (next !== void 0) {\n            root.next = void 0;\n            root.state = _update(container, state, next, false, true);\n        }\n        else if (state !== null) {\n            _dirtyCheck(container, state, false, true);\n        }\n    }\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n        disableContext();\n    }\n}\n//# sourceMappingURL=root.js.map","import * as Color from \"color\";\r\nimport { Generators as Gen } from \"../rng\";\r\nconst styleMap = {\r\n    \"--color-primary\": (theme) => theme.color.primary.toStyle(),\r\n    \"--color-primaryLight\": (theme) => theme.color.primaryLight.toStyle(),\r\n    \"--color-primaryDark\": (theme) => theme.color.primaryDark.toStyle(),\r\n    \"--color-secondary\": (theme) => theme.color.secondary.toStyle(),\r\n    \"--color-secondaryLight\": (theme) => theme.color.secondaryLight.toStyle(),\r\n    \"--color-secondaryDark\": (theme) => theme.color.secondaryDark.toStyle(),\r\n    \"--color-onPrimary\": (theme) => theme.color.onPrimary.toStyle(),\r\n    \"--color-onSecondary\": (theme) => theme.color.onSecondary.toStyle(),\r\n    \"--color-onSurface\": (theme) => theme.color.onSurface.toStyle(),\r\n    \"--color-surface\": (theme) => theme.color.surface.toStyle(),\r\n    \"--color-background\": (theme) => theme.color.background.toStyle(),\r\n    \"--shadows-button\": (theme) => theme.shadows.button,\r\n    \"--shadows-menu\": (theme) => theme.shadows.menu,\r\n    \"--shadows-surface\": (theme) => theme.shadows.surface,\r\n    \"--fonts-monospace\": (theme) => theme.fonts.monospace,\r\n    \"--fonts-normal\": (theme) => theme.fonts.normal,\r\n};\r\nexport function updateDiff(prevTheme, nextTheme) {\r\n    for (const propName in styleMap) {\r\n        if (!styleMap.hasOwnProperty(propName)) {\r\n            continue;\r\n        }\r\n        const toStyle = styleMap[propName];\r\n        const prevValue = toStyle(prevTheme);\r\n        const nextValue = toStyle(nextTheme);\r\n        if (prevValue === nextValue) {\r\n            continue;\r\n        }\r\n        document.body.style.setProperty(propName, nextValue);\r\n    }\r\n}\r\nexport function updateAll(theme) {\r\n    for (const propName in styleMap) {\r\n        if (!styleMap.hasOwnProperty(propName)) {\r\n            continue;\r\n        }\r\n        const toStyle = styleMap[propName];\r\n        document.body.style.setProperty(propName, toStyle(theme));\r\n    }\r\n}\r\nconst hsluvGen = (maxSat, luminance) => Gen.map3(Gen.float(0, 360), Gen.float(0, maxSat), Gen.always(luminance), (h, s, l) => new Color.Hsluv(h, s, l));\r\nconst colorsGen = Gen.object({\r\n    primary: hsluvGen(100, 80),\r\n    primaryLight: hsluvGen(100, 80),\r\n    primaryDark: hsluvGen(100, 80),\r\n    secondary: hsluvGen(100, 77),\r\n    secondaryLight: hsluvGen(100, 77),\r\n    secondaryDark: hsluvGen(100, 77),\r\n    background: hsluvGen(20, 46),\r\n    surface: hsluvGen(35, 38),\r\n    onPrimary: hsluvGen(100, 0),\r\n    onSecondary: hsluvGen(100, 0),\r\n    onSurface: hsluvGen(100, 100),\r\n});\r\nconst shadowsGen = Gen.always({\r\n    button: \"0 1px 5px 0 rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12)\",\r\n    surface: \"0 1px 5px 0 rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12)\",\r\n    menu: \"2px 2px 2px rgba(0, 0, 0, 0.45), 0 5px 8px 0 rgba(0, 0, 0, 0.3)\",\r\n});\r\nconst fontsGen = Gen.always({\r\n    normal: `\"Helvetica\", \"Arial\", sans-serif`,\r\n    monospace: `\"Courier New\", Courier, monospace`,\r\n});\r\nexport const random = Gen.object({\r\n    color: colorsGen,\r\n    shadows: shadowsGen,\r\n    fonts: fontsGen,\r\n});\r\n","import { createStateNode } from \"../vdom/state\";\nimport { pushContext, disableContext, enableContext, resetContext, getContext, setContext, } from \"../vdom/context\";\nimport { escapeAttributeValue, escapeText } from \"./escape\";\nlet _attributes = \"\";\nlet _styles = \"\";\nlet _children = \"\";\n/**\n * emitAttribute pushes attribute string.\n *\n * @example\n *\n *   emitAttribute(`id=\"abc\"`);\n *\n * @param attr Attribute string.\n */\nexport function emitAttribute(attr) {\n    _attributes += ` ${attr}`;\n}\n/**\n * emitStyle pushes style string.\n *\n * @example\n *\n *   emitStyle(`padding:0`);\n *\n * @param style Style string.\n */\nexport function emitStyle(style) {\n    if (_styles !== \"\") {\n        _styles += \";\";\n    }\n    _styles += style;\n}\n/**\n * emitChildrens pushes children string.\n *\n * @example\n *\n *   emitChildren(`<h1>Hello World</h1>`);\n *\n * @param children Children string.\n */\nexport function emitChildren(children) {\n    _children += children;\n}\n/**\n * Renders a {@link OpNode} to string.\n *\n * @param op {@link OpNode}\n * @param context Current context.\n * @returns Rendering results.\n */\nfunction _renderToString(op) {\n    if (op !== null) {\n        if (typeof op === \"object\") {\n            let result = \"\";\n            if (op instanceof Array) {\n                for (let i = 0; i < op.length; ++i) {\n                    result += renderToString(op[i]);\n                }\n                return result;\n            }\n            const opType = op.t;\n            const flags = opType.f;\n            if ((flags & 2 /* Element */) !== 0) {\n                let children = \"\";\n                let tagName;\n                let className = op.n;\n                let attrs = op.v;\n                if ((flags & 64 /* ElementProto */) !== 0) {\n                    const proto = opType.d.p;\n                    tagName = proto.t.d;\n                    if (className === void 0) {\n                        className = proto.n;\n                    }\n                    if (proto.v !== void 0) {\n                        attrs = attrs === void 0 ? proto.v : { ...proto.v, ...attrs };\n                    }\n                }\n                else {\n                    tagName = opType.d;\n                }\n                let openElement = `<${tagName}`;\n                if (className !== void 0 && className !== \"\") {\n                    openElement += ` class=\"${className}\"`;\n                }\n                if (attrs !== void 0) {\n                    for (const key in attrs) {\n                        const value = attrs[key];\n                        if (key === \"style\") {\n                            for (const skey in value) {\n                                emitStyle(`${skey}:${escapeAttributeValue(value[skey])}`);\n                            }\n                        }\n                        else {\n                            if (typeof value === \"object\") {\n                                value.s(key, value.v);\n                            }\n                            else if (typeof value !== \"boolean\") {\n                                emitAttribute(`${key}=\"${escapeAttributeValue(value)}\"`);\n                            }\n                            else if (value === true) {\n                                emitAttribute(key);\n                            }\n                        }\n                    }\n                    if (_styles !== \"\") {\n                        emitAttribute(`style=\"${_styles}\"`);\n                        _styles = \"\";\n                    }\n                    openElement += _attributes;\n                    children = _children;\n                    _attributes = \"\";\n                    _children = \"\";\n                }\n                if (children === \"\") {\n                    children = renderToString(op.c);\n                }\n                if ((flags & 2048 /* NewlineEatingElement */) !== 0) {\n                    if (children.length > 0 && children.charCodeAt(0) === 10) { // \"\\n\"\n                        children = `\\n${children}`;\n                    }\n                }\n                return ((flags & (4096 /* VoidElement */ | 512 /* Svg */)) !== 0 && children === \"\") ?\n                    `${openElement} />` :\n                    `${openElement}>${children}</${tagName}>`;\n            }\n            if ((flags & 4 /* Component */) !== 0) {\n                if ((flags & 256 /* Stateful */) !== 0) {\n                    const stateNode = createStateNode(op);\n                    stateNode.s = { r: null, s: null, u: null };\n                    return renderToString(op.t.d.c(stateNode)(op.v));\n                }\n                else {\n                    return renderToString(op.t.d.c(op.v));\n                }\n            }\n            if ((flags & (16 /* Events */ | 32 /* Context */)) !== 0) {\n                if ((flags & 32 /* Context */) !== 0) {\n                    const prevContext = getContext();\n                    pushContext(op.t.d, op.v);\n                    result = renderToString(op.c);\n                    setContext(prevContext);\n                    return result;\n                }\n                else {\n                    return renderToString(op.c);\n                }\n            }\n            // TrackByKey Node\n            const childrenNodes = op.v;\n            for (let i = 0; i < childrenNodes.length; ++i) {\n                result += renderToString(childrenNodes[i].v);\n            }\n            return result;\n        }\n        if (typeof op === \"string\") {\n            return escapeText(op);\n        }\n        // number\n        return op.toString();\n    }\n    return \"\";\n}\n/**\n * Renders a {@link OpNode} to string.\n *\n * @param op {@link OpNode}\n * @param context Current context.\n * @returns Rendering results.\n */\nexport function renderToString(op) {\n    try {\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== \"production\") {\n            enableContext();\n        }\n        return _renderToString(op);\n    }\n    catch (e) {\n        resetContext();\n        _attributes = \"\";\n        _styles = \"\";\n        _children = \"\";\n        throw e;\n    }\n    finally {\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== \"production\") {\n            disableContext();\n        }\n    }\n}\n//# sourceMappingURL=render.js.map","/**\n * Escapes HTML text.\n *\n * {@link https://www.w3.org/TR/html5/syntax.html#data-state}\n * {@link https://www.w3.org/TR/html5/syntax.html#rcdata-state}\n *\n * @param text - Text\n * @returns Escaped text\n */\nexport function escapeText(text) {\n    if (typeof text === \"string\") {\n        if (text.indexOf(\"&\") === -1 && text.indexOf(\"<\") === -1) {\n            return text;\n        }\n        let result = text;\n        let start = 0;\n        let i = 0;\n        for (; i < text.length; ++i) {\n            let escape;\n            switch (text.charCodeAt(i)) {\n                case 38: // &\n                    escape = \"&amp;\";\n                    break;\n                case 60: // <\n                    escape = \"&lt;\";\n                    break;\n                default:\n                    continue;\n            }\n            if (i > start) {\n                escape = text.slice(start, i) + escape;\n            }\n            result = (start > 0) ? result + escape : escape;\n            start = i + 1;\n        }\n        if (i !== start) {\n            return result + text.slice(start, i);\n        }\n        return result;\n    }\n    return text.toString();\n}\n/**\n * Escapes HTML attribute values.\n *\n * {@link https://www.w3.org/TR/html5/syntax.html#attribute-value-(double-quoted)-state}\n *\n * @param text - Attribute value\n * @returns Escaped attribute value\n */\nexport function escapeAttributeValue(text) {\n    if (typeof text === \"string\") {\n        if (text.indexOf(\"\\\"\") === -1 && text.indexOf(\"&\") === -1) {\n            return text;\n        }\n        let result = text;\n        let start = 0;\n        let i = 0;\n        for (; i < text.length; ++i) {\n            let escape;\n            switch (text.charCodeAt(i)) {\n                case 34: // \"\n                    escape = \"&quot;\";\n                    break;\n                case 38: // &\n                    escape = \"&amp;\";\n                    break;\n                default:\n                    continue;\n            }\n            if (i > start) {\n                escape = text.slice(start, i) + escape;\n            }\n            result = (start > 0) ? result + escape : escape;\n            start = i + 1;\n        }\n        if (i !== start) {\n            return result + text.slice(start, i);\n        }\n        return result;\n    }\n    return text.toString();\n}\n/**\n * Escapes javascript code.\n *\n * @param text - Text.\n * @returns Escaped text.\n */\nexport function escapeJavascript(text) {\n    let result = text;\n    let escape;\n    let start = 0;\n    let i = 0;\n    for (; i < text.length; ++i) {\n        switch (text.charCodeAt(i)) {\n            case 47: // /\n                escape = \"\\\\u002F\";\n                break;\n            case 60: // <\n                escape = \"\\\\u003C\";\n                break;\n            case 62: // >\n                escape = \"\\\\u003E\";\n                break;\n            case 8232:\n                escape = \"\\\\u2028\";\n                break;\n            case 8233:\n                escape = \"\\\\u2029\";\n                break;\n            default:\n                continue;\n        }\n        if (i > start) {\n            escape = text.slice(start, i) + escape;\n        }\n        result = (start > 0) ? result + escape : escape;\n        start = i + 1;\n    }\n    if (start !== 0 && i !== start) {\n        return result + text.slice(start, i);\n    }\n    return result;\n}\n//# sourceMappingURL=escape.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"views-labeled__container--LxxXR\",\"label\":\"views-labeled__label--3QcRA\",\"content\":\"views-labeled__content--3Aqxf\",\"textContainer\":\"views-labeled__textContainer--20WmP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"views-slider__container--1iRqF\",\"baseLine\":\"views-slider__baseLine--LIh9H\",\"filledLineClass\":\"views-slider__filledLineClass--3Zx18\",\"emptyButton\":\"views-slider__emptyButton--ql0yq\",\"button\":\"views-slider__button--2AbV7\"};","import { orDefault, arrUpdate, arrInsert, arrRemove } from \"../util\";\r\nimport { Stack } from \"../collections\";\r\nexport class LeafLayer {\r\n    constructor(id, name, opacity, isHidden) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.opacity = opacity;\r\n        this.isHidden = isHidden;\r\n    }\r\n    static init(id) {\r\n        return new LeafLayer(id, \"\", 1, false);\r\n    }\r\n    get isLeaf() {\r\n        return true;\r\n    }\r\n    with(args) {\r\n        const name = orDefault(args.name, this.name);\r\n        const opacity = orDefault(args.opacity, this.opacity);\r\n        const isHidden = orDefault(args.isHidden, this.isHidden);\r\n        return new LeafLayer(this.id, name, opacity, isHidden);\r\n    }\r\n}\r\nexport class GroupLayer {\r\n    constructor(id, name, opacity, isHidden, children) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.opacity = opacity;\r\n        this.isHidden = isHidden;\r\n        this.children = children;\r\n    }\r\n    static init(id) {\r\n        return new GroupLayer(id, \"\", 1, false, []);\r\n    }\r\n    get isLeaf() {\r\n        return false;\r\n    }\r\n    with(args) {\r\n        return new GroupLayer(this.id, orDefault(args.name, this.name), orDefault(args.opacity, this.opacity), orDefault(args.isHidden, this.isHidden), this.children);\r\n    }\r\n    withChildren(children) {\r\n        return new GroupLayer(this.id, this.name, this.opacity, this.isHidden, children);\r\n    }\r\n    get(selectedPath) {\r\n        const index = selectedPath.head;\r\n        const selected = this.children[index];\r\n        if (selectedPath.tail.isNonEmpty()) {\r\n            if (selected.isLeaf)\r\n                throw \"Invariant violation\";\r\n            return selected.get(selectedPath.tail);\r\n        }\r\n        return selected;\r\n    }\r\n    getWithContext(selectedPath, opacity) {\r\n        const index = selectedPath.head;\r\n        const selected = this.children[index];\r\n        if (selectedPath.tail.isNonEmpty()) {\r\n            if (selected.isLeaf)\r\n                throw \"Invariant violation\";\r\n            return selected.getWithContext(selectedPath.tail, this.isHidden ? 0 : opacity * this.opacity);\r\n        }\r\n        return {\r\n            id: selected.id,\r\n            name: selected.name,\r\n            opacity: selected.isHidden ? 0 : opacity * selected.opacity,\r\n        };\r\n    }\r\n    findPath(id) {\r\n        const children = this.children;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            const child = children[i];\r\n            if (child.isLeaf) {\r\n                if (child.id === id)\r\n                    return Stack.empty().cons(i);\r\n            }\r\n            else {\r\n                const path = child.findPath(id);\r\n                if (path !== null)\r\n                    return path.cons(i);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    insert(selectedPath, leaf) {\r\n        const index = selectedPath.head;\r\n        const selected = this.children[index];\r\n        if (selectedPath.tail.isNonEmpty()) {\r\n            if (selected.isLeaf)\r\n                throw \"Invariant violation\";\r\n            const newSelected = selected.insert(selectedPath.tail, leaf);\r\n            const newChildren = arrUpdate(this.children, index, newSelected);\r\n            return this.withChildren(newChildren);\r\n        }\r\n        else {\r\n            return this.withChildren(arrInsert(this.children, index, leaf));\r\n        }\r\n    }\r\n    remove(selectedPath) {\r\n        const index = selectedPath.head;\r\n        const selected = this.children[index];\r\n        if (selectedPath.tail.isNonEmpty()) {\r\n            if (selected.isLeaf)\r\n                throw \"Invariant violation\";\r\n            const [newSelected, newSelectedPath] = selected.remove(selectedPath.tail);\r\n            const newChildren = arrUpdate(this.children, index, newSelected);\r\n            return [this.withChildren(newChildren), newSelectedPath.cons(index)];\r\n        }\r\n        else {\r\n            const newChildren = this.withChildren(arrRemove(this.children, index));\r\n            if (newChildren.children.length === 0)\r\n                return [newChildren, Stack.empty()];\r\n            const newIndex = this.children.length === index + 1 ? index - 1 : index;\r\n            const newSelectedPath = index === newIndex ? selectedPath : Stack.NonEmpty.of(newIndex);\r\n            return [newChildren, newSelectedPath];\r\n        }\r\n    }\r\n    update(selectedPath, updateFn) {\r\n        const index = selectedPath.head;\r\n        const selected = this.children[index];\r\n        if (selectedPath.tail.isNonEmpty()) {\r\n            if (selected.isLeaf)\r\n                throw \"Invariant violation\";\r\n            const newSelected = selected.update(selectedPath.tail, updateFn);\r\n            const newChildren = arrUpdate(this.children, index, newSelected);\r\n            return this.withChildren(newChildren);\r\n        }\r\n        else {\r\n            const newSelected = updateFn(selected);\r\n            const newChildren = arrUpdate(this.children, index, newSelected);\r\n            return this.withChildren(newChildren);\r\n        }\r\n    }\r\n    collectLeaves(array, opacity) {\r\n        const children = this.children;\r\n        for (let i = 0; i < children.length; i++) {\r\n            const layer = children[i];\r\n            const nextOpacity = layer.isHidden ? 0 : opacity * layer.opacity;\r\n            if (layer.isLeaf) {\r\n                array.push({\r\n                    id: layer.id,\r\n                    name: layer.name,\r\n                    opacity: nextOpacity,\r\n                });\r\n            }\r\n            else {\r\n                layer.collectLeaves(array, nextOpacity);\r\n            }\r\n        }\r\n    }\r\n}\r\nexport var MsgType;\r\n(function (MsgType) {\r\n    MsgType[MsgType[\"NewLayerMsg\"] = 0] = \"NewLayerMsg\";\r\n    MsgType[MsgType[\"RemoveMsg\"] = 1] = \"RemoveMsg\";\r\n    MsgType[MsgType[\"SelectMsg\"] = 2] = \"SelectMsg\";\r\n    MsgType[MsgType[\"SetOpacityMsg\"] = 3] = \"SetOpacityMsg\";\r\n    MsgType[MsgType[\"SetHiddenMsg\"] = 4] = \"SetHiddenMsg\";\r\n})(MsgType || (MsgType = {}));\r\nclass NewLayerMsg {\r\n    constructor(id) {\r\n        this.id = id;\r\n        this.type = MsgType.NewLayerMsg;\r\n    }\r\n}\r\nclass RemoveMsg {\r\n    constructor(id) {\r\n        this.id = id;\r\n        this.type = MsgType.RemoveMsg;\r\n    }\r\n}\r\nclass SelectMsg {\r\n    constructor(id) {\r\n        this.id = id;\r\n        this.type = MsgType.SelectMsg;\r\n    }\r\n}\r\nclass SetOpacityMsg {\r\n    constructor(id, opacity) {\r\n        this.id = id;\r\n        this.opacity = opacity;\r\n        this.type = MsgType.SetOpacityMsg;\r\n    }\r\n}\r\nclass SetHiddenMsg {\r\n    constructor(id, isHidden) {\r\n        this.id = id;\r\n        this.isHidden = isHidden;\r\n        this.type = MsgType.SetHiddenMsg;\r\n    }\r\n}\r\nexport function createSender(sendMessage) {\r\n    return {\r\n        newLayer: id => sendMessage(new NewLayerMsg(id)),\r\n        removeLayer: id => sendMessage(new RemoveMsg(id)),\r\n        selectLayer: id => sendMessage(new SelectMsg(id)),\r\n        setOpacity: (id, opacity) => sendMessage(new SetOpacityMsg(id, opacity)),\r\n        setHidden: (id, isHidden) => sendMessage(new SetHiddenMsg(id, isHidden)),\r\n    };\r\n}\r\nexport class State {\r\n    constructor(getNextLayerId, layers, selectedPath) {\r\n        this.getNextLayerId = getNextLayerId;\r\n        this.layers = layers;\r\n        this.selectedPath = selectedPath;\r\n    }\r\n    static init() {\r\n        const getNextLayerId = (() => {\r\n            let layerId = 1;\r\n            return () => layerId++;\r\n        })();\r\n        const leaf = LeafLayer.init(getNextLayerId());\r\n        const group = GroupLayer.init(getNextLayerId()).withChildren([leaf]);\r\n        return new State(getNextLayerId, group, Stack.empty().cons(0));\r\n    }\r\n    current() {\r\n        return this.layers.get(this.selectedPath);\r\n    }\r\n    update(msg) {\r\n        switch (msg.type) {\r\n            case MsgType.NewLayerMsg:\r\n                return this.current().id === msg.id ? this.newLayer() : this;\r\n            case MsgType.RemoveMsg:\r\n                return this.current().id === msg.id ? this.removeCurrent() : this;\r\n            case MsgType.SelectMsg:\r\n                return this.current().id === msg.id ? this : this.select(msg.id);\r\n            case MsgType.SetOpacityMsg: {\r\n                const { id, opacity } = msg;\r\n                const current = this.current();\r\n                return current.id === id ? this.updateCurrent(x => x.with({ opacity })) : this;\r\n            }\r\n            case MsgType.SetHiddenMsg: {\r\n                const { id, isHidden } = msg;\r\n                const current = this.current();\r\n                return current.id === id ? this.updateCurrent(x => x.with({ isHidden })) : this;\r\n            }\r\n            default:\r\n                const never = msg;\r\n                throw { \"unexpected msg\": msg };\r\n        }\r\n    }\r\n    split() {\r\n        const children = this.layers.children;\r\n        const selectedIdx = this.selectedPath.head;\r\n        const above = [];\r\n        const below = [];\r\n        const baseOpacity = 1;\r\n        for (let i = 0; i < selectedIdx; i++) {\r\n            const child = children[i];\r\n            if (child.isLeaf)\r\n                above.push({\r\n                    id: child.id,\r\n                    name: child.name,\r\n                    opacity: baseOpacity * child.opacity,\r\n                });\r\n            else\r\n                child.collectLeaves(above, baseOpacity);\r\n        }\r\n        for (let i = this.selectedPath.head + 1; i < children.length; i++) {\r\n            const child = children[i];\r\n            if (child.isLeaf)\r\n                below.push({\r\n                    id: child.id,\r\n                    name: child.name,\r\n                    opacity: baseOpacity * child.opacity,\r\n                });\r\n            else\r\n                child.collectLeaves(below, baseOpacity);\r\n        }\r\n        const current = this.layers.get(this.selectedPath);\r\n        if (current.isLeaf)\r\n            return {\r\n                above,\r\n                current: this.layers.getWithContext(this.selectedPath, baseOpacity),\r\n                below,\r\n            };\r\n        current.collectLeaves(below, baseOpacity);\r\n        return { above, current: null, below };\r\n    }\r\n    select(id) {\r\n        const path = this.layers.findPath(id);\r\n        if (path === null)\r\n            return this;\r\n        return new State(this.getNextLayerId, this.layers, path);\r\n    }\r\n    newLayer() {\r\n        const layers = this.layers.insert(this.selectedPath, LeafLayer.init(this.getNextLayerId()));\r\n        return new State(this.getNextLayerId, layers, this.selectedPath);\r\n    }\r\n    // newGroup(): LayerState {\r\n    //     throw \"todo\"\r\n    // }\r\n    removeCurrent() {\r\n        const [newLayers, newSelectedPath] = this.layers.remove(this.selectedPath);\r\n        if (newSelectedPath.isNonEmpty())\r\n            return new State(this.getNextLayerId, newLayers, newSelectedPath);\r\n        const oldIndex = this.selectedPath.head;\r\n        const newIndex = newLayers.children.length <= oldIndex ? oldIndex : oldIndex - 1;\r\n        return new State(this.getNextLayerId, newLayers, Stack.NonEmpty.of(newIndex));\r\n    }\r\n    updateCurrent(updateFn) {\r\n        return new State(this.getNextLayerId, this.layers.update(this.selectedPath, updateFn), this.selectedPath);\r\n    }\r\n}\r\n","import * as WebGL from \"../webgl\";\r\nconst VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec2 a_position;\r\n\r\nuniform vec2 u_resolution;\r\n\r\nvarying vec2 v_tex_coords;\r\n\r\nvoid main() {\r\n    vec2 pos = a_position / u_resolution;\r\n    pos.y = 1.0 - pos.y;\r\n    v_tex_coords = pos;\r\n    pos = pos * 2.0;\r\n    pos = pos - 1.0;\r\n    gl_Position = vec4(pos, 0.0, 1.0);\r\n    \r\n}\r\n`;\r\nconst FRAG_SRC = `\r\nprecision highp float;\r\n\r\n${WebGL.DEFINE_from_linear}\r\n\r\nvarying vec2 v_tex_coords;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nvoid main() {\r\n    vec4 pixel = texture2D(u_texture, v_tex_coords);\r\n    gl_FragColor = vec4(from_linear(pixel.rgb), pixel.a);\r\n}\r\n`;\r\nconst AttributesInfo = new WebGL.AttributesInfo([\r\n    { name: \"a_position\", size: 2, type: WebGL.AttribType.Float },\r\n]);\r\nconst Uniforms = {\r\n    u_resolution: WebGL.UniformType.F2,\r\n    u_texture: WebGL.UniformType.I1,\r\n};\r\nexport class Shader {\r\n    constructor(gl, program, locations) {\r\n        this.program = program;\r\n        this.locations = locations;\r\n        this.capacity = 1024;\r\n        this.buffer = gl.createBuffer();\r\n        this.array = new Float32Array(AttributesInfo.size * 6 * this.capacity);\r\n    }\r\n    static create(gl) {\r\n        const program = WebGL.createProgram(gl, VERT_SRC, FRAG_SRC);\r\n        if (program === null) {\r\n            return null;\r\n        }\r\n        const locations = WebGL.getUniformLocation(gl, program, Uniforms);\r\n        if (locations === null) {\r\n            return null;\r\n        }\r\n        AttributesInfo.bindAttribLocations(gl, program);\r\n        return new Shader(gl, program, locations);\r\n    }\r\n    render(gl, args) {\r\n        const { sfact, dfact } = WebGL.Blend.factorsNormal;\r\n        gl.blendFunc(sfact, dfact);\r\n        gl.useProgram(this.program);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        if (this.capacity < args.blocks.length) {\r\n            this.capacity = args.blocks.length;\r\n            this.array = new Float32Array(AttributesInfo.size * 6 * this.capacity);\r\n        }\r\n        const array = this.array;\r\n        let offset = 0;\r\n        for (let i = 0; i < args.blocks.length; i++) {\r\n            const { x0, y0, x1, y1 } = args.blocks[i];\r\n            array[offset++] = x0;\r\n            array[offset++] = y0;\r\n            array[offset++] = x0;\r\n            array[offset++] = y1;\r\n            array[offset++] = x1;\r\n            array[offset++] = y0;\r\n            array[offset++] = x0;\r\n            array[offset++] = y1;\r\n            array[offset++] = x1;\r\n            array[offset++] = y0;\r\n            array[offset++] = x1;\r\n            array[offset++] = y1;\r\n        }\r\n        // buffer data\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, array, WebGLRenderingContext.DYNAMIC_DRAW);\r\n        WebGL.updateUniforms(gl, this.locations, args.uniforms);\r\n        AttributesInfo.vertexAttrib(gl);\r\n        gl.drawArrays(WebGLRenderingContext.TRIANGLES, 0, 6 * args.blocks.length);\r\n    }\r\n    dispose(gl) {\r\n        gl.deleteBuffer(this.buffer);\r\n        gl.deleteProgram(this.program);\r\n    }\r\n}\r\n","import * as WebGL from \"../webgl\";\r\nconst VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec2 a_position;\r\n\r\nvarying vec2 v_position;\r\n\r\nvoid main() {\r\n  gl_Position = vec4(a_position, 0.0, 1.0);\r\n  \r\n  v_position = a_position;\r\n}\r\n`;\r\nconst FRAG_SRC = `\r\nprecision highp float;\r\n\r\nvarying vec2 v_position;\r\n\r\nuniform float u_softness;\r\n\r\nvoid main() {\r\n  float radius = 1.0 - u_softness;\r\n  float dist = sqrt(dot(v_position, v_position));\r\n  float a = 1.0 - smoothstep(radius, radius + u_softness, dist);\r\n\r\n  gl_FragColor = vec4(vec3(0.0), (a));\r\n}\r\n`;\r\nconst AttributesInfo = new WebGL.AttributesInfo([\r\n    { name: \"a_position\", size: 2, type: WebGL.AttribType.Float },\r\n]);\r\nconst Uniforms = {\r\n    u_softness: WebGL.UniformType.F1,\r\n};\r\nexport class Generator {\r\n    constructor(gl, program, locations) {\r\n        this.program = program;\r\n        this.locations = locations;\r\n        this.buffer = gl.createBuffer();\r\n        const array = new Float32Array(12);\r\n        array[0] = -1;\r\n        array[1] = -1;\r\n        array[2] = -1;\r\n        array[3] = 1;\r\n        array[4] = 1;\r\n        array[5] = -1;\r\n        array[6] = -1;\r\n        array[7] = 1;\r\n        array[8] = 1;\r\n        array[9] = -1;\r\n        array[10] = 1;\r\n        array[11] = 1;\r\n        this.array = array;\r\n    }\r\n    static create(gl) {\r\n        const program = WebGL.createProgram(gl, VERT_SRC, FRAG_SRC);\r\n        if (program === null) {\r\n            return null;\r\n        }\r\n        const locations = WebGL.getUniformLocation(gl, program, Uniforms);\r\n        if (locations === null) {\r\n            return null;\r\n        }\r\n        AttributesInfo.bindAttribLocations(gl, program);\r\n        return new Generator(gl, program, locations);\r\n    }\r\n    generateBrushTexture(gl, args) {\r\n        const { sfact, dfact } = WebGL.Blend.factorsNormal;\r\n        gl.blendFunc(sfact, dfact);\r\n        gl.useProgram(this.program);\r\n        gl.viewport(0, 0, args.size.x, args.size.y);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, args.framebuffer);\r\n        gl.clearColor(0, 0, 0, 0);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        WebGL.updateUniforms(gl, this.locations, args.uniforms);\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, this.array, WebGLRenderingContext.STATIC_DRAW);\r\n        AttributesInfo.vertexAttrib(gl);\r\n        gl.drawArrays(WebGLRenderingContext.TRIANGLES, 0, 6);\r\n    }\r\n    dispose(gl) {\r\n        gl.deleteBuffer(this.buffer);\r\n        gl.deleteProgram(this.program);\r\n    }\r\n}\r\n","import * as WebGL from \"../webgl\";\r\nconst VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec2 a_position;\r\n\r\nuniform vec2 u_resolution;\r\n\r\nvarying vec2 v_tex_coords;\r\n\r\nvoid main() {\r\n    vec2 pos = a_position / u_resolution;\r\n    pos.y = 1.0 - pos.y;\r\n    pos = pos * 2.0;\r\n    pos = pos - 1.0;\r\n    gl_Position = vec4(pos, 0.0, 1.0);\r\n    \r\n    v_tex_coords = a_position / u_resolution;\r\n}\r\n`;\r\nconst FRAG_SRC = `\r\nprecision highp float;\r\n\r\nvarying vec2 v_tex_coords;\r\n\r\nuniform sampler2D u_texture;\r\nuniform float u_opacity;\r\n\r\nvoid main() {\r\n    vec4 pixel = texture2D(u_texture, v_tex_coords);\r\n    gl_FragColor = pixel * u_opacity;\r\n}\r\n`;\r\nconst AttributesInfo = new WebGL.AttributesInfo([\r\n    { name: \"a_position\", size: 2, type: WebGL.AttribType.Float },\r\n]);\r\nconst Uniforms = {\r\n    u_texture: WebGL.UniformType.I1,\r\n    u_resolution: WebGL.UniformType.F2,\r\n    u_opacity: WebGL.UniformType.F1,\r\n};\r\nexport class Shader {\r\n    constructor(gl, program, locations) {\r\n        this.program = program;\r\n        this.locations = locations;\r\n        this.capacity = 1024;\r\n        this.buffer = gl.createBuffer();\r\n        this.array = new Float32Array(AttributesInfo.size * 6 * this.capacity);\r\n    }\r\n    static create(gl) {\r\n        const program = WebGL.createProgram(gl, VERT_SRC, FRAG_SRC);\r\n        if (program === null) {\r\n            return null;\r\n        }\r\n        const locations = WebGL.getUniformLocation(gl, program, Uniforms);\r\n        if (locations === null) {\r\n            return null;\r\n        }\r\n        AttributesInfo.bindAttribLocations(gl, program);\r\n        return new Shader(gl, program, locations);\r\n    }\r\n    render(gl, args) {\r\n        if (args.framebuffer == null) {\r\n            throw \"Framebuffer should be defined\";\r\n        }\r\n        const { sfact, dfact } = WebGL.Blend.factorsNormal;\r\n        gl.blendFunc(sfact, dfact);\r\n        gl.useProgram(this.program);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, args.framebuffer);\r\n        if (this.capacity < args.blocks.length) {\r\n            this.capacity = args.blocks.length;\r\n            this.array = new Float32Array(AttributesInfo.size * 6 * this.capacity);\r\n        }\r\n        const array = this.array;\r\n        let offset = 0;\r\n        for (let i = 0; i < args.blocks.length; i++) {\r\n            const { x0, y0, x1, y1 } = args.blocks[i];\r\n            array[offset++] = x0;\r\n            array[offset++] = y0;\r\n            array[offset++] = x0;\r\n            array[offset++] = y1;\r\n            array[offset++] = x1;\r\n            array[offset++] = y0;\r\n            array[offset++] = x0;\r\n            array[offset++] = y1;\r\n            array[offset++] = x1;\r\n            array[offset++] = y0;\r\n            array[offset++] = x1;\r\n            array[offset++] = y1;\r\n        }\r\n        // buffer data\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, array, WebGLRenderingContext.DYNAMIC_DRAW);\r\n        WebGL.updateUniforms(gl, this.locations, args.uniforms);\r\n        AttributesInfo.vertexAttrib(gl);\r\n        gl.drawArrays(WebGLRenderingContext.TRIANGLES, 0, 6 * args.blocks.length);\r\n    }\r\n    dispose(gl) {\r\n        gl.deleteBuffer(this.buffer);\r\n        gl.deleteProgram(this.program);\r\n    }\r\n}\r\n","import * as WebGL from \"../webgl\";\r\nconst VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec2 a_position;\r\n\r\nuniform vec2 u_resolution;\r\n\r\nvoid main() {\r\n    vec2 pos = a_position / u_resolution;\r\n    pos.y = 1.0 - pos.y;\r\n    pos = pos * 2.0;\r\n    pos = pos - 1.0;\r\n    gl_Position = vec4(pos, 0.0, 1.0);\r\n}\r\n`;\r\nconst FRAG_SRC = `\r\nprecision highp float;\r\n\r\nuniform vec4 u_rgba;\r\n\r\nvoid main() {\r\n    gl_FragColor = u_rgba;\r\n}\r\n`;\r\nconst AttributesInfo = new WebGL.AttributesInfo([\r\n    { name: \"a_position\", size: 2, type: WebGL.AttribType.Float },\r\n]);\r\nconst Uniforms = {\r\n    u_resolution: WebGL.UniformType.F2,\r\n    u_rgba: WebGL.UniformType.F4,\r\n};\r\nexport class Shader {\r\n    constructor(gl, program, locations) {\r\n        this.program = program;\r\n        this.locations = locations;\r\n        this.capacity = 1024;\r\n        this.buffer = gl.createBuffer();\r\n        this.array = new Float32Array(AttributesInfo.size * 6 * this.capacity);\r\n    }\r\n    static create(gl) {\r\n        const program = WebGL.createProgram(gl, VERT_SRC, FRAG_SRC);\r\n        if (program === null) {\r\n            return null;\r\n        }\r\n        const locations = WebGL.getUniformLocation(gl, program, Uniforms);\r\n        if (locations === null) {\r\n            return null;\r\n        }\r\n        AttributesInfo.bindAttribLocations(gl, program);\r\n        return new Shader(gl, program, locations);\r\n    }\r\n    render(gl, args) {\r\n        if (args.framebuffer == null) {\r\n            throw \"Framebuffer should be defined\";\r\n        }\r\n        const { sfact, dfact } = WebGL.Blend.factorsNormal;\r\n        gl.blendFunc(sfact, dfact);\r\n        gl.useProgram(this.program);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, args.framebuffer);\r\n        if (this.capacity < args.blocks.length) {\r\n            this.capacity = args.blocks.length;\r\n            this.array = new Float32Array(AttributesInfo.size * 6 * this.capacity);\r\n        }\r\n        const array = this.array;\r\n        let offset = 0;\r\n        for (let i = 0; i < args.blocks.length; i++) {\r\n            const { x0, y0, x1, y1 } = args.blocks[i];\r\n            array[offset++] = x0;\r\n            array[offset++] = y0;\r\n            array[offset++] = x0;\r\n            array[offset++] = y1;\r\n            array[offset++] = x1;\r\n            array[offset++] = y0;\r\n            array[offset++] = x0;\r\n            array[offset++] = y1;\r\n            array[offset++] = x1;\r\n            array[offset++] = y0;\r\n            array[offset++] = x1;\r\n            array[offset++] = y1;\r\n        }\r\n        // buffer data\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, array, WebGLRenderingContext.DYNAMIC_DRAW);\r\n        WebGL.updateUniforms(gl, this.locations, args.uniforms);\r\n        AttributesInfo.vertexAttrib(gl);\r\n        gl.drawArrays(WebGLRenderingContext.TRIANGLES, 0, 6 * args.blocks.length);\r\n    }\r\n    dispose(gl) {\r\n        gl.deleteBuffer(this.buffer);\r\n        gl.deleteProgram(this.program);\r\n    }\r\n}\r\n","import * as WebGL from \"../webgl\";\r\nimport { Vec4 } from \"../util\";\r\nconst INITIAL_VARRAY_SIZE = 5000;\r\nconst VERT_SRC = `\r\nprecision highp float;\r\n\r\nattribute vec4 a_color;\r\nattribute vec2 a_tex_coords;\r\nattribute vec2 a_position;\r\n\r\nuniform vec2 u_resolution;\r\n\r\nvarying vec4 v_color;\r\nvarying vec2 v_tex_coords;\r\n\r\nvoid main() {\r\n    vec2 pos = (a_position / u_resolution) * vec2(2.0, -2.0) + vec2(-1.0, 1.0);\r\n    gl_Position = vec4(pos, 0.0, 1.0);\r\n\r\n    v_color = vec4(a_color.rgb * a_color.a, a_color.a);\r\n    v_tex_coords = a_tex_coords;\r\n}\r\n`;\r\nconst FRAG_SRC = `\r\nprecision highp float;\r\n\r\nvarying vec4 v_color;\r\nvarying vec2 v_tex_coords;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nvoid main() {\r\n    float alpha = texture2D(u_texture, v_tex_coords).a;\r\n    gl_FragColor = v_color * alpha;\r\n}\r\n`;\r\nconst AttributesInfo = new WebGL.AttributesInfo([\r\n    { name: \"a_color\", size: 4, type: WebGL.AttribType.Float },\r\n    { name: \"a_tex_coords\", size: 2, type: WebGL.AttribType.Float },\r\n    { name: \"a_position\", size: 2, type: WebGL.AttribType.Float },\r\n]);\r\nconst Uniforms = {\r\n    u_resolution: WebGL.UniformType.F2,\r\n    u_texture: WebGL.UniformType.I1,\r\n};\r\nfunction initAffectedArea() {\r\n    return {\r\n        x0: Number.MAX_VALUE,\r\n        y0: Number.MAX_VALUE,\r\n        x1: Number.MIN_VALUE,\r\n        y1: Number.MIN_VALUE,\r\n    };\r\n}\r\nexport class Shader {\r\n    constructor(gl, program, locations) {\r\n        this.program = program;\r\n        this.locations = locations;\r\n        const arrayLength = AttributesInfo.size * 6 * INITIAL_VARRAY_SIZE;\r\n        this.buffer = gl.createBuffer();\r\n        this.array = new Float32Array(arrayLength);\r\n        this.offset = 0;\r\n        this.affectedArea = initAffectedArea();\r\n    }\r\n    static create(gl) {\r\n        const program = WebGL.createProgram(gl, VERT_SRC, FRAG_SRC);\r\n        if (program === null) {\r\n            return null;\r\n        }\r\n        const locations = WebGL.getUniformLocation(gl, program, Uniforms);\r\n        if (locations === null) {\r\n            return null;\r\n        }\r\n        AttributesInfo.bindAttribLocations(gl, program);\r\n        return new Shader(gl, program, locations);\r\n    }\r\n    get canFlush() {\r\n        return this.offset > 0;\r\n    }\r\n    addPoints(points) {\r\n        const nextOffset = 6 * AttributesInfo.size * points.length + this.offset;\r\n        while (nextOffset > this.array.length) {\r\n            this.array = doubleSize(this.array);\r\n        }\r\n        const arr = this.array;\r\n        const ptsLen = points.length;\r\n        let offset = this.offset;\r\n        for (let i = 0; i < ptsLen; i++) {\r\n            offset = addPoint(arr, offset, points[i], this.affectedArea);\r\n        }\r\n        this.offset = offset;\r\n    }\r\n    getAffectedArea() {\r\n        const { affectedArea } = this;\r\n        return new Vec4(affectedArea.x0, affectedArea.y0, affectedArea.x1, affectedArea.y1);\r\n    }\r\n    flush(gl, args) {\r\n        gl.useProgram(this.program);\r\n        const arrayView = this.array.subarray(0, this.offset);\r\n        const { sfact, dfact } = WebGL.Blend.getFactors(args.blendMode);\r\n        gl.blendFunc(sfact, dfact);\r\n        // buffer data\r\n        gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER, arrayView, WebGLRenderingContext.DYNAMIC_DRAW);\r\n        WebGL.updateUniforms(gl, this.locations, args.uniforms);\r\n        AttributesInfo.vertexAttrib(gl);\r\n        const drawCount = AttributesInfo.getDrawCount(this.offset);\r\n        gl.drawArrays(WebGLRenderingContext.TRIANGLES, 0, drawCount);\r\n        this.offset = 0;\r\n        this.affectedArea = initAffectedArea();\r\n    }\r\n    dispose(gl) {\r\n        gl.deleteBuffer(this.buffer);\r\n        gl.deleteProgram(this.program);\r\n    }\r\n}\r\nfunction doubleSize(arr) {\r\n    const newArr = new Float32Array(arr.length * 2);\r\n    for (let i = 0; i < arr.length; i++) {\r\n        newArr[i] = arr[i];\r\n    }\r\n    return newArr;\r\n}\r\nfunction addPoint(arr, offset, point, affectedArea) {\r\n    // console.log(\"addPoint\", point.color.r, point.color.g, point.color.b)\r\n    const x = point.position.x;\r\n    const y = point.position.y;\r\n    const r = point.scaledDiameter * 0.5;\r\n    // const c = Math.cos(point.rotation)\r\n    // const s = Math.sin(point.rotation)\r\n    // const rc = r * c\r\n    // const rs = r * s\r\n    // const rx = rc - rs\r\n    // const ry = rs + rc\r\n    // const x0 = x - rc + rs\r\n    // const y0 = y - rs - rc\r\n    // const x1 = x + rc - rs\r\n    // const y1 = y + rs + rc\r\n    const x0 = x - r;\r\n    const y0 = y - r;\r\n    const x1 = x + r;\r\n    const y1 = y + r;\r\n    // first tri\r\n    offset = addCorner(arr, offset, point, 0, 0, x0, y0);\r\n    offset = addCorner(arr, offset, point, 1, 0, x1, y0);\r\n    offset = addCorner(arr, offset, point, 0, 1, x0, y1);\r\n    // second tri\r\n    offset = addCorner(arr, offset, point, 1, 1, x1, y1);\r\n    offset = addCorner(arr, offset, point, 0, 1, x0, y1);\r\n    offset = addCorner(arr, offset, point, 1, 0, x1, y0);\r\n    // investigate performance: use ternaries that always assign instead of conditional assignment\r\n    // idk, might worth looking into\r\n    if (x0 < affectedArea.x0) {\r\n        affectedArea.x0 = x0;\r\n    }\r\n    if (y0 < affectedArea.y0) {\r\n        affectedArea.y0 = y0;\r\n    }\r\n    if (x1 > affectedArea.x1) {\r\n        affectedArea.x1 = x1;\r\n    }\r\n    if (y1 > affectedArea.y1) {\r\n        affectedArea.y1 = y1;\r\n    }\r\n    return offset;\r\n}\r\nfunction addCorner(arr, offset, point, tx, ty, x, y) {\r\n    // vec4 a_color\r\n    arr[offset++] = point.color.r;\r\n    arr[offset++] = point.color.g;\r\n    arr[offset++] = point.color.b;\r\n    arr[offset++] = point.alpha;\r\n    // vec2 a_tex_coords\r\n    arr[offset++] = tx;\r\n    arr[offset++] = ty;\r\n    // vec2 a_position\r\n    arr[offset++] = x;\r\n    arr[offset++] = y;\r\n    return offset;\r\n}\r\n","const PX_PER_BLOCK_X = 32;\r\nconst PX_PER_BLOCK_Y = 32;\r\nexport class Block {\r\n    constructor(x, y) {\r\n        this.x0 = x * PX_PER_BLOCK_X;\r\n        this.y0 = y * PX_PER_BLOCK_Y;\r\n        this.x1 = (x + 1) * PX_PER_BLOCK_X;\r\n        this.y1 = (y + 1) * PX_PER_BLOCK_Y;\r\n    }\r\n    eq(other) {\r\n        return this.x0 === other.x0 && this.y0 === other.y0;\r\n    }\r\n}\r\nexport class BlockTracker {\r\n    constructor() {\r\n        this._frameBlocks = [];\r\n        this._strokeBlocks = [];\r\n    }\r\n    /**\r\n     * Returns a readonly reference to the internally mutable and unstable frameblock array.\r\n     *\r\n     * Do not store the reference.\r\n     */\r\n    getFrameBlocks() {\r\n        return this._frameBlocks;\r\n    }\r\n    /**\r\n     * Returns a readonly reference to the internally mutable and unstable strokeblock array.\r\n     *\r\n     * Do not store the reference.\r\n     */\r\n    getStrokeBlocks() {\r\n        return this._strokeBlocks;\r\n    }\r\n    /**\r\n     * Track the blocks that the given brushPoints might touch.\r\n     */\r\n    addPoints(brushPoints) {\r\n        if (brushPoints.length === 0) {\r\n            return;\r\n        }\r\n        const frameBlocks = this._frameBlocks;\r\n        for (let i = 0; i < brushPoints.length; i++) {\r\n            // 1. find minimum intersection point\r\n            // 2. find maximum intersection point\r\n            // 3. fill in every in between\r\n            // assume the texture is circular with its max radius being width / 2\r\n            const point = brushPoints[i];\r\n            const radius = point.scaledDiameter / 2;\r\n            const xMin = point.position.x - radius;\r\n            const yMin = point.position.y - radius;\r\n            const xMax = point.position.x + radius;\r\n            const yMax = point.position.y + radius;\r\n            const xBlockMin = (xMin / PX_PER_BLOCK_X) | 0;\r\n            const yBlockMin = (yMin / PX_PER_BLOCK_Y) | 0;\r\n            const xBlockMax = (xMax / PX_PER_BLOCK_X) | 0;\r\n            const yBlockMax = (yMax / PX_PER_BLOCK_Y) | 0;\r\n            for (let y = yBlockMin; y <= yBlockMax; y++) {\r\n                for (let x = xBlockMin; x <= xBlockMax; x++) {\r\n                    const block = new Block(x, y);\r\n                    // check if it already exists\r\n                    let exists = false;\r\n                    for (let i = 0; i < frameBlocks.length; i++) {\r\n                        if (frameBlocks[i].eq(block)) {\r\n                            exists = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (!exists) {\r\n                        frameBlocks.push(block);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        const strokeBlocks = this._strokeBlocks;\r\n        // union, no duplicates\r\n        for (let i = 0; i < frameBlocks.length; i++) {\r\n            const block = frameBlocks[i];\r\n            let exists = false;\r\n            for (let j = 0; j < strokeBlocks.length; j++) {\r\n                if (block.eq(strokeBlocks[j])) {\r\n                    exists = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!exists) {\r\n                strokeBlocks.push(block);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Call this after the stroke has ended, but before rendering the frame.\r\n     */\r\n    strokeEnded() {\r\n        this._frameBlocks.splice(0, this._frameBlocks.length, ...this._strokeBlocks);\r\n        this._strokeBlocks.length = 0;\r\n    }\r\n    /**\r\n     * Call this after the frame has been rendered.\r\n     */\r\n    afterFrame() {\r\n        this._frameBlocks.length = 0;\r\n    }\r\n}\r\n","let nextTextureId = 1;\r\nexport class Texture {\r\n    constructor(texture, framebuffer) {\r\n        this.id = nextTextureId++;\r\n        this.texture = texture;\r\n        this.framebuffer = framebuffer;\r\n    }\r\n}\r\nexport function createTextureWithFramebuffer(gl, allTextures, textureBindings, size) {\r\n    const texture = new Texture(gl.createTexture(), gl.createFramebuffer());\r\n    allTextures.push(texture);\r\n    ensureTextureIsBound(gl, textureBindings, texture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, size.x, size.y, 0, gl.RGBA, gl.FLOAT, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, texture.framebuffer);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture.texture, 0);\r\n    const frameBufferStatus = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\r\n    switch (frameBufferStatus) {\r\n        case gl.FRAMEBUFFER_COMPLETE:\r\n            break;\r\n        case gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:\r\n            console.warn(\"FRAMEBUFFER_INCOMPLETE_ATTACHMENT for texture:\", texture);\r\n            break;\r\n        case gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:\r\n            console.warn(\"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT for texture:\", texture);\r\n            break;\r\n        case gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:\r\n            console.warn(\"FRAMEBUFFER_INCOMPLETE_DIMENSIONS for texture:\", texture);\r\n            break;\r\n        case gl.FRAMEBUFFER_UNSUPPORTED:\r\n            console.warn(\"FRAMEBUFFER_UNSUPPORTED for texture:\", texture);\r\n            break;\r\n        default:\r\n            throw \"Unexpected status: \" + frameBufferStatus;\r\n    }\r\n    return texture;\r\n}\r\nexport function ensureTextureIsBound(gl, textureBindings, { texture, id }) {\r\n    for (let i = 0; i < textureBindings.length; i++) {\r\n        if (textureBindings[i][0] === id) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            return i;\r\n        }\r\n    }\r\n    // Texture isn't bound yet. We need to find an open binding\r\n    for (let i = 0; i < textureBindings.length; i++) {\r\n        if (textureBindings[i][0] === null) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            gl.bindTexture(gl.TEXTURE_2D, texture);\r\n            textureBindings[i] = [id, performance.now()];\r\n            return i;\r\n        }\r\n    }\r\n    // There is no open binding. We need to replace something that's already bound.\r\n    {\r\n        let minTime = Number.MAX_VALUE;\r\n        let minTimeIdx = 0;\r\n        for (let i = 0; i < textureBindings.length; i++) {\r\n            const time = textureBindings[i][1];\r\n            if (time < minTime) {\r\n                minTime = time;\r\n                minTimeIdx = i;\r\n            }\r\n        }\r\n        gl.activeTexture(gl.TEXTURE0 + minTimeIdx);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        textureBindings[minTimeIdx] = [id, performance.now()];\r\n        return minTimeIdx;\r\n    }\r\n}\r\n","import { createTextureWithFramebuffer } from \"./texture\";\r\nexport function getLayersToCombine(prevLayers, nextLayers) {\r\n    const nextAbove = nextLayers.above;\r\n    const nextBelow = nextLayers.below;\r\n    let above = null;\r\n    let below = null;\r\n    if (layersAreDifferent(prevLayers.above, nextAbove)) {\r\n        above = [];\r\n        for (let i = 0; i < nextAbove.length; i++) {\r\n            const layer = nextAbove[i];\r\n            if (layer.opacity !== 0) {\r\n                above.push(layer);\r\n            }\r\n        }\r\n    }\r\n    if (layersAreDifferent(prevLayers.below, nextBelow)) {\r\n        below = [];\r\n        for (let i = nextBelow.length - 1; i >= 0; i--) {\r\n            const layer = nextBelow[i];\r\n            if (layer.opacity !== 0) {\r\n                below.push(layer);\r\n            }\r\n        }\r\n    }\r\n    return { above, below, current: nextLayers.current };\r\n}\r\nfunction layersAreDifferent(prev, next) {\r\n    if (prev.length !== next.length) {\r\n        return true;\r\n    }\r\n    for (let i = 0; i < next.length; i++) {\r\n        if (prev[i].id !== next[i].id) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function combineLayers(args) {\r\n    const { gl, allTextures, resolution, layersToRender, textureShader, textureBindings, layerTextureMap, } = args;\r\n    const layersAbove = layersToRender.above;\r\n    const layersBelow = layersToRender.below;\r\n    const layersCurrent = layersToRender.current;\r\n    gl.clearColor(0, 0, 0, 0);\r\n    if (layersAbove !== null) {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, args.textureAbove.framebuffer);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        for (let i = 0; i < layersAbove.length; i++) {\r\n            const layer = layersAbove[i];\r\n            let texture = layerTextureMap.get(layer.id);\r\n            if (texture == null) {\r\n                texture = createTextureWithFramebuffer(gl, allTextures, textureBindings, resolution);\r\n                layerTextureMap.set(layer.id, texture);\r\n            }\r\n            textureShader.render(gl, {\r\n                blocks: [\r\n                    {\r\n                        x0: 0,\r\n                        y0: 0,\r\n                        x1: resolution.x,\r\n                        y1: resolution.y,\r\n                    },\r\n                ],\r\n                framebuffer: args.textureAbove.framebuffer,\r\n                uniforms: {\r\n                    u_opacity: layer.opacity,\r\n                    u_resolution: resolution,\r\n                    u_texture: ensureTextureIsBound(gl, textureBindings, texture),\r\n                },\r\n            });\r\n        }\r\n    }\r\n    if (layersBelow !== null) {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, args.textureBelow.framebuffer);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        for (let i = 0; i < layersBelow.length; i++) {\r\n            const layer = layersBelow[i];\r\n            let texture = layerTextureMap.get(layer.id);\r\n            if (texture == null) {\r\n                texture = createTextureWithFramebuffer(gl, allTextures, textureBindings, resolution);\r\n                layerTextureMap.set(layer.id, texture);\r\n            }\r\n            textureShader.render(gl, {\r\n                blocks: [\r\n                    {\r\n                        x0: 0,\r\n                        y0: 0,\r\n                        x1: resolution.x,\r\n                        y1: resolution.y,\r\n                    },\r\n                ],\r\n                framebuffer: args.textureBelow.framebuffer,\r\n                uniforms: {\r\n                    u_opacity: layer.opacity,\r\n                    u_resolution: resolution,\r\n                    u_texture: ensureTextureIsBound(gl, textureBindings, texture),\r\n                },\r\n            });\r\n        }\r\n    }\r\n    if (layersCurrent !== null) {\r\n        let texture = layerTextureMap.get(layersCurrent.id);\r\n        if (texture == null) {\r\n            texture = createTextureWithFramebuffer(gl, allTextures, textureBindings, resolution);\r\n            layerTextureMap.set(layersCurrent.id, texture);\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, args.textureCurrent.framebuffer);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        textureShader.render(gl, {\r\n            blocks: [\r\n                {\r\n                    x0: 0,\r\n                    y0: 0,\r\n                    x1: resolution.x,\r\n                    y1: resolution.y,\r\n                },\r\n            ],\r\n            framebuffer: args.textureCurrent.framebuffer,\r\n            uniforms: {\r\n                u_opacity: layersCurrent.opacity,\r\n                u_resolution: resolution,\r\n                u_texture: ensureTextureIsBound(gl, textureBindings, texture),\r\n            },\r\n        });\r\n    }\r\n}\r\nfunction ensureTextureIsBound(gl, textureBindings, { texture, id }) {\r\n    for (let i = 0; i < textureBindings.length; i++) {\r\n        if (textureBindings[i][0] === id) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            return i;\r\n        }\r\n    }\r\n    // Texture isn't bound yet. We need to find an open binding\r\n    for (let i = 0; i < textureBindings.length; i++) {\r\n        if (textureBindings[i][0] === null) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            gl.bindTexture(gl.TEXTURE_2D, texture);\r\n            textureBindings[i] = [id, performance.now()];\r\n            return i;\r\n        }\r\n    }\r\n    // There is no open binding. We need to replace something that's already bound.\r\n    {\r\n        let minTime = Number.MAX_VALUE;\r\n        let minTimeIdx = 0;\r\n        for (let i = 0; i < textureBindings.length; i++) {\r\n            const time = textureBindings[i][1];\r\n            if (time < minTime) {\r\n                minTime = time;\r\n                minTimeIdx = i;\r\n            }\r\n        }\r\n        gl.activeTexture(gl.TEXTURE0 + minTimeIdx);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        textureBindings[minTimeIdx] = [id, performance.now()];\r\n        return minTimeIdx;\r\n    }\r\n}\r\n","import * as Layers from \"../layers/model\";\r\nimport * as Tools from \"../tools\";\r\nimport * as Rng from \"../rng\";\r\nimport * as Theme from \"../theme\";\r\nimport * as Context from \"./context\";\r\nimport { Vec2, Result, PerfTracker } from \"../util\";\r\nexport function initState() {\r\n    const [theme, rng] = Theme.random(Rng.XorshiftSeed.create(145264772));\r\n    return {\r\n        rng,\r\n        theme,\r\n        tool: Tools.init(),\r\n        layers: Layers.State.init(),\r\n        hasPressedDown: false,\r\n    };\r\n}\r\nexport function initEphemeral() {\r\n    return {\r\n        tool: Tools.initEphemeral(),\r\n    };\r\n}\r\nexport var CanvasMsgType;\r\n(function (CanvasMsgType) {\r\n    CanvasMsgType[CanvasMsgType[\"OnFrame\"] = 0] = \"OnFrame\";\r\n    CanvasMsgType[CanvasMsgType[\"OnClick\"] = 1] = \"OnClick\";\r\n    CanvasMsgType[CanvasMsgType[\"OnRelease\"] = 2] = \"OnRelease\";\r\n    CanvasMsgType[CanvasMsgType[\"OnDrag\"] = 3] = \"OnDrag\";\r\n    CanvasMsgType[CanvasMsgType[\"RandomizeTheme\"] = 4] = \"RandomizeTheme\";\r\n    CanvasMsgType[CanvasMsgType[\"ToolMsg\"] = 5] = \"ToolMsg\";\r\n    CanvasMsgType[CanvasMsgType[\"LayersMsg\"] = 6] = \"LayersMsg\";\r\n})(CanvasMsgType || (CanvasMsgType = {}));\r\nclass OnFrame {\r\n    constructor(ms) {\r\n        this.ms = ms;\r\n        this.type = CanvasMsgType.OnFrame;\r\n    }\r\n}\r\nclass OnClick {\r\n    constructor(input) {\r\n        this.input = input;\r\n        this.type = CanvasMsgType.OnClick;\r\n    }\r\n}\r\nclass OnRelease {\r\n    constructor(input) {\r\n        this.input = input;\r\n        this.type = CanvasMsgType.OnRelease;\r\n    }\r\n}\r\nclass OnDrag {\r\n    constructor(inputs) {\r\n        this.inputs = inputs;\r\n        this.type = CanvasMsgType.OnDrag;\r\n    }\r\n}\r\nclass RandomizeTheme {\r\n    constructor() {\r\n        this.type = CanvasMsgType.RandomizeTheme;\r\n    }\r\n}\r\nclass ToolMsg {\r\n    constructor(msg) {\r\n        this.msg = msg;\r\n        this.type = CanvasMsgType.ToolMsg;\r\n    }\r\n}\r\nclass LayersMsg {\r\n    constructor(msg) {\r\n        this.msg = msg;\r\n        this.type = CanvasMsgType.LayersMsg;\r\n    }\r\n}\r\nexport var EffectType;\r\n(function (EffectType) {\r\n    EffectType[EffectType[\"NoOpEffect\"] = 0] = \"NoOpEffect\";\r\n    EffectType[EffectType[\"FrameEffect\"] = 1] = \"FrameEffect\";\r\n    EffectType[EffectType[\"BrushPointsEffect\"] = 2] = \"BrushPointsEffect\";\r\n    EffectType[EffectType[\"ReleaseEffect\"] = 3] = \"ReleaseEffect\";\r\n})(EffectType || (EffectType = {}));\r\nclass NoOpEffect {\r\n    constructor() {\r\n        this.type = EffectType.NoOpEffect;\r\n    }\r\n}\r\nNoOpEffect.value = new NoOpEffect();\r\nclass FrameEffect {\r\n    constructor(brushPoints, state) {\r\n        this.brushPoints = brushPoints;\r\n        this.state = state;\r\n        this.type = EffectType.FrameEffect;\r\n    }\r\n}\r\nclass BrushPointsEffect {\r\n    constructor(brushPoints) {\r\n        this.brushPoints = brushPoints;\r\n        this.type = EffectType.BrushPointsEffect;\r\n    }\r\n}\r\nclass ReleaseEffect {\r\n    constructor(brushPoints) {\r\n        this.brushPoints = brushPoints;\r\n        this.type = EffectType.ReleaseEffect;\r\n    }\r\n}\r\nexport function createSender(sendMessage) {\r\n    return {\r\n        onFrame: timeMs => sendMessage(new OnFrame(timeMs)),\r\n        onClick: input => sendMessage(new OnClick(input)),\r\n        onRelease: input => sendMessage(new OnRelease(input)),\r\n        onDrag: input => sendMessage(new OnDrag(input)),\r\n        randomizeTheme: () => sendMessage(new RandomizeTheme()),\r\n        tool: Tools.createSender(msg => sendMessage(new ToolMsg(msg))),\r\n        layer: Layers.createSender(msg => sendMessage(new LayersMsg(msg))),\r\n    };\r\n}\r\nexport function update(state, ephemeral, msg) {\r\n    switch (msg.type) {\r\n        case CanvasMsgType.OnFrame: {\r\n            const [nextToolEphemeral, brushPoints] = Tools.onFrame(state.tool, ephemeral.tool, msg.ms);\r\n            const effect = new FrameEffect(brushPoints, state);\r\n            return [state, { tool: nextToolEphemeral }, effect];\r\n        }\r\n        case CanvasMsgType.OnClick: {\r\n            const [nextTool, nextToolEphemeral, brushPoints] = Tools.onClick(state.tool, ephemeral.tool, msg.input);\r\n            const nextState = { ...state, hasPressedDown: true, tool: nextTool };\r\n            const nextEphemeral = { tool: nextToolEphemeral };\r\n            const effect = new BrushPointsEffect(brushPoints);\r\n            return [nextState, nextEphemeral, effect];\r\n        }\r\n        case CanvasMsgType.OnRelease: {\r\n            const [nextTool, nextToolEphemeral, brushPoints] = Tools.onRelease(state.tool, ephemeral.tool, msg.input);\r\n            const nextState = { ...state, hasPressedDown: false, tool: nextTool };\r\n            const nextEphemeral = { tool: nextToolEphemeral };\r\n            const effect = new ReleaseEffect(brushPoints);\r\n            return [nextState, nextEphemeral, effect];\r\n        }\r\n        case CanvasMsgType.OnDrag: {\r\n            if (msg.inputs.length === 0) {\r\n                const errorMsg = \"Expected inputs be be 1 or greater\";\r\n                console.error(errorMsg, msg);\r\n                throw { [errorMsg]: msg };\r\n            }\r\n            if (!state.hasPressedDown) {\r\n                return [state, ephemeral, NoOpEffect.value];\r\n            }\r\n            const [nextTool, nextToolEphemeral, brushPoints] = Tools.onDrag(state.tool, ephemeral.tool, msg.inputs);\r\n            const nextState = { ...state, tool: nextTool };\r\n            const nextEphemeral = { tool: nextToolEphemeral };\r\n            const effect = new BrushPointsEffect(brushPoints);\r\n            return [nextState, nextEphemeral, effect];\r\n        }\r\n        case CanvasMsgType.RandomizeTheme: {\r\n            const [theme, rng] = Theme.random(state.rng);\r\n            const nextState = { ...state, rng, theme };\r\n            return [nextState, ephemeral, NoOpEffect.value];\r\n        }\r\n        case CanvasMsgType.ToolMsg: {\r\n            const nextState = { ...state, tool: Tools.update(state.tool, msg.msg) };\r\n            return [nextState, ephemeral, NoOpEffect.value];\r\n        }\r\n        case CanvasMsgType.LayersMsg: {\r\n            const nextState = { ...state, layers: state.layers.update(msg.msg) };\r\n            return [nextState, ephemeral, NoOpEffect.value];\r\n        }\r\n        default:\r\n            const never = msg;\r\n            throw { \"unexpected msg\": msg };\r\n    }\r\n}\r\nexport class Canvas {\r\n    constructor(canvasElement, initialState, hooks, context) {\r\n        this.canvasElement = canvasElement;\r\n        this.hooks = hooks;\r\n        this.context = context;\r\n        this.perfTracker = new PerfTracker({\r\n            maxSamples: 50,\r\n            onSamples: this.hooks.onStats,\r\n        });\r\n        this.splitLayers = initialState.layers.split();\r\n    }\r\n    static create(canvas, initialState, hooks) {\r\n        const context = Context.create(canvas);\r\n        if (Result.isOk(context)) {\r\n            if (process.env.NODE_ENV === \"development\") {\r\n                hooks.onWebglContextCreated(context[1][1]);\r\n            }\r\n            return new Canvas(canvas, initialState, hooks, context[1][0]);\r\n        }\r\n        console.error(\"Error in Context setup:\", context[1]);\r\n        return null;\r\n    }\r\n    update(newState) {\r\n        this.splitLayers = newState.layers.split();\r\n    }\r\n    handle(eff) {\r\n        switch (eff.type) {\r\n            case EffectType.NoOpEffect:\r\n                return;\r\n            case EffectType.FrameEffect: {\r\n                this.perfTracker.start();\r\n                this.context.addBrushPoints(eff.brushPoints);\r\n                const resolution = new Vec2(this.canvasElement.width, this.canvasElement.height);\r\n                const state = eff.state;\r\n                this.context.render({\r\n                    blendMode: Tools.getBlendMode(state.tool),\r\n                    nextLayers: this.splitLayers,\r\n                    resolution,\r\n                    brush: { softness: Tools.getSoftness(state.tool) },\r\n                });\r\n                this.perfTracker.end();\r\n                return;\r\n            }\r\n            case EffectType.BrushPointsEffect: {\r\n                this.context.addBrushPoints(eff.brushPoints);\r\n                return;\r\n            }\r\n            case EffectType.ReleaseEffect: {\r\n                this.context.addBrushPoints(eff.brushPoints);\r\n                this.context.endStroke();\r\n                return;\r\n            }\r\n            default:\r\n                const never = eff;\r\n                throw { \"unexpected effect\": eff };\r\n        }\r\n    }\r\n    dispose() {\r\n        this.context.dispose();\r\n    }\r\n}\r\n","import * as OutputShader from \"./outputShader\";\r\nimport * as BrushTextureShader from \"./brushTextureGenerator\";\r\nimport * as TextureShader from \"./textureShader\";\r\nimport * as ClearBlocksShader from \"./clearBlocksShader\";\r\nimport * as BrushShader from \"./brushShader\";\r\nimport * as BlockRender from \"./blockRender\";\r\nimport { Blend } from \"../webgl\";\r\nimport { Result, Vec2, Vec4 } from \"../util\";\r\nimport { RgbLinear } from \"color\";\r\nimport { Texture, createTextureWithFramebuffer, ensureTextureIsBound } from \"./texture\";\r\nimport * as Render from \"./render\";\r\nexport function create(canvas) {\r\n    const wglArgs = {\r\n        antialias: false,\r\n        depth: false,\r\n        alpha: false,\r\n        premultipliedAlpha: false,\r\n        stencil: false,\r\n        preserveDrawingBuffer: true,\r\n        desynchronized: true,\r\n    };\r\n    const gl = canvas.getContext(\"webgl\", wglArgs);\r\n    if (gl === null) {\r\n        console.error(\"Failed to initialize WebGL renderer for canvas: \", canvas);\r\n        return Result.err(\"Failed to initialize WebGL\");\r\n    }\r\n    const attrs = gl.getContextAttributes();\r\n    if (!(attrs && attrs.desynchronized)) {\r\n        console.warn(\"Low latency canvas not supported. Boo!\");\r\n    }\r\n    const floatLinearFiltering = gl.getExtension(\"OES_texture_float_linear\");\r\n    if (floatLinearFiltering === null) {\r\n        console.warn(`Couldn't enable \"OES_texture_float_linear\"`);\r\n    }\r\n    const floatTexture = gl.getExtension(\"OES_texture_float\");\r\n    if (floatTexture === null) {\r\n        console.warn(`Couldn't enable \"OES_texture_float\"`);\r\n    }\r\n    // TODO: check for half-float\r\n    // TODO: check for max textures\r\n    gl.viewport(0, 0, canvas.width, canvas.height);\r\n    gl.enable(WebGLRenderingContext.BLEND);\r\n    gl.disable(WebGLRenderingContext.DEPTH_TEST);\r\n    const { sfact, dfact } = Blend.factorsNormal;\r\n    gl.blendFunc(sfact, dfact);\r\n    const drawpointBatch = BrushShader.Shader.create(gl);\r\n    if (drawpointBatch === null) {\r\n        const msg = \"Failed to initialize BrushShader\";\r\n        console.error(msg);\r\n        return Result.err(msg);\r\n    }\r\n    const brushTextureGenerator = BrushTextureShader.Generator.create(gl);\r\n    if (brushTextureGenerator === null) {\r\n        const msg = \"Failed to initialize BrushTextureGenerator\";\r\n        console.error(msg);\r\n        return Result.err(msg);\r\n    }\r\n    const textureRenderer = TextureShader.Shader.create(gl);\r\n    if (textureRenderer === null) {\r\n        const msg = \"Failed to initialize TextureShader\";\r\n        console.error(msg);\r\n        return Result.err(msg);\r\n    }\r\n    const clearBlocksRenderer = ClearBlocksShader.Shader.create(gl);\r\n    if (clearBlocksRenderer === null) {\r\n        const msg = \"Failed to initialize ClearBlocksShader\";\r\n        console.error(msg);\r\n        return Result.err(msg);\r\n    }\r\n    const outputRenderer = OutputShader.Shader.create(gl);\r\n    if (outputRenderer === null) {\r\n        const msg = \"Failed to initialize OutputShader\";\r\n        console.error(msg);\r\n        return Result.err(msg);\r\n    }\r\n    gl.viewport(0, 0, canvas.width, canvas.height);\r\n    const context = new InternalContext({\r\n        gl,\r\n        brushTextureGenerator,\r\n        drawpointBatch,\r\n        outputRenderer,\r\n        textureRenderer,\r\n        clearBlocksRenderer,\r\n        resolution: new Vec2(canvas.width, canvas.height),\r\n    });\r\n    return Result.ok([context, gl]);\r\n}\r\nclass InternalContext {\r\n    constructor(args) {\r\n        this.gl = args.gl;\r\n        this.brushTextureGenerator = args.brushTextureGenerator;\r\n        this.textureRenderer = args.textureRenderer;\r\n        this.clearBlocksRenderer = args.clearBlocksRenderer;\r\n        this.outputRenderer = args.outputRenderer;\r\n        this.drawpointBatch = args.drawpointBatch;\r\n        this.allTextures = [];\r\n        this.textureBindings = new Array(32).fill([null, 0]);\r\n        this.layerTextureMap = new Map();\r\n        this.internalCanvasSize = args.resolution;\r\n        this.stroke = null;\r\n        this.renderBlocks = new BlockRender.BlockTracker();\r\n        this.prevLayers = {\r\n            above: [],\r\n            below: [],\r\n            current: null,\r\n        };\r\n        {\r\n            const size = new Vec2(128, 128);\r\n            this.brushTexture = createTextureWithFramebuffer(this.gl, this.allTextures, this.textureBindings, size);\r\n            this.brushTextureGenerator.generateBrushTexture(this.gl, {\r\n                framebuffer: this.brushTexture.framebuffer,\r\n                size: size,\r\n                uniforms: {\r\n                    u_softness: 0,\r\n                },\r\n            });\r\n        }\r\n        this.outputTexture = createTextureWithFramebuffer(this.gl, this.allTextures, this.textureBindings, args.resolution);\r\n        const outFramebuffer = this.outputTexture.framebuffer;\r\n        this.combinedLayers = {\r\n            above: createTextureWithFramebuffer(this.gl, this.allTextures, this.textureBindings, args.resolution),\r\n            below: createTextureWithFramebuffer(this.gl, this.allTextures, this.textureBindings, args.resolution),\r\n            current: createTextureWithFramebuffer(this.gl, this.allTextures, this.textureBindings, args.resolution),\r\n        };\r\n        // initialize background\r\n        this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER, outFramebuffer);\r\n        this.gl.viewport(0, 0, args.resolution.x, args.resolution.y);\r\n        this.gl.clearColor(0.6, 0.6, 0.6, 1);\r\n        this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT);\r\n        this.outputRenderer.render(this.gl, {\r\n            uniforms: {\r\n                u_resolution: args.resolution,\r\n                u_texture: ensureTextureIsBound(this.gl, this.textureBindings, this.outputTexture),\r\n            },\r\n            blocks: [\r\n                {\r\n                    x0: 0,\r\n                    y0: 0,\r\n                    x1: args.resolution.x,\r\n                    y1: args.resolution.y,\r\n                },\r\n            ],\r\n        });\r\n    }\r\n    addBrushPoints(brushPoints) {\r\n        this.drawpointBatch.addPoints(brushPoints);\r\n        this.renderBlocks.addPoints(brushPoints);\r\n    }\r\n    endStroke() {\r\n        endStroke(this);\r\n    }\r\n    render(args) {\r\n        render(this, args);\r\n    }\r\n    dispose() {\r\n        const { gl } = this;\r\n        this.brushTextureGenerator.dispose(gl);\r\n        this.textureRenderer.dispose(gl);\r\n        this.outputRenderer.dispose(gl);\r\n        this.drawpointBatch.dispose(gl);\r\n        for (const x of this.allTextures) {\r\n            gl.deleteTexture(x.texture);\r\n            if (x instanceof Texture) {\r\n                gl.deleteFramebuffer(x.framebuffer);\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction endStroke(context) {\r\n    const { gl, stroke, prevLayers, internalCanvasSize } = context;\r\n    if (stroke === null)\r\n        return;\r\n    if (prevLayers.current === null)\r\n        return;\r\n    gl.viewport(0, 0, context.internalCanvasSize.x, context.internalCanvasSize.y);\r\n    context.textureRenderer.render(gl, {\r\n        framebuffer: context.combinedLayers.current.framebuffer,\r\n        uniforms: {\r\n            u_opacity: 1,\r\n            u_resolution: internalCanvasSize,\r\n            u_texture: ensureTextureIsBound(context.gl, context.textureBindings, stroke),\r\n        },\r\n        blocks: context.renderBlocks.getStrokeBlocks(),\r\n    });\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, stroke.framebuffer);\r\n    gl.clearColor(0, 0, 0, 0);\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    context.renderBlocks.strokeEnded();\r\n}\r\nfunction render(context, { blendMode, nextLayers, resolution, brush }) {\r\n    const frameBlocks = context.renderBlocks.getFrameBlocks();\r\n    if (frameBlocks.length === 0) {\r\n        return;\r\n    }\r\n    const { gl } = context;\r\n    if (context.drawpointBatch.canFlush) {\r\n        if (nextLayers.current === null) {\r\n            console.warn(\"Drawpoint batch has data to flush, but no layer is currently selected\");\r\n        }\r\n        else {\r\n            let currentLayerTex = context.layerTextureMap.get(nextLayers.current.id);\r\n            if (currentLayerTex == null) {\r\n                currentLayerTex = createTextureWithFramebuffer(context.gl, context.allTextures, context.textureBindings, context.internalCanvasSize);\r\n                context.layerTextureMap.set(nextLayers.current.id, currentLayerTex);\r\n            }\r\n            const { brushTexture } = context;\r\n            context.brushTextureGenerator.generateBrushTexture(gl, {\r\n                framebuffer: brushTexture.framebuffer,\r\n                size: new Vec2(128, 128),\r\n                uniforms: {\r\n                    u_softness: Math.max(brush.softness, 0.000001),\r\n                },\r\n            });\r\n            gl.viewport(0, 0, resolution.x, resolution.y);\r\n            gl.bindFramebuffer(gl.FRAMEBUFFER, currentLayerTex.framebuffer);\r\n            context.drawpointBatch.flush(gl, {\r\n                blendMode,\r\n                uniforms: {\r\n                    u_resolution: resolution,\r\n                    u_texture: ensureTextureIsBound(context.gl, context.textureBindings, brushTexture),\r\n                },\r\n            });\r\n        }\r\n    }\r\n    const layersToCombine = Render.getLayersToCombine(context.prevLayers, nextLayers);\r\n    Render.combineLayers({\r\n        gl,\r\n        resolution,\r\n        allTextures: context.allTextures,\r\n        layerTextureMap: context.layerTextureMap,\r\n        textureBindings: context.textureBindings,\r\n        textureShader: context.textureRenderer,\r\n        layersToRender: layersToCombine,\r\n        textureAbove: context.combinedLayers.above,\r\n        textureBelow: context.combinedLayers.below,\r\n        textureCurrent: context.combinedLayers.current,\r\n    });\r\n    // render to outputTexture\r\n    const outFramebuffer = context.outputTexture.framebuffer;\r\n    if (outFramebuffer == null) {\r\n        throw \"Out framebuffer should exist\";\r\n    }\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, outFramebuffer);\r\n    {\r\n        // need to clear the render blocks...\r\n        const bgColor = new RgbLinear(process.env.NODE_ENV === \"development\" ? 0.9 : 0.6, 0.6, 0.6);\r\n        context.clearBlocksRenderer.render(gl, {\r\n            framebuffer: outFramebuffer,\r\n            uniforms: {\r\n                u_resolution: resolution,\r\n                u_rgba: Vec4.fromRgba(bgColor, 1),\r\n            },\r\n            blocks: frameBlocks,\r\n        });\r\n    }\r\n    // BELOW\r\n    context.textureRenderer.render(gl, {\r\n        framebuffer: outFramebuffer,\r\n        uniforms: {\r\n            u_opacity: 1,\r\n            u_resolution: resolution,\r\n            u_texture: ensureTextureIsBound(context.gl, context.textureBindings, context.combinedLayers.below),\r\n        },\r\n        blocks: frameBlocks,\r\n    });\r\n    if (nextLayers.current !== null) {\r\n        // CURRENT\r\n        context.textureRenderer.render(gl, {\r\n            framebuffer: outFramebuffer,\r\n            uniforms: {\r\n                u_opacity: nextLayers.current.opacity,\r\n                u_resolution: resolution,\r\n                u_texture: ensureTextureIsBound(context.gl, context.textureBindings, context.combinedLayers.current),\r\n            },\r\n            blocks: frameBlocks,\r\n        });\r\n    }\r\n    // ABOVE\r\n    context.textureRenderer.render(gl, {\r\n        framebuffer: outFramebuffer,\r\n        uniforms: {\r\n            u_opacity: 1,\r\n            u_resolution: resolution,\r\n            u_texture: ensureTextureIsBound(context.gl, context.textureBindings, context.combinedLayers.above),\r\n        },\r\n        blocks: frameBlocks,\r\n    });\r\n    // outputTexture -> canvas\r\n    // I'm not sure if can use block rendering when rendering to canvas - unless there's something I'm missing, it seems that the canvas auto-clears itself before render\r\n    context.outputRenderer.render(gl, {\r\n        uniforms: {\r\n            u_resolution: resolution,\r\n            u_texture: ensureTextureIsBound(context.gl, context.textureBindings, context.outputTexture),\r\n        },\r\n        blocks: frameBlocks,\r\n    });\r\n    gl.flush();\r\n    //gl.finish()\r\n    context.prevLayers = nextLayers;\r\n    context.renderBlocks.afterFrame();\r\n}\r\n","/**\n * Event Handlers.\n *\n * Optimizing compilers should inline all this functions and completely remove unused code.\n */\nimport { doc } from \"../dom/shortcuts\";\nimport { withSchedulerTick } from \"../scheduler\";\nimport { dispatchEvent } from \"./dispatch\";\nimport { EVENT_CAPTURE_ACTIVE_OPTIONS } from \"./utils\";\nconst dispatchNativeEvent = (event, currentTarget, src) => (currentTarget.h.h(event, currentTarget.t, src));\n/**\n * Creates a native event source.\n *\n * @typeparam E Native event type.\n * @param flags See {@link NativeEventSourceFlags} for details.\n * @param name Event name\n * @param options Event handler options\n * @returns {@link NativeEventSource} instance\n */\nexport function createNativeEventSource(name, options = true) {\n    const source = {\n        next: (event) => {\n            dispatchEvent(source, event.target, event);\n        }\n    };\n    doc.addEventListener(name, withSchedulerTick((event) => { source.next(event); }), options);\n    return source;\n}\nexport function addNativeEventMiddleware(source, fn) {\n    const next = source.next;\n    source.next = (event) => { fn(event, next); };\n}\n/* tslint:disable:max-line-length */\nexport const ABORT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"abort\"));\nexport const ACTIVATE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"activate\"));\nexport const ARIA_REQUEST_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"ariarequest\"));\nexport const BEFORE_ACTIVATE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"beforeactivate\"));\nexport const BEFORE_COPY_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"beforecopy\"));\nexport const BEFORE_CUT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"beforecut\"));\nexport const BEFORE_DEACTIVATE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"beforedeactivate\"));\nexport const BEFORE_PASTE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"beforepaste\"));\nexport const BLUR_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"blur\"));\nexport const CAN_PLAY_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"canplay\"));\nexport const CAN_PLAYTHROUGH_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"canplaythrough\"));\nexport const CHANGE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"change\"));\nexport const CLICK_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"click\"));\nexport const CONTEXT_MENU_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"contextmenu\"));\nexport const COPY_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"copy\"));\nexport const CUE_CHANGE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"cuechange\"));\nexport const CUT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"cut\"));\nexport const DOUBLE_CLICK_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"dblclick\"));\nexport const DEACTIVATE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"deactivate\"));\nexport const DRAG_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"drag\"));\nexport const DRAG_END_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"dragend\"));\nexport const DRAG_ENTER_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"dragenter\"));\nexport const DRAG_LEAVE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"dragleave\"));\nexport const DRAG_OVER_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"dragover\"));\nexport const DRAG_START_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"dragstart\"));\nexport const DROP_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"drop\"));\nexport const DURATION_CHANGE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"durationchange\"));\nexport const EMPTIED_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"emptied\"));\nexport const ENCRYPTED_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"encrypted\"));\nexport const ENDED_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"ended\"));\nexport const ERROR_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"error\"));\nexport const FOCUS_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"focus\"));\nexport const GOT_POINTER_CAPTURE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"gotpointercapture\"));\nexport const BEFORE_INPUT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"beforeinput\"));\nexport const INPUT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"input\"));\nexport const INVALID_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"invalid\"));\nexport const KEY_DOWN_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"keydown\"));\nexport const KEY_PRESS_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"keypress\"));\nexport const KEY_UP_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"keyup\"));\nexport const LOAD_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"load\"));\nexport const LOADED_DATA_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"loadeddata\"));\nexport const LOADED_METADATA_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"loadedmetadata\"));\nexport const LOAD_START_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"loadstart\"));\nexport const LOST_POINTER_CAPTURE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"lostpointercapture\"));\nexport const MOUSE_DOWN_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"mousedown\"));\nexport const MOUSE_MOVE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"mousemove\"));\nexport const MOUSE_OUT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"mouseout\"));\nexport const MOUSE_OVER_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"mouseover\"));\nexport const MOUSE_UP_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"mouseup\"));\nexport const PASTE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"paste\"));\nexport const PAUSE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pause\"));\nexport const PLAY_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"play\"));\nexport const PLAYING_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"playing\"));\nexport const POINTER_CANCEL_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pointercancel\"));\nexport const POINTER_DOWN_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pointerdown\"));\nexport const POINTER_MOVE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pointermove\"));\nexport const POINTER_OUT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pointerout\"));\nexport const POINTER_OVER_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pointerover\"));\nexport const POINTER_UP_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"pointerup\"));\nexport const PROGRESS_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"progress\"));\nexport const RATE_CHANGE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"ratechange\"));\nexport const RESET_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"reset\"));\nexport const SCROLL_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"scroll\"));\nexport const SEEKED_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"seeked\"));\nexport const SEEKING_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"seeking\"));\nexport const SELECT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"select\"));\nexport const SELECT_START_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"selectstart\"));\nexport const STALLED_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"stalled\"));\nexport const SUBMIT_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"submit\"));\nexport const SUSPEND_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"suspend\"));\nexport const TIME_UPDATE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"timeupdate\"));\nexport const TOUCH_CANCEL_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchcancel\"));\nexport const TOUCH_END_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchend\"));\nexport const TOUCH_MOVE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchmove\"));\nexport const TOUCH_START_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchstart\"));\nexport const TRANSITION_CANCEL_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"transitioncancel\"));\nexport const TRANSITION_END_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"transitionend\"));\nexport const TRANSITION_RUN_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"transitionrun\"));\nexport const TRANSITION_START_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"transitionstart\"));\nexport const UNLOAD_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"unload\"));\nexport const VOLUME_CHANGE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"volumechange\"));\nexport const WAITING_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"waiting\"));\nexport const WHEEL_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"wheel\"));\nexport const ACTIVE_TOUCH_END_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchend\", EVENT_CAPTURE_ACTIVE_OPTIONS));\nexport const ACTIVE_TOUCH_MOVE_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchmove\", EVENT_CAPTURE_ACTIVE_OPTIONS));\nexport const ACTIVE_TOUCH_START_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"touchstart\", EVENT_CAPTURE_ACTIVE_OPTIONS));\nexport const ACTIVE_WHEEL_EVENT = (process.env.IVI_TARGET === \"ssr\" ? void 0 :\n    /*#__PURE__*/ createNativeEventSource(\"wheel\", EVENT_CAPTURE_ACTIVE_OPTIONS));\n/**\n * Helper function that creates native event handler factories.\n *\n * @param s Native event source.\n * @returns Native event handler factory.\n */\nexport function nativeEventHandlerFactory(s) {\n    const bubbleDescriptor = { s, h: dispatchNativeEvent, f: 0 };\n    const captureDescriptor = { s, h: dispatchNativeEvent, f: 1 /* Capture */ };\n    return (h, capture) => ({\n        d: capture === true ? captureDescriptor : bubbleDescriptor,\n        h,\n    });\n}\nexport const onAbort = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ABORT_EVENT));\nexport const onActivate = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ACTIVATE_EVENT));\nexport const onAriaRequest = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ARIA_REQUEST_EVENT));\nexport const onBeforeActivate = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BEFORE_ACTIVATE_EVENT));\nexport const onBeforeCopy = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BEFORE_COPY_EVENT));\nexport const onBeforeCut = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BEFORE_CUT_EVENT));\nexport const onBeforeDeactivate = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BEFORE_DEACTIVATE_EVENT));\nexport const onBeforePaste = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BEFORE_PASTE_EVENT));\nexport const onBlur = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BLUR_EVENT));\nexport const onCanPlay = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CAN_PLAY_EVENT));\nexport const onCanPlaythrough = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CAN_PLAYTHROUGH_EVENT));\nexport const onChange = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CHANGE_EVENT));\nexport const onClick = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CLICK_EVENT));\nexport const onContextMenu = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CONTEXT_MENU_EVENT));\nexport const onCopy = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(COPY_EVENT));\nexport const onCueChange = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CUE_CHANGE_EVENT));\nexport const onCut = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(CUT_EVENT));\nexport const onDoubleClick = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DOUBLE_CLICK_EVENT));\nexport const onDeactivate = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DEACTIVATE_EVENT));\nexport const onDrag = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DRAG_EVENT));\nexport const onDragEnd = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DRAG_END_EVENT));\nexport const onDragEnter = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DRAG_ENTER_EVENT));\nexport const onDragLeave = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DRAG_LEAVE_EVENT));\nexport const onDragOver = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DRAG_OVER_EVENT));\nexport const onDragStart = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DRAG_START_EVENT));\nexport const onDrop = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DROP_EVENT));\nexport const onDurationChange = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(DURATION_CHANGE_EVENT));\nexport const onEmptied = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(EMPTIED_EVENT));\nexport const onEncrypted = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ENCRYPTED_EVENT));\nexport const onEnded = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ENDED_EVENT));\nexport const onError = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ERROR_EVENT));\nexport const onFocus = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(FOCUS_EVENT));\nexport const onGotPointerCapture = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(GOT_POINTER_CAPTURE_EVENT));\nexport const onBeforeInput = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(BEFORE_INPUT_EVENT));\nexport const onInput = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(INPUT_EVENT));\nexport const onInvalid = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(INVALID_EVENT));\nexport const onKeyDown = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(KEY_DOWN_EVENT));\nexport const onKeyPress = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(KEY_PRESS_EVENT));\nexport const onKeyUp = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(KEY_UP_EVENT));\nexport const onLoad = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(LOAD_EVENT));\nexport const onLoadedData = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(LOADED_DATA_EVENT));\nexport const onLoadedMetadata = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(LOADED_METADATA_EVENT));\nexport const onLoadStart = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(LOAD_START_EVENT));\nexport const onLostPointerCapture = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(LOST_POINTER_CAPTURE_EVENT));\nexport const onMouseDown = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(MOUSE_DOWN_EVENT));\nexport const onMouseMove = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(MOUSE_MOVE_EVENT));\nexport const onMouseOut = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(MOUSE_OUT_EVENT));\nexport const onMouseOver = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(MOUSE_OVER_EVENT));\nexport const onMouseUp = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(MOUSE_UP_EVENT));\nexport const onPaste = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(PASTE_EVENT));\nexport const onPause = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(PAUSE_EVENT));\nexport const onPlay = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(PLAY_EVENT));\nexport const onPlaying = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(PLAYING_EVENT));\nexport const onPointerCancel = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(POINTER_CANCEL_EVENT));\nexport const onPointerDown = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(POINTER_DOWN_EVENT));\nexport const onPointerMove = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(POINTER_MOVE_EVENT));\nexport const onPointerOut = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(POINTER_OUT_EVENT));\nexport const onPointerOver = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(POINTER_OVER_EVENT));\nexport const onPointerUp = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(POINTER_UP_EVENT));\nexport const onProgress = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(PROGRESS_EVENT));\nexport const onRateChange = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(RATE_CHANGE_EVENT));\nexport const onReset = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(RESET_EVENT));\nexport const onScroll = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SCROLL_EVENT));\nexport const onSeeked = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SEEKED_EVENT));\nexport const onSeeking = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SEEKING_EVENT));\nexport const onSelect = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SELECT_EVENT));\nexport const onSelectStart = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SELECT_START_EVENT));\nexport const onStalled = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(STALLED_EVENT));\nexport const onSubmit = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SUBMIT_EVENT));\nexport const onSuspend = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(SUSPEND_EVENT));\nexport const onTimeUpdate = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TIME_UPDATE_EVENT));\nexport const onTouchCancel = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TOUCH_CANCEL_EVENT));\nexport const onTouchEnd = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TOUCH_END_EVENT));\nexport const onTouchMove = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TOUCH_MOVE_EVENT));\nexport const onTouchStart = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TOUCH_START_EVENT));\nexport const onTransitionCancel = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TRANSITION_CANCEL_EVENT));\nexport const onTransitionEnd = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TRANSITION_END_EVENT));\nexport const onTransitionRun = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TRANSITION_RUN_EVENT));\nexport const onTransitionStart = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(TRANSITION_START_EVENT));\nexport const onUnload = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(UNLOAD_EVENT));\nexport const onVolumeChange = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(VOLUME_CHANGE_EVENT));\nexport const onWaiting = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(WAITING_EVENT));\nexport const onWheel = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(WHEEL_EVENT));\nexport const onActiveTouchEnd = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ACTIVE_TOUCH_END_EVENT));\nexport const onActiveTouchMove = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ACTIVE_TOUCH_MOVE_EVENT));\nexport const onActiveTouchStart = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ACTIVE_TOUCH_START_EVENT));\nexport const onActiveWheel = (process.env.IVI_TARGET === \"ssr\" ? /* istanbul ignore next */ () => null :\n    /*#__PURE__*/ nativeEventHandlerFactory(ACTIVE_WHEEL_EVENT));\n/* tslint:enable:max-line-length */\n//# sourceMappingURL=native_events.js.map","import { PASSIVE_EVENTS } from \"../dom/feature_detection\";\n/* istanbul ignore next */\n/**\n * getEventTarget retrieves target element from an event.\n *\n * There are still some differences in modern browsers, so we need to use this function to retrieve event targets.\n *\n * #quirks\n *\n * @param ev Event.\n * @returns Target Element.\n */\nexport function getEventTarget(ev) {\n    let target = ev.target || window;\n    /**\n     * Some browsers are implementing it according to SVG 1.1 specs:\n     *\n     * https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7998724/\n     *\n     * \"If event attributes are assigned to referenced elements, then the actual target for the event will be the\n     * SVGElementInstance object within the 'instance tree' corresponding to the given referenced element.\"\n     *\n     * https://www.w3.org/TR/SVG/struct.html#UseElement\n     *\n     * SVG 2 redefined the use event handling model:\n     *\n     * - Removed the SVGElementInstance and SVGElementInstanceList interfaces, and the corresponding attributes on the\n     *   SVGUseElement interface.\n     * - Changed the use element event flow to follow the Shadow DOM spec.\n     *\n     * https://www.w3.org/TR/SVG2/changes.html#structure\n     */\n    if (target.correspondingUseElement !== void 0) {\n        target = target.correspondingUseElement;\n    }\n    return target;\n}\n/* istanbul ignore next */\n/**\n * `{ capture: true, passive: true }` object that should be used as a 3rd parameter for `addEventListener` method.\n */\nexport const EVENT_CAPTURE_PASSIVE_OPTIONS = PASSIVE_EVENTS ? { \"capture\": true, \"passive\": true } : true;\n/* istanbul ignore next */\n/**\n * `{ capture: true, passive: false }` object that should be used as a 3rd parameter for `addEventListener` method.\n */\nexport const EVENT_CAPTURE_ACTIVE_OPTIONS = PASSIVE_EVENTS ? { \"capture\": true, \"passive\": false } : true;\n/* istanbul ignore next */\n/**\n * `{ passive: true }` object that should be used as a 3rd parameter for `addEventListener` method.\n */\nexport const EVENT_PASSIVE_OPTIONS = PASSIVE_EVENTS ? { \"passive\": true } : false;\n/* istanbul ignore next */\n/**\n * `{ passive: false }` object that should be used as a 3rd parameter for `addEventListener` method.\n */\nexport const EVENT_ACTIVE_OPTIONS = PASSIVE_EVENTS ? { \"passive\": false } : false;\n//# sourceMappingURL=utils.js.map","/**\n * Feature Detection is used to implement polyfills or just disable some features when browser doesn't support them.\n * For example, when browser doesn't support passive events, we can just ignore it and always use active events.\n */\n/* istanbul ignore next */\n/**\n * Passive event listeners are a new feature in the DOM spec that enable developers to opt-in to better scroll\n * performance by eliminating the need for scrolling to block on touch and wheel event listeners. Developers can\n * annotate touch and wheel listeners with {passive: true} to indicate that they will never invoke preventDefault.\n *\n * https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n */\nexport const PASSIVE_EVENTS = ((process.env.IVI_TARGET === \"ssr\") ? false :\n    (process.env.IVI_TARGET === \"electron\") ? true :\n        /*#__PURE__*/ (() => {\n            let v = false;\n            try {\n                // Test via a getter in the options object to see if the passive property is accessed\n                window.addEventListener(\"_\", null, {\n                    get passive() {\n                        return v = true;\n                    }\n                });\n            }\n            catch (e) {\n                // ignore\n            }\n            return v;\n        })());\n/* istanbul ignore next */\n/**\n * `key` property is available on KeyboardEvent instances.\n */\nexport const KEYBOARD_EVENT_KEY = ((process.env.IVI_TARGET !== \"ssr\") && ((process.env.IVI_TARGET === \"electron\") ||\n    (process.env.IVI_TARGET === \"evergreen\") ||\n    /*#__PURE__*/ KeyboardEvent.prototype.hasOwnProperty(\"key\")));\n/* istanbul ignore next */\n/**\n * `buttons` property is available on MouseEvent instances.\n */\nexport const MOUSE_EVENT_BUTTONS = ((process.env.IVI_TARGET !== \"ssr\") && ((process.env.IVI_TARGET === \"electron\") ||\n    (process.env.IVI_TARGET === \"evergreen\") ||\n    /*#__PURE__*/ MouseEvent.prototype.hasOwnProperty(\"buttons\")));\n/* istanbul ignore next */\n/**\n * Touch Events support.\n */\nexport const TOUCH_EVENTS = ((process.env.IVI_TARGET !== \"ssr\") &&\n    (\"ontouchstart\" in window));\n/* istanbul ignore next */\n/**\n * Pointer Events support.\n */\nexport const POINTER_EVENTS = ((process.env.IVI_TARGET !== \"ssr\") && ((process.env.IVI_TARGET === \"electron\") ||\n    (\"PointerEvent\" in window)));\n/* istanbul ignore next */\n/**\n * iOS proprietary GestureEvent.\n *\n * {@link https://developer.mozilla.org/en-US/docs/Web/API/GestureEvent}\n */\nexport const IOS_GESTURE_EVENT = ((process.env.IVI_TARGET === \"browser\") &&\n    (\"GestureEvent\" in window));\n/* istanbul ignore next */\n/**\n * InputDeviceCapabilities support.\n *\n * http://wicg.github.io/InputDeviceCapabilities/\n */\nexport const INPUT_DEVICE_CAPABILITIES = ((process.env.IVI_TARGET !== \"ssr\") && ((process.env.IVI_TARGET === \"electron\") ||\n    (\"InputDeviceCapabilities\" in window)));\n//# sourceMappingURL=feature_detection.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"primary\":\"views-buttons__primary--P_SV9\",\"ddefault\":\"views-buttons__ddefault--1BBT_\",\"sinkableUnsunk\":\"views-buttons__sinkableUnsunk--1PnHd\",\"sinkableSunk\":\"views-buttons__sinkableSunk--1ViVx\"};","/**\n * strictEqual returns `true` when `a` and `b` are strictly equal `===`.\n *\n * @param a\n * @param b\n * @returns `true` when `a` and `b` are strictly equal `===`.\n */\nexport const strictEqual = (a, b) => a === b;\n/**\n * shallowEqual returns `true` when objects are shallow equal.\n *\n * @param a\n * @param b\n * @returns `true` when props are shallow equal.\n */\nexport function shallowEqual(a, b) {\n    if (a !== b) {\n        const aKeys = Object.keys(a);\n        const bKeys = Object.keys(b);\n        if (aKeys.length !== bKeys.length) {\n            return false;\n        }\n        for (let i = 0; i < aKeys.length; ++i) {\n            const key = aKeys[i];\n            if (a[key] !== b[key]) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n/**\n * shallowEqualArray returns `true` when arrays are shallow equal.\n *\n * @param a\n * @param b\n * @returns `true` when arrays are shallow equal.\n */\nexport function shallowEqualArray(a, b) {\n    if (a !== b) {\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (let i = 0; i < a.length; ++i) {\n            if (a[i] !== b[i]) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=equal.js.map","/**\n * createStateNode creates a {@link StateNode} instance.\n *\n * @param op Operation.\n * @returns {@link StateNode} instance.\n */\nexport const createStateNode = (o) => ({ o, f: 0, c: null, s: null });\n//# sourceMappingURL=state.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"app-index__wrapper--8b_Tl\",\"bottomLeft\":\"app-index__bottomLeft--71o3Y\",\"bottomRight\":\"app-index__bottomRight--2qJ_T\",\"appContainer\":\"app-index__appContainer--1pytb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"views-colorWheel__container--3l98i\",\"cicleThumb\":\"views-colorWheel__cicleThumb--1syQZ\",\"areaThumb\":\"views-colorWheel__areaThumb--1ruwH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"views-colorDisplay__container--29MR4\",\"secondary\":\"views-colorDisplay__secondary--19HF5\",\"primary\":\"views-colorDisplay__primary--otL3I\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"views-row__row--2LRwx\",\"column\":\"views-row__column--3VaR6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"debugging-index__container--1RM8E\",\"contentContainer\":\"debugging-index__contentContainer--jBGUK\",\"monospaced\":\"debugging-index__monospaced--1arMB\"};","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textInput\":\"tools-brush__textInput--1Qy5H\",\"detailsContainer\":\"tools-brush__detailsContainer--2voTj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"views-inlineLabeled__container--1KSLm\",\"label\":\"views-inlineLabeled__label--17JF0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"surfaceLook\":\"views-surface__surfaceLook--1NdKb\",\"surface\":\"views-surface__surface--2Mync\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolBarContainer\":\"tools-toolbar__toolBarContainer--3Xlgx\",\"leftBar\":\"tools-toolbar__leftBar--2PlvS\"};","module.exports = require(\"regenerator-runtime\");\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"monospaced\":\"debugging-scripting__monospaced--1EwqA\",\"codeInput\":\"debugging-scripting__codeInput--3t0j8\"};","/**\n * box creates a boxed value.\n *\n * @typeparam T Value type.\n * @param v Value.\n * @returns Boxed value.\n */\nexport const box = (v) => ({ v });\n//# sourceMappingURL=box.js.map","import { useSelect } from \"./hooks\";\nimport { getDOMNode, visitNodes } from \"./reconciler\";\nexport function selector(s, areEqual) {\n    return (component) => useSelect(component, s, areEqual);\n}\n/**\n * findDOMNode finds a closest DOM node.\n *\n * @typeparam T DOM Node type.\n * @param box Boxed op node state.\n * @returns DOM Node or a `null` value.\n */\nexport const findDOMNode = (box) => box.v === null ? null : getDOMNode(box.v);\n/**\n * containsDOMElement returns `true` when `parent` contains a DOM element `element`.\n *\n * @param parent Op state node.\n * @param element DOM element.\n * @returns `true` when `parent` contains a DOM element `element`.\n */\nexport function containsDOMElement(parent, element) {\n    let result = false;\n    visitNodes(parent, (node) => {\n        if ((node.f & 2 /* Element */) !== 0) {\n            return (node.s.contains(element)) === true ?\n                (result = true, 1 /* StopImmediate */) :\n                2 /* Stop */;\n        }\n        return 0 /* Continue */;\n    });\n    return result;\n}\n/**\n * hasDOMElementChild returns `true` when `parent` has a DOM element child `child`.\n *\n * @param parent Op state node.\n * @param child DOM element.\n * @returns `true` when `parent` has a DOM element child `child`.\n */\nexport function hasDOMElementChild(parent, child) {\n    let result = false;\n    visitNodes(parent, (node) => {\n        if ((node.f & 2 /* Element */) !== 0) {\n            return (node.s === child) ?\n                (result = true, 1 /* StopImmediate */) :\n                2 /* Stop */;\n        }\n        return 0 /* Continue */;\n    });\n    return result;\n}\n//# sourceMappingURL=utils.js.map","import { UNMOUNT_TOKEN } from \"../core\";\nimport { component } from \"./factories\";\nimport { useUnmount } from \"./hooks\";\nfunction updateRef(prev, next, s) {\n    if (prev !== void 0 && prev !== next) {\n        prev.v = null;\n    }\n    next.v = s;\n    return next;\n}\nconst _Ref = component((s) => {\n    let _ref;\n    const h = (p) => ((p === UNMOUNT_TOKEN) ?\n        (_ref.v = null, void 0) :\n        (_ref = updateRef(_ref, p.r, s), p.c));\n    useUnmount(s, h);\n    return h;\n});\n/**\n * Ref creates a component that captures internal state into a boxed value.\n *\n * @param r Boxed value.\n * @param c Children operations.\n * @returns Ref node.\n */\nexport const Ref = (r, c) => _Ref({ r, c });\n//# sourceMappingURL=ref.js.map","import { NOOP } from \"../core\";\nimport { scheduleLayoutEffect } from \"../scheduler\";\nimport { emitChildren, emitAttribute } from \"../ssr/render\";\n/**\n * {@link AttributeDirective} that ignores rendering to string.\n */\nexport const IGNORE_RENDER_TO_STRING = ({ v: void 0, s: NOOP });\n/**\n * PROPERTY function creates an {@link AttributeDirective} that assigns a property to a property name derived from the\n * `key` of the attribute.\n *\n * When rendered to string, it will be ignored.\n *\n * @example\n *\n *   const e = div(\"\", { _customProperty: PROPERTY(\"value\") });\n *\n * @typeparam Property value type.\n * @param v Property value.\n * @returns {@link AttributeDirective}\n */\nexport const PROPERTY = (v) => (process.env.IVI_TARGET === \"ssr\" ? IGNORE_RENDER_TO_STRING : ({ v, u: updateProperty }));\n/**\n * Update function for an {@link AttributeDirective} created with a {@link PROPERTY} function.\n *\n * @param element Target element.\n * @param key Attribute key.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction updateProperty(element, key, prev, next) {\n    if (prev !== next && next !== void 0) {\n        element[key] = next;\n    }\n}\n/**\n * UNSAFE_HTML function creates a {@link AttributeDirective} that assigns an `innerHTML` property to an Element.\n *\n * When rendered to string, it will emit its value as inner HTML without any escaping.\n *\n * @example\n *\n *   const e = div(\"\", { unsafeHTML: UNSAFE_HTML(\"<span></span>\") });\n *\n * @param v innerHTML value.\n * @returns {@link AttributeDirective}\n */\nexport const UNSAFE_HTML = (v) => (process.env.IVI_TARGET === \"ssr\" ?\n    ({ v, s: renderToStringUnsafeHTML }) :\n    ({ v, u: updateUnsafeHTML }));\n/**\n * Render to string function for an {@link AttributeDirective} created with {@link UNSAFE_HTML} function.\n *\n * @param key Attribute key.\n * @param value Value.\n */\nfunction renderToStringUnsafeHTML(key, value) {\n    emitChildren(value);\n}\n/**\n * Update function for an {@link AttributeDirective} created with {@link UNSAFE_HTML} function.\n *\n * @param element Target element.\n * @param key Attribute key.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction updateUnsafeHTML(element, key, prev, next) {\n    if (prev !== next) {\n        if (next === void 0) {\n            element.innerHTML = \"\";\n        }\n        else if (prev !== void 0 || next !== \"\") {\n            element.innerHTML = next;\n        }\n    }\n}\n/**\n * EVENT function creates an {@link AttributeDirective} that assigns a native event handler derived from the `key`\n * attribute to an Element.\n *\n * When rendered to string, it will be ignored.\n *\n * @example\n *\n *   const e = div(\"\", { click: EVENT((ev) => { console.log(ev) }); });\n *\n * @param v Event handler.\n * @returns {@link AttributeDirective}\n */\nexport const EVENT = (v) => (process.env.IVI_TARGET === \"ssr\" ?\n    IGNORE_RENDER_TO_STRING :\n    ({ v, u: updateEvent }));\n/**\n * Update function for an {@link AttributeDirective} created with {@link EVENT} function.\n *\n * @param element Target element.\n * @param key Attribute key.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction updateEvent(element, key, prev, next) {\n    if (prev !== next) {\n        if (prev !== void 0) {\n            element.removeEventListener(key, prev);\n        }\n        if (next !== void 0) {\n            element.addEventListener(key, next);\n        }\n    }\n}\n/**\n * Synchronization function for {@link AttributeDirective} created with {@link AUTOFOCUS} function.\n *\n * @param element Target element.\n * @param key Attribute key.\n * @param prev Previous value.\n * @param next Next value.\n */\nfunction updateAutofocus(element, key, prev, next) {\n    if (prev === void 0 && next) {\n        scheduleLayoutEffect(() => { element.focus(); });\n    }\n}\n/**\n * {@link AttributeDirective} with `false` value and {@link updateAutofocus} sync function.\n */\nconst AUTOFOCUS_FALSE = { v: false, u: updateAutofocus };\n/**\n * {@link AttributeDirective} with `true` value and {@link updateAutofocus} sync function.\n */\nconst AUTOFOCUS_TRUE = { v: true, u: updateAutofocus };\n/**\n * {@link AttributeDirective} with `true` value that emits `autofocus` attribute.\n */\nconst AUTOFOCUS_TRUE_RENDER_TO_STRING = {\n    v: true,\n    s: () => { emitAttribute(\"autofocus\"); },\n};\n/**\n * AUTOFOCUS function creates a {@link AttributeDirective} that sets autofocus on an element.\n *\n * When rendered to string, it will emit `autofocus` attribute.\n *\n * @example\n *\n *   const e = input(\"\", { autofocus: AUTOFOCUS(true) });\n *\n * @param v Autofocus state.\n * @returns {@link AttributeDirective}\n */\nexport const AUTOFOCUS = (v) => (process.env.IVI_TARGET === \"ssr\" ?\n    v ? AUTOFOCUS_TRUE_RENDER_TO_STRING : IGNORE_RENDER_TO_STRING :\n    v ? AUTOFOCUS_TRUE : AUTOFOCUS_FALSE);\n//# sourceMappingURL=attribute_directive.js.map","import { _, memo, shallowEqual } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as Tools from \".\";\r\nimport * as Brush from \"./brush\";\r\nimport * as Eraser from \"./eraser\";\r\nimport { SinkableButton } from \"../views/buttons\";\r\nimport { surfaceLook } from \"../views/surface\";\r\nimport * as styles from \"./toolbar.scss\";\r\nexport const View = memo((props) => {\r\n    const currentToolType = props.tool.current;\r\n    const setTool = props.msgSender.setTool;\r\n    return div(styles.toolBarContainer, _, [\r\n        div(surfaceLook + \" \" + styles.leftBar, _, [\r\n            SinkableButton({\r\n                isDown: currentToolType === Tools.ToolType.Brush,\r\n                onClick: () => setTool(Tools.ToolType.Brush),\r\n                children: \"\",\r\n            }),\r\n            SinkableButton({\r\n                isDown: currentToolType === Tools.ToolType.Eraser,\r\n                onClick: () => setTool(Tools.ToolType.Eraser),\r\n                children: \"\",\r\n            }),\r\n            SinkableButton({\r\n                isDown: currentToolType === Tools.ToolType.Zoom,\r\n                onClick: () => setTool(Tools.ToolType.Zoom),\r\n                children: \"\",\r\n            }),\r\n        ]),\r\n        !props.transientState.isDetailsExpanded\r\n            ? null\r\n            : (() => {\r\n                switch (currentToolType) {\r\n                    case Tools.ToolType.Brush:\r\n                        return Brush.Details({\r\n                            messageSender: props.msgSender.brush,\r\n                            tool: props.tool.brush,\r\n                        });\r\n                    case Tools.ToolType.Eraser:\r\n                        return Eraser.Details({\r\n                            messageSender: props.msgSender.eraser,\r\n                            tool: props.tool.eraser,\r\n                        });\r\n                    default:\r\n                        return null;\r\n                }\r\n            })(),\r\n    ]);\r\n}, shallowEqual);\r\n","import { findRoot } from \"../vdom/root\";\n/**\n * collectDispatchTargets traverses the DOM tree from the `target` Element to the root element, then goes down\n * through Virtual DOM tree and collects matching Event Handlers.\n *\n * @param result Accumulated Dispatch Targets.\n * @param target Target DOM Element.\n * @param match Matching event source.\n * @returns Dispatch targets.\n */\nfunction collectDispatchTargets(target, match) {\n    const targets = [];\n    const root = findRoot((r) => r.container.contains(target));\n    if (root) {\n        const container = root.container;\n        if (container !== target) {\n            visitUp(targets, match, target, container, root.state);\n        }\n    }\n    return targets;\n}\nfunction visitUp(result, match, element, root, stateNode) {\n    const parentElement = element.parentNode;\n    return (parentElement === root || (stateNode = visitUp(result, match, parentElement, root, stateNode)) !== null) ?\n        visitDown(result, match, element, stateNode) :\n        null;\n}\nfunction visitDown(result, match, element, stateNode) {\n    if (stateNode !== null) {\n        const { f, c } = stateNode;\n        let r;\n        if ((f & 2 /* Element */) !== 0) {\n            if (stateNode.s === element) {\n                return stateNode;\n            }\n            if (c !== null) {\n                return visitDown(result, match, element, c);\n            }\n        }\n        else if ((f & (16 /* Events */ | 4 /* Component */ | 32 /* Context */)) !== 0) {\n            if ((r = visitDown(result, match, element, stateNode.c)) !== null) {\n                if ((f & 16 /* Events */) !== 0) {\n                    collectDispatchTargetsFromEventsOpState(result, stateNode, stateNode.o.v, match);\n                }\n                return r;\n            }\n        }\n        else if ((f & (128 /* Fragment */ | 8 /* TrackByKey */)) !== 0) {\n            for (let i = 0; i < c.length; i++) {\n                if ((r = visitDown(result, match, element, c[i])) !== null) {\n                    return r;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * collectDispatchTargetsFromEventsOpState accumulates matching Event Handlers in `result` array from the `target`\n * operation state.\n *\n * @param result Accumulated Dispatch Targets.\n * @param t Target operation state.\n * @param h Event handler.\n * @param match Matching function.\n */\nfunction collectDispatchTargetsFromEventsOpState(result, t, h, match) {\n    if (h !== null) {\n        if (h instanceof Array) {\n            let i = h.length;\n            while (--i >= 0) {\n                collectDispatchTargetsFromEventsOpState(result, t, h[i], match);\n            }\n        }\n        else {\n            const source = h.d.s;\n            if ((typeof source === \"function\" && source(match) === true) ||\n                (source === match)) {\n                result.push({ t, h });\n            }\n        }\n    }\n}\n/**\n * dispatchEvent dispatches event to the list of dispatch targets.\n *\n * Simplified version of w3 Events flow algorithm. This algorithm doesn't include target phase, only capture and\n * bubbling phases. We don't care too much about w3 events compatibility, and there aren't any use cases that require\n * target phase.\n *\n * https://www.w3.org/TR/DOM-Level-3-Events/#event-flow\n *\n * @param src Event source.\n * @param targets Dispatch targets.\n * @param event Event to dispatch.\n * @param bubble Use bubbling phase.\n * @param dispatch Dispatch handler.\n */\nexport function dispatchEvent(src, target, event) {\n    const targets = collectDispatchTargets(target, src);\n    let i = targets.length;\n    let currentTarget;\n    let descriptor;\n    if (i > 0) {\n        // capture phase\n        while (--i >= 0) {\n            currentTarget = targets[i];\n            descriptor = currentTarget.h.d;\n            if ((descriptor.f & 1 /* Capture */) !== 0) {\n                if (descriptor.h(event, currentTarget, src) === true) {\n                    return;\n                }\n            }\n        }\n        // bubble phase\n        while (++i < targets.length) {\n            currentTarget = targets[i];\n            descriptor = currentTarget.h.d;\n            if ((descriptor.f & 1 /* Capture */) === 0) {\n                if (descriptor.h(event, currentTarget, src) === true) {\n                    return;\n                }\n            }\n        }\n    }\n}\n//# sourceMappingURL=dispatch.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"detailsContainer\":\"tools-eraser__detailsContainer--1J20r\"};","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","export function listen(canvas, listeners) {\r\n    if (window.PointerEvent !== undefined) {\r\n        return listenForPointers(canvas, listeners);\r\n    }\r\n    else {\r\n        // Add touch as well?\r\n        return listenForMouse(canvas, listeners);\r\n    }\r\n}\r\nconst pointerSupportsPressure = {};\r\nfunction checkPressureSupport(ev) {\r\n    if (ev.pressure === 0.5)\r\n        return;\r\n    if (pointerSupportsPressure[ev.pointerId])\r\n        return;\r\n    pointerSupportsPressure[ev.pointerId] = true;\r\n}\r\nfunction getPressure(ev) {\r\n    return pointerSupportsPressure[ev.pointerId]\r\n        ? ev.pressure\r\n        : ev.pressure === 0.5\r\n            ? 1.0\r\n            : ev.pressure;\r\n}\r\nconst uncoalesce = (() => {\r\n    if (PointerEvent.prototype.getCoalescedEvents === undefined) {\r\n        return (ev) => [ev];\r\n    }\r\n    return (ev) => {\r\n        const coalescedEvents = ev.getCoalescedEvents();\r\n        return coalescedEvents;\r\n    };\r\n})();\r\nfunction localizePointer(bounds, time, event, \r\n// we get the pressure off of the original event because firefox's coalesced events have a bug which causes them to always be 0\r\noriginalEvent) {\r\n    const x = event.x - bounds.left;\r\n    const y = event.y - bounds.top;\r\n    return {\r\n        x,\r\n        y,\r\n        pressure: getPressure(originalEvent),\r\n        shift: event.shiftKey,\r\n        alt: event.altKey,\r\n        ctrl: event.ctrlKey,\r\n        time,\r\n    };\r\n}\r\nfunction uncoalesceAndLocalize(bounds, time, originalEvent) {\r\n    const events = uncoalesce(originalEvent);\r\n    const result = new Array(events.length);\r\n    for (let i = 0; i < events.length; i++) {\r\n        // we need to deal with pressure\r\n        result[i] = localizePointer(bounds, time, events[i], originalEvent);\r\n    }\r\n    return result;\r\n}\r\nfunction listenForPointers(canvas, listeners) {\r\n    const pointerDown = (ev) => {\r\n        if (ev.button === 1 || ev.button === 2) {\r\n            return;\r\n        }\r\n        const bounds = canvas.getBoundingClientRect();\r\n        const time = performance.now();\r\n        listeners.click(localizePointer(bounds, time, ev, ev));\r\n    };\r\n    const pointerUp = (ev) => {\r\n        const bounds = canvas.getBoundingClientRect();\r\n        const time = performance.now();\r\n        listeners.release(localizePointer(bounds, time, ev, ev));\r\n    };\r\n    const pointerMove = (ev) => {\r\n        const bounds = canvas.getBoundingClientRect();\r\n        const time = performance.now();\r\n        listeners.move(uncoalesceAndLocalize(bounds, time, ev));\r\n        // listeners.move([localizePointer(bounds, time, ev)])\r\n        if (ev.pressure > 0) {\r\n            listeners.drag(uncoalesceAndLocalize(bounds, time, ev));\r\n            // listeners.drag([localizePointer(bounds, time, ev)])\r\n        }\r\n    };\r\n    window.addEventListener(\"pointerdown\", checkPressureSupport);\r\n    canvas.addEventListener(\"pointerdown\", pointerDown);\r\n    window.addEventListener(\"pointerup\", pointerUp);\r\n    window.addEventListener(\"pointermove\", pointerMove);\r\n    return () => {\r\n        window.removeEventListener(\"pointerdown\", checkPressureSupport);\r\n        canvas.removeEventListener(\"pointerdown\", pointerDown);\r\n        window.removeEventListener(\"pointerup\", pointerUp);\r\n        window.removeEventListener(\"pointermove\", pointerMove);\r\n    };\r\n}\r\nfunction listenForMouse(canvas, listeners) {\r\n    let isDown = false;\r\n    const mouseDown = (ev) => {\r\n        if (ev.button === 1 || ev.button === 2) {\r\n            return;\r\n        }\r\n        const bounds = canvas.getBoundingClientRect();\r\n        const time = performance.now();\r\n        listeners.click(localizeMouse(bounds, time, ev, false));\r\n        isDown = true;\r\n    };\r\n    const mouseUp = (ev) => {\r\n        const bounds = canvas.getBoundingClientRect();\r\n        const time = performance.now();\r\n        listeners.release(localizeMouse(bounds, time, ev, true));\r\n        isDown = false;\r\n    };\r\n    const mouseMove = (ev) => {\r\n        const bounds = canvas.getBoundingClientRect();\r\n        const time = performance.now();\r\n        listeners.move([localizeMouse(bounds, time, ev, false)]);\r\n        if (isDown) {\r\n            listeners.drag([localizeMouse(bounds, time, ev, false)]);\r\n        }\r\n    };\r\n    canvas.addEventListener(\"mousedown\", mouseDown);\r\n    window.addEventListener(\"mouseup\", mouseUp);\r\n    window.addEventListener(\"mousemove\", mouseMove);\r\n    return () => {\r\n        canvas.removeEventListener(\"mousedown\", mouseDown);\r\n        window.removeEventListener(\"mouseup\", mouseUp);\r\n        window.removeEventListener(\"mousemove\", mouseMove);\r\n    };\r\n}\r\nfunction localizeMouse(bounds, time, ev, isRelease) {\r\n    const x = ev.x - bounds.left;\r\n    const y = ev.y - bounds.top;\r\n    return {\r\n        x,\r\n        y,\r\n        pressure: isRelease ? 0.0 : 1.0,\r\n        shift: ev.shiftKey,\r\n        alt: ev.altKey,\r\n        ctrl: ev.ctrlKey,\r\n        time,\r\n    };\r\n}\r\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","import { Events, useEffect, component, invalidate, _, onChange, box, Ref, findDOMNode, } from \"ivi\";\r\nimport { div, span, ul, textarea, li, CONTENT } from \"ivi-html\";\r\nimport * as styles from \"./scripting.scss\";\r\nexport const Scripting = component(c => {\r\n    const textareaRef = box(null);\r\n    let code = \"\";\r\n    function onInput(ev) {\r\n        code = ev.target.value;\r\n        invalidate(c);\r\n    }\r\n    function onKeyboard(ev) {\r\n        const textareaNode = findDOMNode(textareaRef);\r\n        if (textareaNode === null || textareaNode !== ev.target) {\r\n            return;\r\n        }\r\n        if (ev.key === \"Enter\" && !ev.shiftKey && !ev.altKey) {\r\n            ev.preventDefault();\r\n            try {\r\n                /* eslint-disable-next-line no-eval */\r\n                console.log(eval(\"var gl = props.gl.value;\\n\" + code));\r\n            }\r\n            catch { }\r\n            code = \"\";\r\n            invalidate(c);\r\n        }\r\n    }\r\n    const listenToKeyboard = useEffect(c, () => {\r\n        document.body.addEventListener(\"keydown\", onKeyboard);\r\n        return () => {\r\n            document.body.removeEventListener(\"keydown\", onKeyboard);\r\n        };\r\n    });\r\n    return (props) => {\r\n        listenToKeyboard();\r\n        return div(_, _, [\r\n            div(_, _, [\r\n                \"Variables\",\r\n                ul(_, _, li(_, _, [span(styles.monospaced, _, \"gl\"), \": WebGLRenderingContext\"])),\r\n            ]),\r\n            Ref(textareaRef, Events(onChange(onInput), textarea(styles.codeInput, {\r\n                content: CONTENT(code),\r\n            }))),\r\n        ]);\r\n    };\r\n});\r\n","export function create(initialValue) {\r\n    return new SignalWithPush(initialValue);\r\n}\r\nexport function map(signal, transform) {\r\n    return new SignalTransform(signal, transform);\r\n}\r\nexport function filter(signal, defaultValue, filter) {\r\n    return new SignalFilter(signal, defaultValue, filter);\r\n}\r\nclass SignalWithPush {\r\n    constructor(initialValue) {\r\n        this.handlers = [];\r\n        this.currentValue = initialValue;\r\n        this.signal = new SignalWrapper(this);\r\n    }\r\n    push(value) {\r\n        this.currentValue = value;\r\n        const handlers = this.handlers;\r\n        for (let i = 0; i < handlers.length; i++) {\r\n            handlers[i](value);\r\n        }\r\n    }\r\n    value() {\r\n        return this.currentValue;\r\n    }\r\n    subscribe(handler) {\r\n        this.handlers.push(handler);\r\n        return {\r\n            dispose: () => {\r\n                removeHandler(this.handlers, handler);\r\n            },\r\n        };\r\n    }\r\n}\r\nfunction removeHandler(handlers, handler) {\r\n    let idx = -1;\r\n    for (let i = 0; i < handlers.length; i++) {\r\n        if (handlers[i] === handler) {\r\n            idx = i;\r\n            break;\r\n        }\r\n    }\r\n    if (idx !== -1) {\r\n        handlers.splice(idx, 1);\r\n    }\r\n}\r\nclass SignalWrapper {\r\n    constructor(baseSignal) {\r\n        this.baseSignal = baseSignal;\r\n    }\r\n    value() {\r\n        return this.baseSignal.value();\r\n    }\r\n    subscribe(handler) {\r\n        return this.baseSignal.subscribe(handler);\r\n    }\r\n}\r\nclass SignalTransform {\r\n    constructor(baseSignal, transform) {\r\n        this.baseSignal = baseSignal;\r\n        this.transform = transform;\r\n    }\r\n    value() {\r\n        return this.transform(this.baseSignal.value());\r\n    }\r\n    subscribe(handler) {\r\n        const transformedHandler = (val) => {\r\n            handler(this.transform(val));\r\n        };\r\n        return this.baseSignal.subscribe(transformedHandler);\r\n    }\r\n}\r\nclass SignalFilter {\r\n    constructor(baseSignal, defaultValue, filter) {\r\n        this.baseSignal = baseSignal;\r\n        this.filter = filter;\r\n        const baseValue = baseSignal.value();\r\n        this.currentValue = filter(baseValue) ? baseValue : defaultValue;\r\n    }\r\n    value() {\r\n        return this.currentValue;\r\n    }\r\n    subscribe(handler) {\r\n        const filter = this.filter;\r\n        const filteredHandler = (val) => {\r\n            if (filter(val)) {\r\n                this.currentValue = val;\r\n                handler(val);\r\n            }\r\n        };\r\n        return this.baseSignal.subscribe(filteredHandler);\r\n    }\r\n}\r\n","import { _ } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./row.scss\";\r\nexport function Row({ spacing, children }) {\r\n    spacing = spacing || \"0\";\r\n    const spacedChildren = new Array(children.length);\r\n    if (children.length > 0) {\r\n        spacedChildren[0] = div(styles.column, _, children[0]);\r\n        for (let i = 1; i < children.length; i++) {\r\n            spacedChildren[i] = div(styles.column, { style: { \"margin-left\": spacing } }, children[i]);\r\n        }\r\n    }\r\n    return div(styles.row, _, spacedChildren);\r\n}\r\n","import { Events, onClick, _, memo, shallowEqual } from \"ivi\";\r\nimport { div, span } from \"ivi-html\";\r\nimport styles from \"./view.scss\";\r\nimport { Row } from \"../views/row\";\r\nimport { Slider } from \"../views/slider\";\r\nimport { Labeled } from \"../views/labeled\";\r\nimport { InlineLabeled } from \"../views/inlineLabeled\";\r\nimport { Switch } from \"../views/switch\";\r\nimport { DefaultButton } from \"../views/buttons\";\r\nimport { Surface } from \"../views/surface\";\r\nexport const LayersView = memo(({ layers, sender }) => {\r\n    const topLayers = layers.layers.children;\r\n    const current = layers.current();\r\n    return div(styles.layersWrapper, _, [\r\n        Surface(div(styles.layersControlsWrapper, _, [\r\n            Row({\r\n                spacing: \"0.25rem\",\r\n                children: [\r\n                    DefaultButton({\r\n                        onClick: () => sender.newLayer(current.id),\r\n                        title: \"New layer\",\r\n                        content: \"New\",\r\n                    }),\r\n                    DefaultButton({\r\n                        onClick: () => sender.removeLayer(current.id),\r\n                        title: \"Delete layer\",\r\n                        content: \"Delete\",\r\n                    }),\r\n                ],\r\n            }),\r\n            InlineLabeled({\r\n                label: \"Hidden\",\r\n                children: Switch({\r\n                    checked: current.isHidden,\r\n                    onCheck: isHidden => sender.setHidden(current.id, isHidden),\r\n                }),\r\n            }),\r\n            Labeled({\r\n                label: \"Opacity\",\r\n                value: current.opacity.toFixed(2),\r\n                children: Slider({\r\n                    percentage: current.opacity,\r\n                    onChange: pct => sender.setOpacity(current.id, pct),\r\n                }),\r\n            }),\r\n        ])),\r\n        div(styles.layersListWrapper, _, topLayers.map(layer => LayerView({\r\n            layer,\r\n            selectedId: current.id,\r\n            onClick: id => sender.selectLayer(id),\r\n        }))),\r\n    ]);\r\n}, shallowEqual);\r\nfunction LayerView(props) {\r\n    const { selectedId, layer } = props;\r\n    const isSelected = selectedId === layer.id;\r\n    const container = isSelected ? styles.selectedLayerWrapper : styles.unselectedLayerWrapper;\r\n    return Events(onClick(() => props.onClick(layer.id)), div(container, _, Surface([\r\n        div(styles.layerLeft),\r\n        div(styles.layerRight, _, [\r\n            div(styles.layerName, _, layer.name !== \"\" ? layer.name : \"Layer \" + layer.id),\r\n            div(styles.layerOpacity, _, layer.isHidden\r\n                ? \"Hidden\"\r\n                : span(_, _, [\r\n                    span(_, _, \"Opacity: \"),\r\n                    span(_, _, layer.opacity.toFixed(2)),\r\n                ])),\r\n        ]),\r\n    ])));\r\n}\r\n","import { component, _, invalidate, render, box, findDOMNode, useEffect, Ref, useLayoutEffect, } from \"ivi\";\r\nimport { div, canvas } from \"ivi-html\";\r\nimport * as styles from \"./index.scss\";\r\nimport * as Toolbar from \"../tools/toolbar\";\r\nimport * as Theme from \"../theme\";\r\nimport * as Layers from \"../layers/view\";\r\nimport * as Input from \"../input\";\r\nimport * as Canvas from \"../canvas\";\r\nimport * as Setup from \"./setup\";\r\nimport { SetOnce, FrameStream, Lazy, Store } from \"../util\";\r\nimport * as Buttons from \"../views/buttons\";\r\nimport * as Debugging from \"../debugging\";\r\nimport * as Signals from \"../signals\";\r\nconst App = component(c => {\r\n    const removeInputListeners = new SetOnce();\r\n    const cancelFrameStream = new SetOnce();\r\n    const canvasModel = new SetOnce();\r\n    const debuggingGl = new SetOnce();\r\n    const perfTrackerData = Signals.create([]);\r\n    const store = Store.create({\r\n        initialState: Canvas.initState(),\r\n        initialEphemeral: Canvas.initEphemeral(),\r\n        effectsHandler: new Lazy(() => (ef) => canvasModel.value.handle(ef)),\r\n        forceRender: () => invalidate(c),\r\n        update: Canvas.update,\r\n    });\r\n    const sender = Canvas.createSender(store.send);\r\n    const canvasRef = box(null);\r\n    let prevTheme = null;\r\n    const updateTheme = useEffect(c, nextTheme => {\r\n        if (prevTheme === null) {\r\n            Theme.updateAll(nextTheme);\r\n        }\r\n        else {\r\n            Theme.updateDiff(prevTheme, nextTheme);\r\n        }\r\n        prevTheme = nextTheme;\r\n    });\r\n    const updateCanvas = useLayoutEffect(c, nextState => {\r\n        canvasModel.value.update(nextState);\r\n    });\r\n    const setupCanvas = useLayoutEffect(c, () => {\r\n        console.log(\"Painter mounted\");\r\n        const htmlCanvas = findDOMNode(canvasRef);\r\n        if (htmlCanvas == null) {\r\n            throw \"Canvas not found\";\r\n        }\r\n        {\r\n            const canvas = Canvas.Canvas.create(htmlCanvas, store.getState(), {\r\n                onStats: stats => {\r\n                    perfTrackerData.push(stats);\r\n                },\r\n                onWebglContextCreated: gl => {\r\n                    debuggingGl.set(gl);\r\n                },\r\n            });\r\n            if (canvas === null) {\r\n                throw \"Failed to initialize Canvas\";\r\n            }\r\n            canvasModel.set(canvas);\r\n        }\r\n        removeInputListeners.set(Input.listen(htmlCanvas, {\r\n            click: sender.onClick,\r\n            release: sender.onRelease,\r\n            move: x => {\r\n                /**/\r\n            },\r\n            drag: sender.onDrag,\r\n        }));\r\n        cancelFrameStream.set(FrameStream.make(sender.onFrame));\r\n        if (process.env.NODE_ENV !== \"production\") {\r\n            Setup.setup(() => store.getState(), sender).then(() => {\r\n                invalidate(c);\r\n            });\r\n        }\r\n        return () => {\r\n            removeInputListeners.value();\r\n            cancelFrameStream.value();\r\n            canvasModel.value.dispose();\r\n            console.log(\"Painter unmounted\");\r\n        };\r\n    });\r\n    return () => {\r\n        const state = store.getState();\r\n        setupCanvas();\r\n        updateCanvas(state);\r\n        updateTheme(state.theme);\r\n        return div(styles.appContainer, _, [\r\n            div(styles.wrapper, _, [\r\n                Toolbar.View({\r\n                    msgSender: sender.tool,\r\n                    tool: state.tool,\r\n                    transientState: { isDetailsExpanded: true },\r\n                }),\r\n                Ref(canvasRef, canvas(_, { width: 800, height: 800, style: { cursor: \"crosshair \" } })),\r\n                div(_, { style: { width: \"14rem\" } }, Layers.LayersView({\r\n                    layers: state.layers,\r\n                    sender: sender.layer,\r\n                })),\r\n            ]),\r\n            div(styles.bottomLeft, _, Buttons.PrimaryButton({\r\n                content: \"Next theme\",\r\n                onClick: sender.randomizeTheme,\r\n            })),\r\n            process.env.NODE_ENV !== \"development\"\r\n                ? null\r\n                : div(styles.bottomRight, _, Debugging.DebugWindow({\r\n                    gl: debuggingGl,\r\n                    state,\r\n                    perfSamplesSignal: perfTrackerData.signal,\r\n                })),\r\n        ]);\r\n    };\r\n});\r\n{\r\n    const rootElement = document.getElementById(\"canvas-root\");\r\n    if (rootElement === null) {\r\n        throw \"canvas-root not found\";\r\n    }\r\n    render(App(), rootElement);\r\n    if (typeof module.hot === \"object\") {\r\n        module.hot.accept();\r\n    }\r\n}\r\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// This method of obtaining a reference to the global object needs to be\n// kept identical to the way it is obtained in runtime.js\nvar g = (function() {\n  return this || (typeof self === \"object\" && self);\n})() || Function(\"return this\")();\n\n// Use `getOwnPropertyNames` because not all browsers support calling\n// `hasOwnProperty` on the global `self` object in a worker. See #183.\nvar hadRuntime = g.regeneratorRuntime &&\n  Object.getOwnPropertyNames(g).indexOf(\"regeneratorRuntime\") >= 0;\n\n// Save the old regeneratorRuntime in case it needs to be restored later.\nvar oldRuntime = hadRuntime && g.regeneratorRuntime;\n\n// Force reevalutation of runtime.js.\ng.regeneratorRuntime = undefined;\n\nmodule.exports = require(\"./runtime\");\n\nif (hadRuntime) {\n  // Restore the original runtime.\n  g.regeneratorRuntime = oldRuntime;\n} else {\n  // Remove the global property added by runtime.js.\n  try {\n    delete g.regeneratorRuntime;\n  } catch(e) {\n    g.regeneratorRuntime = undefined;\n  }\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we're in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() {\n    return this || (typeof self === \"object\" && self);\n  })() || Function(\"return this\")()\n);\n","import { component, useEffect, _ } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nexport const Performance = component(c => {\r\n    let samples = SamplesOverTime.empty;\r\n    const subscribe = useEffect(c, samplesSignal => {\r\n        const { dispose } = samplesSignal.subscribe(nextSamples => {\r\n            samples = samples.update(nextSamples);\r\n        });\r\n        return dispose;\r\n    });\r\n    return (props) => {\r\n        subscribe(props.samplesSignal);\r\n        const samplecount = samples.length();\r\n        let max = Number.MIN_VALUE;\r\n        let sum = 0;\r\n        samples.forEach((sample, index) => {\r\n            const time = sample.endMs - sample.startMs;\r\n            sum += time;\r\n            if (time > max) {\r\n                max = time;\r\n            }\r\n        });\r\n        return div(_, _, [\r\n            div(_, _, \"Max: \" + max.toFixed(3) + \" ms\"),\r\n            div(_, _, \"Avg: \" + (sum / samplecount).toFixed(3) + \" ms\"),\r\n        ]);\r\n    };\r\n});\r\nclass SamplesOverTime {\r\n    constructor(sample0, sample1, sample2, sample3) {\r\n        this.sample0 = sample0;\r\n        this.sample1 = sample1;\r\n        this.sample2 = sample2;\r\n        this.sample3 = sample3;\r\n    }\r\n    update(sample) {\r\n        return new SamplesOverTime(sample, this.sample0, this.sample1, this.sample2);\r\n    }\r\n    length() {\r\n        return this.sample0.length + this.sample1.length + this.sample2.length + this.sample3.length;\r\n    }\r\n    forEach(f) {\r\n        let samples = this.sample0;\r\n        let length = 0;\r\n        for (let i = 0; i < samples.length; i++) {\r\n            f(samples[i], i);\r\n        }\r\n        length += samples.length;\r\n        samples = this.sample1;\r\n        for (let i = 0; i < samples.length; i++) {\r\n            f(samples[i], length + i);\r\n        }\r\n        length += samples.length;\r\n        samples = this.sample2;\r\n        for (let i = 0; i < samples.length; i++) {\r\n            f(samples[i], length + i);\r\n        }\r\n        length += samples.length;\r\n        samples = this.sample3;\r\n        for (let i = 0; i < samples.length; i++) {\r\n            f(samples[i], length + i);\r\n        }\r\n    }\r\n}\r\nSamplesOverTime.empty = new SamplesOverTime([], [], [], []);\r\nclass CircularArray {\r\n    constructor(size, defaultValue) {\r\n        this.size = size;\r\n        this.defaultValue = defaultValue;\r\n        this.nextIdx = 0;\r\n        const array = new Array(size);\r\n        for (let i = 0; i < size; i++) {\r\n            array[i] = defaultValue;\r\n        }\r\n        this.array = array;\r\n    }\r\n    push(value) {\r\n        const nextIdx = this.nextIdx;\r\n        this.array[nextIdx] = value;\r\n        this.nextIdx = (nextIdx + 1) % this.size;\r\n    }\r\n}\r\n","import { component, _, invalidate } from \"ivi\";\r\nimport { div } from \"ivi-html\";\r\nimport * as styles from \"./index.scss\";\r\nimport { Surface } from \"../views/surface\";\r\nimport { DefaultButton } from \"../views/buttons\";\r\nimport { Scripting } from \"./scripting\";\r\nimport { Performance } from \"./performance\";\r\n// let's get the webgl context in here somehow!\r\n// there's a lot of stuff I could use that for... maybe even eval?\r\nexport const DebugWindow = component(c => {\r\n    let isOpen = false;\r\n    function open() {\r\n        isOpen = true;\r\n        invalidate(c);\r\n    }\r\n    function close() {\r\n        isOpen = false;\r\n        invalidate(c);\r\n    }\r\n    return props => {\r\n        const { state } = props;\r\n        return Surface(!isOpen\r\n            ? DefaultButton({\r\n                onClick: open,\r\n                content: \"Debug\",\r\n            })\r\n            : div(styles.container, _, [\r\n                DefaultButton({\r\n                    content: \"Close\",\r\n                    onClick: close,\r\n                }),\r\n                div(styles.contentContainer, _, [\r\n                    \"RNG: \",\r\n                    div(styles.monospaced, _, state.rng.display()),\r\n                    Performance({\r\n                        samplesSignal: props.perfSamplesSignal,\r\n                    }),\r\n                    Scripting({\r\n                        gl: props.gl,\r\n                    }),\r\n                ]),\r\n            ]));\r\n    };\r\n});\r\n","/**\n * NOOP function.\n */\nexport const NOOP = () => { };\n/**\n * NOOP_FALSE function always returns `false` value.\n *\n * @returns `false` value.\n */\nexport const NOOP_FALSE = () => false;\n/**\n * NOOP_TRUE function always returns `true` value.\n *\n * @returns `true` value.\n */\nexport const NOOP_TRUE = () => true;\n//# sourceMappingURL=noop.js.map","import { strictEqual, shallowEqual, shallowEqualArray } from \"./equal\";\n/**\n * lazy creates a lazy value.\n *\n * @typeparam T return type.\n * @param fn value constructor.\n * @returns a function that returns a lazy value.\n */\nexport const lazy = (fn, v) => () => v === void 0 ? v = fn() : v;\n/**\n * memo creates a memoized function.\n *\n * @typeparam T input type.\n * @typeparam U output type.\n * @param fn\n * @param areEqual `areEqual` function.\n * @returns memoized function.\n */\nexport function memo(fn, areEqual = strictEqual) {\n    let prev;\n    let v;\n    return (props) => {\n        if (v === void 0 || areEqual(prev, props) !== true) {\n            prev = props;\n            v = fn(props);\n        }\n        return v;\n    };\n}\n/**\n * memoObject creates a memoized function with {@link shallowEqual} as a `areEqual` function.\n *\n * @typeparam T input type.\n * @typeparam U output type.\n * @param fn\n * @returns memoized function.\n */\nexport const memoObject = (fn) => memo(fn, shallowEqual);\n/**\n * memoArray creates a memoized function with {@link shallowEqualArray} as a `areEqual` function.\n *\n * @typeparam T input type.\n * @typeparam U output type.\n * @param fn\n * @returns memoized function.\n */\nexport const memoArray = (fn) => memo(fn, shallowEqualArray);\n//# sourceMappingURL=memo.js.map"],"sourceRoot":""}