parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"T1EE":[function(require,module,exports) {
"use strict";function t(t,n){return o(t)||i(t,n)||e(t,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function e(t,r){if(t){if("string"==typeof t)return n(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?n(t,r):void 0}}function n(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function i(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,i,o=[],a=!0,s=!1;try{for(e=e.call(t);!(a=(n=e.next()).done)&&(o.push(n.value),!r||o.length!==r);a=!0);}catch(c){s=!0,i=c}finally{try{a||null==e.return||e.return()}finally{if(s)throw i}}return o}}function o(t){if(Array.isArray(t))return t}var a,s;function c(r){var e=t(r.gridSize,2),n=e[0],i=e[1],o=f(n,i);return{initArgs:r,state:s.InProgress,gridSize:r.gridSize,grid:o,snake:{direction:r.dir,nextDirection:r.dir,nextNextDirection:null,length:r.snakeLength,position:r.position},noms:l(o,n,i)}}function u(r){for(var e=r.snake,n=r.grid,i=r.gridSize,o=r.initArgs,a=t(i,2),c=a[0],u=a[1],f=0;f<c;f++)for(var g=0;g<u;g++)n[f][g]=0;r.noms=l(n,c,u),r.state=s.InProgress,e.direction=o.dir,e.nextDirection=o.dir,e.nextNextDirection=null,e.length=o.snakeLength,e.position=o.position}function l(t,r,e){var n=Math.floor(Math.random()*r),i=Math.floor(Math.random()*e);return t[n][i]>0?l(t,r,e):[n,i]}function f(t,r){for(var e=new Array(t),n=0;n<t;n++){for(var i=new Array(r),o=0;o<r;o++)i[o]=0;e[n]=i}return e}function g(r){var e=d(r,r.snake.nextDirection);if(p(r,e))r.state=s.Lost;else{var n=t(e,2),i=n[0],o=n[1],a=r.grid,c=r.snake,u=r.noms,f=t(r.gridSize,2),g=f[0],x=f[1];if(c.position=[i,o],i===u[0]&&o===u[1])c.length++,a[i][o]=c.length,r.noms=l(a,g,x);else{for(var h=0;h<g;h++)for(var v=0;v<x;v++)a[h][v]>0&&a[h][v]--;a[i][o]=c.length}c.direction=c.nextDirection,c.nextDirection=null!==c.nextNextDirection?c.nextNextDirection:c.nextDirection,c.nextNextDirection=null}}function d(r,e){r.grid;var n=t(r.snake.position,2),i=n[0],o=n[1];switch(e){case a.Left:return[i-1,o];case a.Up:return[i,o-1];case a.Right:return[i+1,o];case a.Down:return[i,o+1]}}function p(r,e){var n=r.grid,i=t(r.gridSize,2),o=i[0],a=i[1],s=t(e,2),c=s[0],u=s[1];return c>=o||c<0||u>=a||u<0||n[c][u]>1}function x(t,r){var e=t.snake;e.direction===e.nextDirection?h(e.direction,r)&&(e.nextDirection=r):h(e.nextDirection,r)&&(e.nextNextDirection=r)}function h(t,r){switch(t){case a.Left:return r!==a.Right;case a.Right:return r!==a.Left;case a.Up:return r!==a.Down;case a.Down:return r!==a.Up}}function v(t){var r=t.snake,e=t.initArgs;return r.length-e.snakeLength}Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=c,exports.reinit=u,exports.update=g,exports.setDirection=x,exports.getScore=v,exports.GameState=exports.Dir=void 0,exports.Dir=a,function(t){t[t.Left=0]="Left",t[t.Up=1]="Up",t[t.Right=2]="Right",t[t.Down=3]="Down"}(a||(exports.Dir=a={})),exports.GameState=s,function(t){t[t.InProgress=0]="InProgress",t[t.InProgressAndPaused=1]="InProgressAndPaused",t[t.Lost=2]="Lost",t[t.Won=3]="Won"}(s||(exports.GameState=s={}));
},{}],"qTC0":[function(require,module,exports) {
"use strict";function e(e,n,t){var a=r(e,n,WebGLRenderingContext.VERTEX_SHADER),l=r(e,t,WebGLRenderingContext.FRAGMENT_SHADER);if(null===a||null===l)return null;var u=e.createProgram();if(null===u)return console.error("Failed to create program"),null;e.attachShader(u,a),e.attachShader(u,l);var g=o(e,u);return e.deleteShader(a),e.deleteShader(l),g}function r(e,r,o){var t=e.createShader(o);if(null===t)return console.error("Failed to create shader."),null;if(e.shaderSource(t,r),e.compileShader(t),e.getShaderParameter(t,WebGLRenderingContext.COMPILE_STATUS))return t;console.group("Failed to compile shader"),console.error("shader info log: ",e.getShaderInfoLog(t));var a=n(r);return console.log(a),console.groupEnd(),e.deleteShader(t),null}function o(e,r){return e.linkProgram(r),null!==r||e.getProgramParameter(r,WebGLRenderingContext.LINK_STATUS)?r:(console.group("Failed to link program"),console.error("error: ",e.getError()),console.log("validate status: ",e.getProgramParameter(r,WebGLRenderingContext.VALIDATE_STATUS)),console.log("program info log: ",e.getProgramInfoLog(r)),console.groupEnd(),e.deleteProgram(r),null)}function n(e){var r=e.split("\n"),o=r.length.toString().length;return r.map(function(e,r){return t(r.toString(10),o,"0")+"| "+e}).join("\n")}function t(e,r,o){var n=r-e.length;if(n<=0)return e;for(var t=[],a=0;a<n;a++)t.push(o);return t.push(e),t.join("")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createProgram=e;
},{}],"c6Sn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GridRenderingContext=void 0;var r=require("./glsl");function t(r,t){return a(r)||o(r,t)||n(r,t)||e()}function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(r,t){if(r){if("string"==typeof r)return i(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(r,t):void 0}}function i(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function o(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var n,i,o=[],a=!0,l=!1;try{for(e=e.call(r);!(a=(n=e.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==e.return||e.return()}finally{if(l)throw i}}return o}}function a(r){if(Array.isArray(r))return r}function l(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function c(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function s(r,t,e){return t&&c(r.prototype,t),e&&c(r,e),r}var u=5,f="\nprecision highp float;\n\nattribute vec2 a_position;\nattribute vec3 a_color;\n\nuniform vec2 canvas_resolution;\n\nvarying vec3 v_color;\n\nvoid main() {\n    vec2 pos = (a_position / canvas_resolution) * vec2(2.0, -2.0) + vec2(-1.0, 1.0);\n    gl_Position = vec4(pos, 0.0, 1.0);\n    v_color = a_color;\n}\n",v="\nprecision highp float;\n\nvarying vec3 v_color;\n\nvoid main() {\n    gl_FragColor = vec4(v_color, 1.0);\n}\n",h=function(){function e(t,n,i){l(this,e),this.gl=t,this.canvasSize=n,this.gridSize=i,this.blockSize=[Math.ceil(n[0]/i[0]),Math.ceil(n[1]/i[1])],this.program=(0,r.createProgram)(t,f,v);var o=i[0]*i[1];this.buf=t.createBuffer(),this.array=new Float32Array(6*o*u),this.sizeUniform=t.getUniformLocation(this.program,"canvas_resolution"),t.useProgram(this.program),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.bindAttribLocation(this.program,0,"a_position"),t.bindAttribLocation(this.program,1,"a_color")}return s(e,[{key:"bufferGrid",value:function(r){for(var e=this.array,n=this.gridSize,i=t(this.blockSize,2),o=i[0],a=i[1],l=0,c=0;c<n[1];c++)for(var s=c*a,u=s+a,f=0;f<n[0];f++){var v=f*o,h=v+o,b=r(f,c),y=b.r,g=b.g,p=b.b;e[l++]=v,e[l++]=s,e[l++]=y,e[l++]=g,e[l++]=p,e[l++]=v,e[l++]=u,e[l++]=y,e[l++]=g,e[l++]=p,e[l++]=h,e[l++]=s,e[l++]=y,e[l++]=g,e[l++]=p,e[l++]=h,e[l++]=u,e[l++]=y,e[l++]=g,e[l++]=p,e[l++]=v,e[l++]=u,e[l++]=y,e[l++]=g,e[l++]=p,e[l++]=h,e[l++]=s,e[l++]=y,e[l++]=g,e[l++]=p}}},{key:"setColor",value:function(r,e,n){var i=n.r,o=n.g,a=n.b,l=this.array,c=this.gridSize,s=t(this.blockSize,2),f=s[0],v=s[1],h=6*(c[0]*e+r)*u,b=e*v,y=b+v,g=r*f,p=g+f;l[h++]=g,l[h++]=b,l[h++]=i,l[h++]=o,l[h++]=a,l[h++]=g,l[h++]=y,l[h++]=i,l[h++]=o,l[h++]=a,l[h++]=p,l[h++]=b,l[h++]=i,l[h++]=o,l[h++]=a,l[h++]=p,l[h++]=y,l[h++]=i,l[h++]=o,l[h++]=a,l[h++]=g,l[h++]=y,l[h++]=i,l[h++]=o,l[h++]=a,l[h++]=p,l[h++]=b,l[h++]=i,l[h++]=o,l[h++]=a}},{key:"flush",value:function(){var r=this.gl,t=this.canvasSize,e=this.gridSize,n=e[0]*e[1];r.bindBuffer(r.ARRAY_BUFFER,this.buf),r.bufferData(r.ARRAY_BUFFER,this.array,r.DYNAMIC_DRAW),r.uniform2f(this.sizeUniform,t[0],t[1]);var i=4*u;r.vertexAttribPointer(0,2,r.FLOAT,!1,i,0),r.vertexAttribPointer(1,3,r.FLOAT,!1,i,8),r.enableVertexAttribArray(0),r.enableVertexAttribArray(1),r.drawArrays(r.TRIANGLES,0,6*n)}}]),e}();exports.GridRenderingContext=h;
},{"./glsl":"qTC0"}],"UeJa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.start=C,exports.render=P,exports.update=E,exports.handleInput=_,exports.HtmlTextRef=void 0;var e=r(require("./core")),t=require("./rendering");function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=a?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(o,i,s):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function o(e,t){return u(e)||c(e,t)||i(e,t)||a()}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(c){s=!0,o=c}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}}function u(e){if(Array.isArray(e))return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}var d=100,m=20,p=20,h=4,y=e.Dir.Right,v=1,S=1,b=function(){function e(t){var n;l(this,e),this.elem=t,this._content=null!==(n=t.textContent)&&void 0!==n?n:"",this._color=t.style.color}return g(e,[{key:"content",value:function(e){this._content!==e&&(this._content=e,this.elem.textContent=e)}},{key:"color",value:function(e){this._color!==e&&(this._color=e,this.elem.style.color=e)}}]),e}();function w(e,t){e.before(t),t.style.position="absolute",t.style.width=e.width+"px",t.style.height=e.height+"px"}function C(n,r){var o=n.getContext("webgl2",{desynchronized:!0});if(null==o)return null;var a={config:r,game:e.init({gridSize:[m,p],dir:y,snakeLength:h,position:[v,S]}),needsRender:!0,highScore:r.getHighScore(),statusContainer:new b(document.createElement("div")),scoreContainer:new b(document.createElement("div"))};n.before(a.scoreContainer.elem),n.before(a.statusContainer.elem),w(n,a.scoreContainer.elem),a.scoreContainer.elem.style.fontSize="28px",a.scoreContainer.elem.style.color="rgb(0, 235, 255)",a.scoreContainer.elem.style.padding="16px 0px 0px 16px",w(n,a.statusContainer.elem),a.scoreContainer.elem.style.fontSize="28px",a.statusContainer.elem.style.font="72px Roboto",a.statusContainer.elem.style.textAlign="center",a.statusContainer.elem.style.verticalAlign="middle";var i=new t.GridRenderingContext(o,[n.width,n.height],a.game.gridSize),s=function(e){_(a,e)&&(e.preventDefault(),e.stopPropagation())};window.addEventListener("keydown",s);var c={cancelled:!1};x(c,i,a);var u=setInterval(function(){return E(a)},d);return{stop:function(){window.removeEventListener("keydown",s),clearInterval(u),c.cancelled=!0,a.scoreContainer.elem.remove(),a.statusContainer.elem.remove(),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT)}}}function x(e,t,n){e.cancelled||(P(t,n),requestAnimationFrame(function(){return x(e,t,n)}))}function P(t,n){var r=performance.now();n.needsRender&&(n.game.state===e.GameState.InProgress&&R(t,n.game),n.needsRender=!1),D(t,n.game,r),t.flush(),A(n),O(n)}function A(t){switch(t.game.state){case e.GameState.InProgress:t.statusContainer.content("");break;case e.GameState.InProgressAndPaused:t.statusContainer.content("Paused"),t.statusContainer.color("rgb(240, 20, 20)");break;case e.GameState.Lost:t.statusContainer.content("You died"),t.statusContainer.color("rgb(255, 0, 0)");break;case e.GameState.Won:t.statusContainer.content("You won?"),t.statusContainer.color("rgb(255, 0, 0)")}}function G(e,t,n){return t+e*(n-t)}function k(e){return{r:G(e,.6,.8),g:G(e,.6,1),b:G(e,.5,.4)}}function D(e,t,n){var r=o(t.noms,2),a=r[0],i=r[1];e.setColor(a,i,I(n))}function I(e){return{r:1,g:e%200/200,b:e%100/100}}function R(e,t){e.bufferGrid(function(e,n){var r=t.grid[e][n];return r>0?r==t.snake.length?{r:1,g:1,b:1}:k(t.grid[e][n]/t.snake.length):{r:0,g:0,b:0}})}function O(t){var n=e.getScore(t.game)/(t.game.gridSize[0]*t.game.gridSize[1]);null===t.highScore?t.scoreContainer.content(e.getScore(t.game).toString()):t.scoreContainer.content("".concat(e.getScore(t.game)," | ").concat(t.highScore));var r=Math.round(G(n,0,255)),o=Math.round(G(n,255,0));t.scoreContainer.color("rgb(".concat(r,", 255, ").concat(o,")"))}function E(t){var n,r=t.game;switch(r.state){case e.GameState.InProgress:e.update(r),t.needsRender=!0;break;case e.GameState.Won:case e.GameState.Lost:var o=e.getScore(r);o>(null!==(n=t.highScore)&&void 0!==n?n:0)&&t.config.setHighScore(o)}}function _(t,n){var r=n.code;switch(t.game.state){case e.GameState.InProgress:return L(t,r);case e.GameState.InProgressAndPaused:return M(t,r);case e.GameState.Lost:case e.GameState.Won:return j(t,r)}}function j(t,n){switch(n){case"Enter":case"Escape":case"Space":return t.game=e.init(t.game.initArgs),t.needsRender=!0,t.highScore=t.config.getHighScore(),!0;default:return!1}}function L(t,n){var r=t.game;switch(n){case"Enter":case"Escape":case"Space":return r.state=e.GameState.InProgressAndPaused,t.needsRender=!0,!0;case"ArrowLeft":case"KeyA":return e.setDirection(r,e.Dir.Left),!0;case"ArrowUp":case"KeyW":return e.setDirection(r,e.Dir.Up),!0;case"ArrowRight":case"KeyD":return e.setDirection(r,e.Dir.Right),!0;case"ArrowDown":case"KeyS":return e.setDirection(r,e.Dir.Down),!0;default:return!1}}function M(t,n){var r=t.game;switch(n){case"Enter":case"Escape":case"Space":return r.state=e.GameState.InProgress,!0;default:return!1}}exports.HtmlTextRef=b;
},{"./core":"T1EE","./rendering":"c6Sn"}],"YSF2":[function(require,module,exports) {
"use strict";var e=require("./snake/game"),t="karifrederiksen.github.io|Snake high score";function r(){var e;try{var r=Number(null!==(e=localStorage.getItem(t))&&void 0!==e?e:"NaN");return Number.isNaN(r)?null:r}catch(a){return null}}function a(e){try{localStorage.setItem(t,e.toString())}catch(r){}}var n=document.getElementById("game-container");n&&(0,e.start)(n,{getHighScore:r,setHighScore:a});
},{"./snake/game":"UeJa"}]},{},["YSF2"], null)
//# sourceMappingURL=/app.a25a6fbb.js.map